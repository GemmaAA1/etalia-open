/*!

 handlebars v4.0.5

Copyright (C) 2011-2015 by Yehuda Katz

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

@license
*/

//! moment.js
//! version : 2.12.0
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com

/*!
 *  Copyright 2011 Twitter, Inc.
 *  Licensed under the Apache License, Version 2.0 (the "License");
 *  you may not use this file except in compliance with the License.
 *  You may obtain a copy of the License at
 *
 *  http://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an "AS IS" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License.
 */

/**
 * Backbone-relational.js 0.10.0
 * (c) 2011-2014 Paul Uithol and contributors (https://github.com/PaulUithol/Backbone-relational/graphs/contributors)
 *
 * Backbone-relational may be freely distributed under the MIT license; see the accompanying LICENSE.txt.
 * For details and documentation: https://github.com/PaulUithol/Backbone-relational.
 * Depends on Backbone (and thus on Underscore as well): https://github.com/documentcloud/backbone.
 *
 * Example:
 *
	Zoo = Backbone.RelationalModel.extend({
		relations: [ {
			type: Backbone.HasMany,
			key: 'animals',
			relatedModel: 'Animal',
			reverseRelation: {
				key: 'livesIn',
				includeInJSON: 'id'
				// 'relatedModel' is automatically set to 'Zoo'; the 'relationType' to 'HasOne'.
			}
		} ],

		toString: function() {
			return this.get( 'name' );
		}
	});

	Animal = Backbone.RelationalModel.extend({
		toString: function() {
			return this.get( 'species' );
		}
	});

	// Creating the zoo will give it a collection with one animal in it: the monkey.
	// The animal created after that has a relation `livesIn` that points to the zoo it's currently associated with.
	// If you instantiate (or fetch) the zebra later, it will automatically be added.

	var zoo = new Zoo({
		name: 'Artis',
		animals: [ { id: 'monkey-1', species: 'Chimp' }, 'lion-1', 'zebra-1' ]
	});

	var lion = new Animal( { id: 'lion-1', species: 'Lion' } ),
		monkey = zoo.get( 'animals' ).first(),
		sameZoo = lion.get( 'livesIn' );
 */

/*
  backbone.paginator
  http://github.com/backbone-paginator/backbone.paginator

  Copyright (c) 2016 Jimmy Yuen Ho Wong and contributors

  @module
  @license MIT
*/

/**
 * Backbone Forms v0.14.1
 *
 * NOTE:
 * This version is for use with RequireJS
 * If using regular <script> tags to include your files, use backbone-forms.min.js
 *
 * Copyright (c) 2013 Charles Davison, Pow Media Ltd
 * 
 * License and more information at:
 * http://github.com/powmedia/backbone-forms
 */

/**
 * @license RequireJS text 2.0.14 Copyright (c) 2010-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("handlebars",[],t):"object"==typeof exports?exports.Handlebars=t():e.Handlebars=t()}(this,function(){return function(e){function t(n){if(i[n])return i[n].exports;var s=i[n]={exports:{},id:n,loaded:!1};return e[n].call(s.exports,s,s.exports,t),s.loaded=!0,s.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t,i){"use strict";function n(){var e=v();return e.compile=function(t,i){return u.compile(t,i,e)},e.precompile=function(t,i){return u.precompile(t,i,e)},e.AST=l["default"],e.Compiler=u.Compiler,e.JavaScriptCompiler=d["default"],e.Parser=c.parser,e.parse=c.parse,e}var s=i(1)["default"];t.__esModule=!0;var r=i(2),a=s(r),o=i(21),l=s(o),c=i(22),u=i(27),h=i(28),d=s(h),p=i(25),f=s(p),m=i(20),g=s(m),v=a["default"].create,y=n();y.create=n,g["default"](y),y.Visitor=f["default"],y["default"]=y,t["default"]=y,e.exports=t["default"]},function(e,t){"use strict";t["default"]=function(e){return e&&e.__esModule?e:{"default":e}},t.__esModule=!0},function(e,t,i){"use strict";function n(){var e=new o.HandlebarsEnvironment;return p.extend(e,o),e.SafeString=c["default"],e.Exception=h["default"],e.Utils=p,e.escapeExpression=p.escapeExpression,e.VM=m,e.template=function(t){return m.template(t,e)},e}var s=i(3)["default"],r=i(1)["default"];t.__esModule=!0;var a=i(4),o=s(a),l=i(18),c=r(l),u=i(6),h=r(u),d=i(5),p=s(d),f=i(19),m=s(f),g=i(20),v=r(g),y=n();y.create=n,v["default"](y),y["default"]=y,t["default"]=y,e.exports=t["default"]},function(e,t){"use strict";t["default"]=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t["default"]=e,t},t.__esModule=!0},function(e,t,i){"use strict";function n(e,t,i){this.helpers=e||{},this.partials=t||{},this.decorators=i||{},l.registerDefaultHelpers(this),c.registerDefaultDecorators(this)}var s=i(1)["default"];t.__esModule=!0,t.HandlebarsEnvironment=n;var r=i(5),a=i(6),o=s(a),l=i(7),c=i(15),u=i(17),h=s(u),d="4.0.5";t.VERSION=d;var p=7;t.COMPILER_REVISION=p;var f={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1",7:">= 4.0.0"};t.REVISION_CHANGES=f;var m="[object Object]";n.prototype={constructor:n,logger:h["default"],log:h["default"].log,registerHelper:function(e,t){if(r.toString.call(e)===m){if(t)throw new o["default"]("Arg not supported with multiple helpers");r.extend(this.helpers,e)}else this.helpers[e]=t},unregisterHelper:function(e){delete this.helpers[e]},registerPartial:function(e,t){if(r.toString.call(e)===m)r.extend(this.partials,e);else{if("undefined"==typeof t)throw new o["default"]('Attempting to register a partial called "'+e+'" as undefined');this.partials[e]=t}},unregisterPartial:function(e){delete this.partials[e]},registerDecorator:function(e,t){if(r.toString.call(e)===m){if(t)throw new o["default"]("Arg not supported with multiple decorators");r.extend(this.decorators,e)}else this.decorators[e]=t},unregisterDecorator:function(e){delete this.decorators[e]}};var g=h["default"].log;t.log=g,t.createFrame=r.createFrame,t.logger=h["default"]},function(e,t){"use strict";function i(e){return u[e]}function n(e){for(var t=1;t<arguments.length;t++)for(var i in arguments[t])Object.prototype.hasOwnProperty.call(arguments[t],i)&&(e[i]=arguments[t][i]);return e}function s(e,t){for(var i=0,n=e.length;n>i;i++)if(e[i]===t)return i;return-1}function r(e){if("string"!=typeof e){if(e&&e.toHTML)return e.toHTML();if(null==e)return"";if(!e)return e+"";e=""+e}return d.test(e)?e.replace(h,i):e}function a(e){return e||0===e?m(e)&&0===e.length?!0:!1:!0}function o(e){var t=n({},e);return t._parent=e,t}function l(e,t){return e.path=t,e}function c(e,t){return(e?e+".":"")+t}t.__esModule=!0,t.extend=n,t.indexOf=s,t.escapeExpression=r,t.isEmpty=a,t.createFrame=o,t.blockParams=l,t.appendContextPath=c;var u={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"},h=/[&<>"'`=]/g,d=/[&<>"'`=]/,p=Object.prototype.toString;t.toString=p;var f=function(e){return"function"==typeof e};f(/x/)&&(t.isFunction=f=function(e){return"function"==typeof e&&"[object Function]"===p.call(e)}),t.isFunction=f;var m=Array.isArray||function(e){return e&&"object"==typeof e?"[object Array]"===p.call(e):!1};t.isArray=m},function(e,t){"use strict";function i(e,t){var s=t&&t.loc,r=void 0,a=void 0;s&&(r=s.start.line,a=s.start.column,e+=" - "+r+":"+a);for(var o=Error.prototype.constructor.call(this,e),l=0;l<n.length;l++)this[n[l]]=o[n[l]];Error.captureStackTrace&&Error.captureStackTrace(this,i),s&&(this.lineNumber=r,this.column=a)}t.__esModule=!0;var n=["description","fileName","lineNumber","message","name","number","stack"];i.prototype=new Error,t["default"]=i,e.exports=t["default"]},function(e,t,i){"use strict";function n(e){a["default"](e),l["default"](e),u["default"](e),d["default"](e),f["default"](e),g["default"](e),y["default"](e)}var s=i(1)["default"];t.__esModule=!0,t.registerDefaultHelpers=n;var r=i(8),a=s(r),o=i(9),l=s(o),c=i(10),u=s(c),h=i(11),d=s(h),p=i(12),f=s(p),m=i(13),g=s(m),v=i(14),y=s(v)},function(e,t,i){"use strict";t.__esModule=!0;var n=i(5);t["default"]=function(e){e.registerHelper("blockHelperMissing",function(t,i){var s=i.inverse,r=i.fn;if(t===!0)return r(this);if(t===!1||null==t)return s(this);if(n.isArray(t))return t.length>0?(i.ids&&(i.ids=[i.name]),e.helpers.each(t,i)):s(this);if(i.data&&i.ids){var a=n.createFrame(i.data);a.contextPath=n.appendContextPath(i.data.contextPath,i.name),i={data:a}}return r(t,i)})},e.exports=t["default"]},function(e,t,i){"use strict";var n=i(1)["default"];t.__esModule=!0;var s=i(5),r=i(6),a=n(r);t["default"]=function(e){e.registerHelper("each",function(e,t){function i(t,i,r){c&&(c.key=t,c.index=i,c.first=0===i,c.last=!!r,u&&(c.contextPath=u+t)),l+=n(e[t],{data:c,blockParams:s.blockParams([e[t],t],[u+t,null])})}if(!t)throw new a["default"]("Must pass iterator to #each");var n=t.fn,r=t.inverse,o=0,l="",c=void 0,u=void 0;if(t.data&&t.ids&&(u=s.appendContextPath(t.data.contextPath,t.ids[0])+"."),s.isFunction(e)&&(e=e.call(this)),t.data&&(c=s.createFrame(t.data)),e&&"object"==typeof e)if(s.isArray(e))for(var h=e.length;h>o;o++)o in e&&i(o,o,o===e.length-1);else{var d=void 0;for(var p in e)e.hasOwnProperty(p)&&(void 0!==d&&i(d,o-1),d=p,o++);void 0!==d&&i(d,o-1,!0)}return 0===o&&(l=r(this)),l})},e.exports=t["default"]},function(e,t,i){"use strict";var n=i(1)["default"];t.__esModule=!0;var s=i(6),r=n(s);t["default"]=function(e){e.registerHelper("helperMissing",function(){if(1!==arguments.length)throw new r["default"]('Missing helper: "'+arguments[arguments.length-1].name+'"')})},e.exports=t["default"]},function(e,t,i){"use strict";t.__esModule=!0;var n=i(5);t["default"]=function(e){e.registerHelper("if",function(e,t){return n.isFunction(e)&&(e=e.call(this)),!t.hash.includeZero&&!e||n.isEmpty(e)?t.inverse(this):t.fn(this)}),e.registerHelper("unless",function(t,i){return e.helpers["if"].call(this,t,{fn:i.inverse,inverse:i.fn,hash:i.hash})})},e.exports=t["default"]},function(e,t){"use strict";t.__esModule=!0,t["default"]=function(e){e.registerHelper("log",function(){for(var t=[void 0],i=arguments[arguments.length-1],n=0;n<arguments.length-1;n++)t.push(arguments[n]);var s=1;null!=i.hash.level?s=i.hash.level:i.data&&null!=i.data.level&&(s=i.data.level),t[0]=s,e.log.apply(e,t)})},e.exports=t["default"]},function(e,t){"use strict";t.__esModule=!0,t["default"]=function(e){e.registerHelper("lookup",function(e,t){return e&&e[t]})},e.exports=t["default"]},function(e,t,i){"use strict";t.__esModule=!0;var n=i(5);t["default"]=function(e){e.registerHelper("with",function(e,t){n.isFunction(e)&&(e=e.call(this));var i=t.fn;if(n.isEmpty(e))return t.inverse(this);var s=t.data;return t.data&&t.ids&&(s=n.createFrame(t.data),s.contextPath=n.appendContextPath(t.data.contextPath,t.ids[0])),i(e,{data:s,blockParams:n.blockParams([e],[s&&s.contextPath])})})},e.exports=t["default"]},function(e,t,i){"use strict";function n(e){a["default"](e)}var s=i(1)["default"];t.__esModule=!0,t.registerDefaultDecorators=n;var r=i(16),a=s(r)},function(e,t,i){"use strict";t.__esModule=!0;var n=i(5);t["default"]=function(e){e.registerDecorator("inline",function(e,t,i,s){var r=e;return t.partials||(t.partials={},r=function(s,r){var a=i.partials;i.partials=n.extend({},a,t.partials);var o=e(s,r);return i.partials=a,o}),t.partials[s.args[0]]=s.fn,r})},e.exports=t["default"]},function(e,t,i){"use strict";t.__esModule=!0;var n=i(5),s={methodMap:["debug","info","warn","error"],level:"info",lookupLevel:function(e){if("string"==typeof e){var t=n.indexOf(s.methodMap,e.toLowerCase());e=t>=0?t:parseInt(e,10)}return e},log:function(e){if(e=s.lookupLevel(e),"undefined"!=typeof console&&s.lookupLevel(s.level)<=e){var t=s.methodMap[e];console[t]||(t="log");for(var i=arguments.length,n=Array(i>1?i-1:0),r=1;i>r;r++)n[r-1]=arguments[r];console[t].apply(console,n)}}};t["default"]=s,e.exports=t["default"]},function(e,t){"use strict";function i(e){this.string=e}t.__esModule=!0,i.prototype.toString=i.prototype.toHTML=function(){return""+this.string},t["default"]=i,e.exports=t["default"]},function(e,t,i){"use strict";function n(e){var t=e&&e[0]||1,i=v.COMPILER_REVISION;if(t!==i){if(i>t){var n=v.REVISION_CHANGES[i],s=v.REVISION_CHANGES[t];throw new g["default"]("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+n+") or downgrade your runtime to an older version ("+s+").")}throw new g["default"]("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+e[1]+").")}}function s(e,t){function i(i,n,s){s.hash&&(n=f.extend({},n,s.hash),s.ids&&(s.ids[0]=!0)),i=t.VM.resolvePartial.call(this,i,n,s);var r=t.VM.invokePartial.call(this,i,n,s);if(null==r&&t.compile&&(s.partials[s.name]=t.compile(i,e.compilerOptions,t),r=s.partials[s.name](n,s)),null!=r){if(s.indent){for(var a=r.split("\n"),o=0,l=a.length;l>o&&(a[o]||o+1!==l);o++)a[o]=s.indent+a[o];r=a.join("\n")}return r}throw new g["default"]("The partial "+s.name+" could not be compiled when running in runtime-only mode")}function n(t){function i(t){return""+e.main(s,t,s.helpers,s.partials,a,l,o)}var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],a=r.data;n._setup(r),!r.partial&&e.useData&&(a=c(t,a));var o=void 0,l=e.useBlockParams?[]:void 0;return e.useDepths&&(o=r.depths?t!==r.depths[0]?[t].concat(r.depths):r.depths:[t]),(i=u(e.main,i,s,r.depths||[],a,l))(t,r)}if(!t)throw new g["default"]("No environment passed to template");if(!e||!e.main)throw new g["default"]("Unknown template object: "+typeof e);e.main.decorator=e.main_d,t.VM.checkRevision(e.compiler);var s={strict:function(e,t){if(!(t in e))throw new g["default"]('"'+t+'" not defined in '+e);return e[t]},lookup:function(e,t){for(var i=e.length,n=0;i>n;n++)if(e[n]&&null!=e[n][t])return e[n][t]},lambda:function(e,t){return"function"==typeof e?e.call(t):e},escapeExpression:f.escapeExpression,invokePartial:i,fn:function(t){var i=e[t];return i.decorator=e[t+"_d"],i},programs:[],program:function(e,t,i,n,s){var a=this.programs[e],o=this.fn(e);return t||s||n||i?a=r(this,e,o,t,i,n,s):a||(a=this.programs[e]=r(this,e,o)),a},data:function(e,t){for(;e&&t--;)e=e._parent;return e},merge:function(e,t){var i=e||t;return e&&t&&e!==t&&(i=f.extend({},t,e)),i},noop:t.VM.noop,compilerInfo:e.compiler};return n.isTop=!0,n._setup=function(i){i.partial?(s.helpers=i.helpers,s.partials=i.partials,s.decorators=i.decorators):(s.helpers=s.merge(i.helpers,t.helpers),e.usePartial&&(s.partials=s.merge(i.partials,t.partials)),(e.usePartial||e.useDecorators)&&(s.decorators=s.merge(i.decorators,t.decorators)))},n._child=function(t,i,n,a){if(e.useBlockParams&&!n)throw new g["default"]("must pass block params");if(e.useDepths&&!a)throw new g["default"]("must pass parent depths");return r(s,t,e[t],i,0,n,a)},n}function r(e,t,i,n,s,r,a){function o(t){var s=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],o=a;return a&&t!==a[0]&&(o=[t].concat(a)),i(e,t,e.helpers,e.partials,s.data||n,r&&[s.blockParams].concat(r),o)}return o=u(i,o,e,a,n,r),o.program=t,o.depth=a?a.length:0,o.blockParams=s||0,o}function a(e,t,i){return e?e.call||i.name||(i.name=e,e=i.partials[e]):e="@partial-block"===i.name?i.data["partial-block"]:i.partials[i.name],e}function o(e,t,i){i.partial=!0,i.ids&&(i.data.contextPath=i.ids[0]||i.data.contextPath);var n=void 0;if(i.fn&&i.fn!==l&&(i.data=v.createFrame(i.data),n=i.data["partial-block"]=i.fn,n.partials&&(i.partials=f.extend({},i.partials,n.partials))),void 0===e&&n&&(e=n),void 0===e)throw new g["default"]("The partial "+i.name+" could not be found");return e instanceof Function?e(t,i):void 0}function l(){return""}function c(e,t){return t&&"root"in t||(t=t?v.createFrame(t):{},t.root=e),t}function u(e,t,i,n,s,r){if(e.decorator){var a={};t=e.decorator(t,a,i,n&&n[0],s,r,n),f.extend(t,a)}return t}var h=i(3)["default"],d=i(1)["default"];t.__esModule=!0,t.checkRevision=n,t.template=s,t.wrapProgram=r,t.resolvePartial=a,t.invokePartial=o,t.noop=l;var p=i(5),f=h(p),m=i(6),g=d(m),v=i(4)},function(e,t){(function(i){"use strict";t.__esModule=!0,t["default"]=function(e){var t="undefined"!=typeof i?i:window,n=t.Handlebars;e.noConflict=function(){return t.Handlebars===e&&(t.Handlebars=n),e}},e.exports=t["default"]}).call(t,function(){return this}())},function(e,t){"use strict";t.__esModule=!0;var i={helpers:{helperExpression:function(e){return"SubExpression"===e.type||("MustacheStatement"===e.type||"BlockStatement"===e.type)&&!!(e.params&&e.params.length||e.hash)},scopedId:function(e){return/^\.|this\b/.test(e.original)},simpleId:function(e){return 1===e.parts.length&&!i.helpers.scopedId(e)&&!e.depth}}};t["default"]=i,e.exports=t["default"]},function(e,t,i){"use strict";function n(e,t){if("Program"===e.type)return e;o["default"].yy=p,p.locInfo=function(e){return new p.SourceLocation(t&&t.srcName,e)};var i=new c["default"](t);return i.accept(o["default"].parse(e))}var s=i(1)["default"],r=i(3)["default"];t.__esModule=!0,t.parse=n;var a=i(23),o=s(a),l=i(24),c=s(l),u=i(26),h=r(u),d=i(5);t.parser=o["default"];var p={};d.extend(p,h)},function(e,t){"use strict";var i=function(){function e(){this.yy={}}var t={trace:function(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,program_repetition0:6,statement:7,mustache:8,block:9,rawBlock:10,partial:11,partialBlock:12,content:13,COMMENT:14,CONTENT:15,openRawBlock:16,rawBlock_repetition_plus0:17,END_RAW_BLOCK:18,OPEN_RAW_BLOCK:19,helperName:20,openRawBlock_repetition0:21,openRawBlock_option0:22,CLOSE_RAW_BLOCK:23,openBlock:24,block_option0:25,closeBlock:26,openInverse:27,block_option1:28,OPEN_BLOCK:29,openBlock_repetition0:30,openBlock_option0:31,openBlock_option1:32,CLOSE:33,OPEN_INVERSE:34,openInverse_repetition0:35,openInverse_option0:36,openInverse_option1:37,openInverseChain:38,OPEN_INVERSE_CHAIN:39,openInverseChain_repetition0:40,openInverseChain_option0:41,openInverseChain_option1:42,inverseAndProgram:43,INVERSE:44,inverseChain:45,inverseChain_option0:46,OPEN_ENDBLOCK:47,OPEN:48,mustache_repetition0:49,mustache_option0:50,OPEN_UNESCAPED:51,mustache_repetition1:52,mustache_option1:53,CLOSE_UNESCAPED:54,OPEN_PARTIAL:55,partialName:56,partial_repetition0:57,partial_option0:58,openPartialBlock:59,OPEN_PARTIAL_BLOCK:60,openPartialBlock_repetition0:61,openPartialBlock_option0:62,param:63,sexpr:64,OPEN_SEXPR:65,sexpr_repetition0:66,sexpr_option0:67,CLOSE_SEXPR:68,hash:69,hash_repetition_plus0:70,hashSegment:71,ID:72,EQUALS:73,blockParams:74,OPEN_BLOCK_PARAMS:75,blockParams_repetition_plus0:76,CLOSE_BLOCK_PARAMS:77,path:78,dataName:79,STRING:80,NUMBER:81,BOOLEAN:82,UNDEFINED:83,NULL:84,DATA:85,pathSegments:86,SEP:87,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"COMMENT",15:"CONTENT",18:"END_RAW_BLOCK",19:"OPEN_RAW_BLOCK",23:"CLOSE_RAW_BLOCK",29:"OPEN_BLOCK",33:"CLOSE",34:"OPEN_INVERSE",39:"OPEN_INVERSE_CHAIN",44:"INVERSE",47:"OPEN_ENDBLOCK",48:"OPEN",51:"OPEN_UNESCAPED",54:"CLOSE_UNESCAPED",55:"OPEN_PARTIAL",60:"OPEN_PARTIAL_BLOCK",65:"OPEN_SEXPR",68:"CLOSE_SEXPR",72:"ID",73:"EQUALS",75:"OPEN_BLOCK_PARAMS",77:"CLOSE_BLOCK_PARAMS",80:"STRING",81:"NUMBER",82:"BOOLEAN",83:"UNDEFINED",84:"NULL",85:"DATA",87:"SEP"},productions_:[0,[3,2],[4,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[13,1],[10,3],[16,5],[9,4],[9,4],[24,6],[27,6],[38,6],[43,2],[45,3],[45,1],[26,3],[8,5],[8,5],[11,5],[12,3],[59,5],[63,1],[63,1],[64,5],[69,1],[71,3],[74,3],[20,1],[20,1],[20,1],[20,1],[20,1],[20,1],[20,1],[56,1],[56,1],[79,2],[78,1],[86,3],[86,1],[6,0],[6,2],[17,1],[17,2],[21,0],[21,2],[22,0],[22,1],[25,0],[25,1],[28,0],[28,1],[30,0],[30,2],[31,0],[31,1],[32,0],[32,1],[35,0],[35,2],[36,0],[36,1],[37,0],[37,1],[40,0],[40,2],[41,0],[41,1],[42,0],[42,1],[46,0],[46,1],[49,0],[49,2],[50,0],[50,1],[52,0],[52,2],[53,0],[53,1],[57,0],[57,2],[58,0],[58,1],[61,0],[61,2],[62,0],[62,1],[66,0],[66,2],[67,0],[67,1],[70,1],[70,2],[76,1],[76,2]],performAction:function(e,t,i,n,s,r,a){var o=r.length-1;switch(s){case 1:return r[o-1];case 2:this.$=n.prepareProgram(r[o]);break;case 3:this.$=r[o];break;case 4:this.$=r[o];break;case 5:this.$=r[o];break;case 6:this.$=r[o];break;case 7:this.$=r[o];break;case 8:this.$=r[o];break;case 9:this.$={type:"CommentStatement",value:n.stripComment(r[o]),strip:n.stripFlags(r[o],r[o]),loc:n.locInfo(this._$)};break;case 10:this.$={type:"ContentStatement",original:r[o],value:r[o],loc:n.locInfo(this._$)};break;case 11:this.$=n.prepareRawBlock(r[o-2],r[o-1],r[o],this._$);break;case 12:this.$={path:r[o-3],params:r[o-2],hash:r[o-1]};break;case 13:this.$=n.prepareBlock(r[o-3],r[o-2],r[o-1],r[o],!1,this._$);break;case 14:this.$=n.prepareBlock(r[o-3],r[o-2],r[o-1],r[o],!0,this._$);break;case 15:this.$={open:r[o-5],path:r[o-4],params:r[o-3],hash:r[o-2],blockParams:r[o-1],strip:n.stripFlags(r[o-5],r[o])};break;case 16:this.$={path:r[o-4],params:r[o-3],hash:r[o-2],blockParams:r[o-1],strip:n.stripFlags(r[o-5],r[o])};break;case 17:this.$={path:r[o-4],params:r[o-3],hash:r[o-2],blockParams:r[o-1],strip:n.stripFlags(r[o-5],r[o])};break;case 18:this.$={strip:n.stripFlags(r[o-1],r[o-1]),program:r[o]};break;case 19:var l=n.prepareBlock(r[o-2],r[o-1],r[o],r[o],!1,this._$),c=n.prepareProgram([l],r[o-1].loc);c.chained=!0,this.$={strip:r[o-2].strip,program:c,chain:!0};break;case 20:this.$=r[o];break;case 21:this.$={path:r[o-1],strip:n.stripFlags(r[o-2],r[o])};break;case 22:this.$=n.prepareMustache(r[o-3],r[o-2],r[o-1],r[o-4],n.stripFlags(r[o-4],r[o]),this._$);break;case 23:this.$=n.prepareMustache(r[o-3],r[o-2],r[o-1],r[o-4],n.stripFlags(r[o-4],r[o]),this._$);break;case 24:this.$={type:"PartialStatement",name:r[o-3],params:r[o-2],hash:r[o-1],indent:"",strip:n.stripFlags(r[o-4],r[o]),loc:n.locInfo(this._$)};break;case 25:this.$=n.preparePartialBlock(r[o-2],r[o-1],r[o],this._$);break;case 26:this.$={path:r[o-3],params:r[o-2],hash:r[o-1],strip:n.stripFlags(r[o-4],r[o])};break;case 27:this.$=r[o];break;case 28:this.$=r[o];break;case 29:this.$={type:"SubExpression",path:r[o-3],params:r[o-2],hash:r[o-1],loc:n.locInfo(this._$)};break;case 30:this.$={type:"Hash",pairs:r[o],loc:n.locInfo(this._$)};break;case 31:this.$={type:"HashPair",key:n.id(r[o-2]),value:r[o],loc:n.locInfo(this._$)};break;case 32:this.$=n.id(r[o-1]);break;case 33:this.$=r[o];break;case 34:this.$=r[o];break;case 35:this.$={type:"StringLiteral",value:r[o],original:r[o],loc:n.locInfo(this._$)};break;case 36:this.$={type:"NumberLiteral",value:Number(r[o]),original:Number(r[o]),loc:n.locInfo(this._$)};break;case 37:this.$={type:"BooleanLiteral",value:"true"===r[o],original:"true"===r[o],loc:n.locInfo(this._$)};break;case 38:this.$={type:"UndefinedLiteral",original:void 0,value:void 0,loc:n.locInfo(this._$)};break;case 39:this.$={type:"NullLiteral",original:null,value:null,loc:n.locInfo(this._$)};break;case 40:this.$=r[o];break;case 41:this.$=r[o];break;case 42:this.$=n.preparePath(!0,r[o],this._$);break;case 43:this.$=n.preparePath(!1,r[o],this._$);break;case 44:r[o-2].push({part:n.id(r[o]),original:r[o],separator:r[o-1]}),this.$=r[o-2];break;case 45:this.$=[{part:n.id(r[o]),original:r[o]}];break;case 46:this.$=[];break;case 47:r[o-1].push(r[o]);break;case 48:this.$=[r[o]];break;case 49:r[o-1].push(r[o]);break;case 50:this.$=[];break;case 51:r[o-1].push(r[o]);break;case 58:this.$=[];break;case 59:r[o-1].push(r[o]);break;case 64:this.$=[];break;case 65:r[o-1].push(r[o]);break;case 70:this.$=[];break;case 71:r[o-1].push(r[o]);break;case 78:this.$=[];break;case 79:r[o-1].push(r[o]);break;case 82:this.$=[];break;case 83:r[o-1].push(r[o]);break;case 86:this.$=[];break;case 87:r[o-1].push(r[o]);break;case 90:this.$=[];break;case 91:r[o-1].push(r[o]);break;case 94:this.$=[];break;case 95:r[o-1].push(r[o]);break;case 98:this.$=[r[o]];break;case 99:r[o-1].push(r[o]);break;case 100:this.$=[r[o]];break;case 101:r[o-1].push(r[o])}},table:[{3:1,4:2,5:[2,46],6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{1:[3]},{5:[1,4]},{5:[2,2],7:5,8:6,9:7,10:8,11:9,12:10,13:11,14:[1,12],15:[1,20],16:17,19:[1,23],24:15,27:16,29:[1,21],34:[1,22],39:[2,2],44:[2,2],47:[2,2],48:[1,13],51:[1,14],55:[1,18],59:19,60:[1,24]},{1:[2,1]},{5:[2,47],14:[2,47],15:[2,47],19:[2,47],29:[2,47],34:[2,47],39:[2,47],44:[2,47],47:[2,47],48:[2,47],51:[2,47],55:[2,47],60:[2,47]},{5:[2,3],14:[2,3],15:[2,3],19:[2,3],29:[2,3],34:[2,3],39:[2,3],44:[2,3],47:[2,3],48:[2,3],51:[2,3],55:[2,3],60:[2,3]},{5:[2,4],14:[2,4],15:[2,4],19:[2,4],29:[2,4],34:[2,4],39:[2,4],44:[2,4],47:[2,4],48:[2,4],51:[2,4],55:[2,4],60:[2,4]},{5:[2,5],14:[2,5],15:[2,5],19:[2,5],29:[2,5],34:[2,5],39:[2,5],44:[2,5],47:[2,5],48:[2,5],51:[2,5],55:[2,5],60:[2,5]},{5:[2,6],14:[2,6],15:[2,6],19:[2,6],29:[2,6],34:[2,6],39:[2,6],44:[2,6],47:[2,6],48:[2,6],51:[2,6],55:[2,6],60:[2,6]},{5:[2,7],14:[2,7],15:[2,7],19:[2,7],29:[2,7],34:[2,7],39:[2,7],44:[2,7],47:[2,7],48:[2,7],51:[2,7],55:[2,7],60:[2,7]},{5:[2,8],14:[2,8],15:[2,8],19:[2,8],29:[2,8],34:[2,8],39:[2,8],44:[2,8],47:[2,8],48:[2,8],51:[2,8],55:[2,8],60:[2,8]},{5:[2,9],14:[2,9],15:[2,9],19:[2,9],29:[2,9],34:[2,9],39:[2,9],44:[2,9],47:[2,9],48:[2,9],51:[2,9],55:[2,9],60:[2,9]},{20:25,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:36,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:37,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],39:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{4:38,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{13:40,15:[1,20],17:39},{20:42,56:41,64:43,65:[1,44],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:45,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{5:[2,10],14:[2,10],15:[2,10],18:[2,10],19:[2,10],29:[2,10],34:[2,10],39:[2,10],44:[2,10],47:[2,10],48:[2,10],51:[2,10],55:[2,10],60:[2,10]},{20:46,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:47,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:48,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:42,56:49,64:43,65:[1,44],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[2,78],49:50,65:[2,78],72:[2,78],80:[2,78],81:[2,78],82:[2,78],83:[2,78],84:[2,78],85:[2,78]},{23:[2,33],33:[2,33],54:[2,33],65:[2,33],68:[2,33],72:[2,33],75:[2,33],80:[2,33],81:[2,33],82:[2,33],83:[2,33],84:[2,33],85:[2,33]},{23:[2,34],33:[2,34],54:[2,34],65:[2,34],68:[2,34],72:[2,34],75:[2,34],80:[2,34],81:[2,34],82:[2,34],83:[2,34],84:[2,34],85:[2,34]},{23:[2,35],33:[2,35],54:[2,35],65:[2,35],68:[2,35],72:[2,35],75:[2,35],80:[2,35],81:[2,35],82:[2,35],83:[2,35],84:[2,35],85:[2,35]},{23:[2,36],33:[2,36],54:[2,36],65:[2,36],68:[2,36],72:[2,36],75:[2,36],80:[2,36],81:[2,36],82:[2,36],83:[2,36],84:[2,36],85:[2,36]},{23:[2,37],33:[2,37],54:[2,37],65:[2,37],68:[2,37],72:[2,37],75:[2,37],80:[2,37],81:[2,37],82:[2,37],83:[2,37],84:[2,37],85:[2,37]},{23:[2,38],33:[2,38],54:[2,38],65:[2,38],68:[2,38],72:[2,38],75:[2,38],80:[2,38],81:[2,38],82:[2,38],83:[2,38],84:[2,38],85:[2,38]},{23:[2,39],33:[2,39],54:[2,39],65:[2,39],68:[2,39],72:[2,39],75:[2,39],80:[2,39],81:[2,39],82:[2,39],83:[2,39],84:[2,39],85:[2,39]},{23:[2,43],33:[2,43],54:[2,43],65:[2,43],68:[2,43],72:[2,43],75:[2,43],80:[2,43],81:[2,43],82:[2,43],83:[2,43],84:[2,43],85:[2,43],87:[1,51]},{72:[1,35],86:52},{23:[2,45],33:[2,45],54:[2,45],65:[2,45],68:[2,45],72:[2,45],75:[2,45],80:[2,45],81:[2,45],82:[2,45],83:[2,45],84:[2,45],85:[2,45],87:[2,45]},{52:53,54:[2,82],65:[2,82],72:[2,82],80:[2,82],81:[2,82],82:[2,82],83:[2,82],84:[2,82],85:[2,82]},{25:54,38:56,39:[1,58],43:57,44:[1,59],45:55,47:[2,54]},{28:60,43:61,44:[1,59],47:[2,56]},{13:63,15:[1,20],18:[1,62]},{15:[2,48],18:[2,48]},{33:[2,86],57:64,65:[2,86],72:[2,86],80:[2,86],81:[2,86],82:[2,86],83:[2,86],84:[2,86],85:[2,86]},{33:[2,40],65:[2,40],72:[2,40],80:[2,40],81:[2,40],82:[2,40],83:[2,40],84:[2,40],85:[2,40]},{33:[2,41],65:[2,41],72:[2,41],80:[2,41],81:[2,41],82:[2,41],83:[2,41],84:[2,41],85:[2,41]},{20:65,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{26:66,47:[1,67]},{30:68,33:[2,58],65:[2,58],72:[2,58],75:[2,58],80:[2,58],81:[2,58],82:[2,58],83:[2,58],84:[2,58],85:[2,58]},{33:[2,64],35:69,65:[2,64],72:[2,64],75:[2,64],80:[2,64],81:[2,64],82:[2,64],83:[2,64],84:[2,64],85:[2,64]},{21:70,23:[2,50],65:[2,50],72:[2,50],80:[2,50],81:[2,50],82:[2,50],83:[2,50],84:[2,50],85:[2,50]},{33:[2,90],61:71,65:[2,90],72:[2,90],80:[2,90],81:[2,90],82:[2,90],83:[2,90],84:[2,90],85:[2,90]},{20:75,33:[2,80],50:72,63:73,64:76,65:[1,44],69:74,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{72:[1,80]},{23:[2,42],33:[2,42],54:[2,42],65:[2,42],68:[2,42],72:[2,42],75:[2,42],80:[2,42],81:[2,42],82:[2,42],83:[2,42],84:[2,42],85:[2,42],87:[1,51]},{20:75,53:81,54:[2,84],63:82,64:76,65:[1,44],69:83,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{26:84,47:[1,67]},{47:[2,55]},{4:85,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],39:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{47:[2,20]},{20:86,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:87,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{26:88,47:[1,67]},{47:[2,57]},{5:[2,11],14:[2,11],15:[2,11],19:[2,11],29:[2,11],34:[2,11],39:[2,11],44:[2,11],47:[2,11],48:[2,11],51:[2,11],55:[2,11],60:[2,11]},{15:[2,49],18:[2,49]},{20:75,33:[2,88],58:89,63:90,64:76,65:[1,44],69:91,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{65:[2,94],66:92,68:[2,94],72:[2,94],80:[2,94],81:[2,94],82:[2,94],83:[2,94],84:[2,94],85:[2,94]},{5:[2,25],14:[2,25],15:[2,25],19:[2,25],29:[2,25],34:[2,25],39:[2,25],44:[2,25],47:[2,25],48:[2,25],51:[2,25],55:[2,25],60:[2,25]},{20:93,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:75,31:94,33:[2,60],63:95,64:76,65:[1,44],69:96,70:77,71:78,72:[1,79],75:[2,60],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:75,33:[2,66],36:97,63:98,64:76,65:[1,44],69:99,70:77,71:78,72:[1,79],75:[2,66],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:75,22:100,23:[2,52],63:101,64:76,65:[1,44],69:102,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:75,33:[2,92],62:103,63:104,64:76,65:[1,44],69:105,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[1,106]},{33:[2,79],65:[2,79],72:[2,79],80:[2,79],81:[2,79],82:[2,79],83:[2,79],84:[2,79],85:[2,79]},{33:[2,81]},{23:[2,27],33:[2,27],54:[2,27],65:[2,27],68:[2,27],72:[2,27],75:[2,27],80:[2,27],81:[2,27],82:[2,27],83:[2,27],84:[2,27],85:[2,27]},{23:[2,28],33:[2,28],54:[2,28],65:[2,28],68:[2,28],72:[2,28],75:[2,28],80:[2,28],81:[2,28],82:[2,28],83:[2,28],84:[2,28],85:[2,28]},{23:[2,30],33:[2,30],54:[2,30],68:[2,30],71:107,72:[1,108],75:[2,30]},{23:[2,98],33:[2,98],54:[2,98],68:[2,98],72:[2,98],75:[2,98]},{23:[2,45],33:[2,45],54:[2,45],65:[2,45],68:[2,45],72:[2,45],73:[1,109],75:[2,45],80:[2,45],81:[2,45],82:[2,45],83:[2,45],84:[2,45],85:[2,45],87:[2,45]},{23:[2,44],33:[2,44],54:[2,44],65:[2,44],68:[2,44],72:[2,44],75:[2,44],80:[2,44],81:[2,44],82:[2,44],83:[2,44],84:[2,44],85:[2,44],87:[2,44]},{54:[1,110]},{54:[2,83],65:[2,83],72:[2,83],80:[2,83],81:[2,83],82:[2,83],83:[2,83],84:[2,83],85:[2,83]},{54:[2,85]},{5:[2,13],14:[2,13],15:[2,13],19:[2,13],29:[2,13],34:[2,13],39:[2,13],44:[2,13],47:[2,13],48:[2,13],51:[2,13],55:[2,13],60:[2,13]},{38:56,39:[1,58],43:57,44:[1,59],45:112,46:111,47:[2,76]},{33:[2,70],40:113,65:[2,70],72:[2,70],75:[2,70],80:[2,70],81:[2,70],82:[2,70],83:[2,70],84:[2,70],85:[2,70]},{47:[2,18]},{5:[2,14],14:[2,14],15:[2,14],19:[2,14],29:[2,14],34:[2,14],39:[2,14],44:[2,14],47:[2,14],48:[2,14],51:[2,14],55:[2,14],60:[2,14]},{33:[1,114]},{33:[2,87],65:[2,87],72:[2,87],80:[2,87],81:[2,87],82:[2,87],83:[2,87],84:[2,87],85:[2,87]},{33:[2,89]},{20:75,63:116,64:76,65:[1,44],67:115,68:[2,96],69:117,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[1,118]},{32:119,33:[2,62],74:120,75:[1,121]},{33:[2,59],65:[2,59],72:[2,59],75:[2,59],80:[2,59],81:[2,59],82:[2,59],83:[2,59],84:[2,59],85:[2,59]},{33:[2,61],75:[2,61]},{33:[2,68],37:122,74:123,75:[1,121]},{33:[2,65],65:[2,65],72:[2,65],75:[2,65],80:[2,65],81:[2,65],82:[2,65],83:[2,65],84:[2,65],85:[2,65]},{33:[2,67],75:[2,67]},{23:[1,124]},{23:[2,51],65:[2,51],72:[2,51],80:[2,51],81:[2,51],82:[2,51],83:[2,51],84:[2,51],85:[2,51]},{23:[2,53]},{33:[1,125]},{33:[2,91],65:[2,91],72:[2,91],80:[2,91],81:[2,91],82:[2,91],83:[2,91],84:[2,91],85:[2,91]},{33:[2,93]},{5:[2,22],14:[2,22],15:[2,22],19:[2,22],29:[2,22],34:[2,22],39:[2,22],44:[2,22],47:[2,22],48:[2,22],51:[2,22],55:[2,22],60:[2,22]},{23:[2,99],33:[2,99],54:[2,99],68:[2,99],72:[2,99],75:[2,99]},{73:[1,109]},{20:75,63:126,64:76,65:[1,44],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{5:[2,23],14:[2,23],15:[2,23],19:[2,23],29:[2,23],34:[2,23],39:[2,23],44:[2,23],47:[2,23],48:[2,23],51:[2,23],55:[2,23],60:[2,23]},{47:[2,19]},{47:[2,77]},{20:75,33:[2,72],41:127,63:128,64:76,65:[1,44],69:129,70:77,71:78,72:[1,79],75:[2,72],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{5:[2,24],14:[2,24],15:[2,24],19:[2,24],29:[2,24],34:[2,24],39:[2,24],44:[2,24],47:[2,24],48:[2,24],51:[2,24],55:[2,24],60:[2,24]},{68:[1,130]},{65:[2,95],68:[2,95],72:[2,95],80:[2,95],81:[2,95],82:[2,95],83:[2,95],84:[2,95],85:[2,95]},{68:[2,97]},{5:[2,21],14:[2,21],15:[2,21],19:[2,21],29:[2,21],34:[2,21],39:[2,21],44:[2,21],47:[2,21],48:[2,21],51:[2,21],55:[2,21],60:[2,21]},{33:[1,131]},{33:[2,63]},{72:[1,133],76:132},{33:[1,134]},{33:[2,69]},{15:[2,12]},{14:[2,26],15:[2,26],19:[2,26],29:[2,26],34:[2,26],47:[2,26],48:[2,26],51:[2,26],55:[2,26],60:[2,26]},{23:[2,31],33:[2,31],54:[2,31],68:[2,31],72:[2,31],75:[2,31]},{33:[2,74],42:135,74:136,75:[1,121]},{33:[2,71],65:[2,71],72:[2,71],75:[2,71],80:[2,71],81:[2,71],82:[2,71],83:[2,71],84:[2,71],85:[2,71]},{33:[2,73],75:[2,73]},{23:[2,29],33:[2,29],54:[2,29],65:[2,29],68:[2,29],72:[2,29],75:[2,29],80:[2,29],81:[2,29],82:[2,29],83:[2,29],84:[2,29],85:[2,29]},{14:[2,15],15:[2,15],19:[2,15],29:[2,15],34:[2,15],39:[2,15],44:[2,15],47:[2,15],48:[2,15],51:[2,15],55:[2,15],60:[2,15]},{72:[1,138],77:[1,137]},{72:[2,100],77:[2,100]},{14:[2,16],15:[2,16],19:[2,16],29:[2,16],34:[2,16],
44:[2,16],47:[2,16],48:[2,16],51:[2,16],55:[2,16],60:[2,16]},{33:[1,139]},{33:[2,75]},{33:[2,32]},{72:[2,101],77:[2,101]},{14:[2,17],15:[2,17],19:[2,17],29:[2,17],34:[2,17],39:[2,17],44:[2,17],47:[2,17],48:[2,17],51:[2,17],55:[2,17],60:[2,17]}],defaultActions:{4:[2,1],55:[2,55],57:[2,20],61:[2,57],74:[2,81],83:[2,85],87:[2,18],91:[2,89],102:[2,53],105:[2,93],111:[2,19],112:[2,77],117:[2,97],120:[2,63],123:[2,69],124:[2,12],136:[2,75],137:[2,32]},parseError:function(e,t){throw new Error(e)},parse:function(e){function t(){var e;return e=i.lexer.lex()||1,"number"!=typeof e&&(e=i.symbols_[e]||e),e}var i=this,n=[0],s=[null],r=[],a=this.table,o="",l=0,c=0,u=0;this.lexer.setInput(e),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,"undefined"==typeof this.lexer.yylloc&&(this.lexer.yylloc={});var h=this.lexer.yylloc;r.push(h);var d=this.lexer.options&&this.lexer.options.ranges;"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var p,f,m,g,v,y,b,_,k,w={};;){if(m=n[n.length-1],this.defaultActions[m]?g=this.defaultActions[m]:((null===p||"undefined"==typeof p)&&(p=t()),g=a[m]&&a[m][p]),"undefined"==typeof g||!g.length||!g[0]){var S="";if(!u){k=[];for(y in a[m])this.terminals_[y]&&y>2&&k.push("'"+this.terminals_[y]+"'");S=this.lexer.showPosition?"Parse error on line "+(l+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+k.join(", ")+", got '"+(this.terminals_[p]||p)+"'":"Parse error on line "+(l+1)+": Unexpected "+(1==p?"end of input":"'"+(this.terminals_[p]||p)+"'"),this.parseError(S,{text:this.lexer.match,token:this.terminals_[p]||p,line:this.lexer.yylineno,loc:h,expected:k})}}if(g[0]instanceof Array&&g.length>1)throw new Error("Parse Error: multiple actions possible at state: "+m+", token: "+p);switch(g[0]){case 1:n.push(p),s.push(this.lexer.yytext),r.push(this.lexer.yylloc),n.push(g[1]),p=null,f?(p=f,f=null):(c=this.lexer.yyleng,o=this.lexer.yytext,l=this.lexer.yylineno,h=this.lexer.yylloc,u>0&&u--);break;case 2:if(b=this.productions_[g[1]][1],w.$=s[s.length-b],w._$={first_line:r[r.length-(b||1)].first_line,last_line:r[r.length-1].last_line,first_column:r[r.length-(b||1)].first_column,last_column:r[r.length-1].last_column},d&&(w._$.range=[r[r.length-(b||1)].range[0],r[r.length-1].range[1]]),v=this.performAction.call(w,o,c,l,this.yy,g[1],s,r),"undefined"!=typeof v)return v;b&&(n=n.slice(0,-1*b*2),s=s.slice(0,-1*b),r=r.slice(0,-1*b)),n.push(this.productions_[g[1]][0]),s.push(w.$),r.push(w._$),_=a[n[n.length-2]][n[n.length-1]],n.push(_);break;case 3:return!0}}return!0}},i=function(){var e={EOF:1,parseError:function(e,t){if(!this.yy.parser)throw new Error(e);this.yy.parser.parseError(e,t)},setInput:function(e){return this._input=e,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e;var t=e.match(/(?:\r\n?|\n).*/g);return t?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,i=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t-1),this.offset-=t;var n=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),i.length-1&&(this.yylineno-=i.length-1);var s=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:i?(i.length===n.length?this.yylloc.first_column:0)+n[n.length-i.length].length-i[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[s[0],s[0]+this.yyleng-t]),this},more:function(){return this._more=!0,this},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var e,t,i,n,s;this._more||(this.yytext="",this.match="");for(var r=this._currentRules(),a=0;a<r.length&&(i=this._input.match(this.rules[r[a]]),!i||t&&!(i[0].length>t[0].length)||(t=i,n=a,this.options.flex));a++);return t?(s=t[0].match(/(?:\r\n?|\n).*/g),s&&(this.yylineno+=s.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:s?s[s.length-1].length-s[s.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],e=this.performAction.call(this,this.yy,this,r[n],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),e?e:void 0):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return"undefined"!=typeof e?e:this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(e){this.begin(e)}};return e.options={},e.performAction=function(e,t,i,n){function s(e,i){return t.yytext=t.yytext.substr(e,t.yyleng-i)}switch(i){case 0:if("\\\\"===t.yytext.slice(-2)?(s(0,1),this.begin("mu")):"\\"===t.yytext.slice(-1)?(s(0,1),this.begin("emu")):this.begin("mu"),t.yytext)return 15;break;case 1:return 15;case 2:return this.popState(),15;case 3:return this.begin("raw"),15;case 4:return this.popState(),"raw"===this.conditionStack[this.conditionStack.length-1]?15:(t.yytext=t.yytext.substr(5,t.yyleng-9),"END_RAW_BLOCK");case 5:return 15;case 6:return this.popState(),14;case 7:return 65;case 8:return 68;case 9:return 19;case 10:return this.popState(),this.begin("raw"),23;case 11:return 55;case 12:return 60;case 13:return 29;case 14:return 47;case 15:return this.popState(),44;case 16:return this.popState(),44;case 17:return 34;case 18:return 39;case 19:return 51;case 20:return 48;case 21:this.unput(t.yytext),this.popState(),this.begin("com");break;case 22:return this.popState(),14;case 23:return 48;case 24:return 73;case 25:return 72;case 26:return 72;case 27:return 87;case 28:break;case 29:return this.popState(),54;case 30:return this.popState(),33;case 31:return t.yytext=s(1,2).replace(/\\"/g,'"'),80;case 32:return t.yytext=s(1,2).replace(/\\'/g,"'"),80;case 33:return 85;case 34:return 82;case 35:return 82;case 36:return 83;case 37:return 84;case 38:return 81;case 39:return 75;case 40:return 77;case 41:return 72;case 42:return t.yytext=t.yytext.replace(/\\([\\\]])/g,"$1"),72;case 43:return"INVALID";case 44:return 5}},e.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:\{\{\{\{(?=[^\/]))/,/^(?:\{\{\{\{\/[^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=[=}\s\/.])\}\}\}\})/,/^(?:[^\x00]*?(?=(\{\{\{\{)))/,/^(?:[\s\S]*?--(~)?\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{\{\{)/,/^(?:\}\}\}\})/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#>)/,/^(?:\{\{(~)?#\*?)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^\s*(~)?\}\})/,/^(?:\{\{(~)?\s*else\s*(~)?\}\})/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{(~)?!--)/,/^(?:\{\{(~)?![\s\S]*?\}\})/,/^(?:\{\{(~)?\*?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)|])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:undefined(?=([~}\s)])))/,/^(?:null(?=([~}\s)])))/,/^(?:-?[0-9]+(?:\.[0-9]+)?(?=([~}\s)])))/,/^(?:as\s+\|)/,/^(?:\|)/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)|]))))/,/^(?:\[(\\\]|[^\]])*\])/,/^(?:.)/,/^(?:$)/],e.conditions={mu:{rules:[7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],inclusive:!1},emu:{rules:[2],inclusive:!1},com:{rules:[6],inclusive:!1},raw:{rules:[3,4,5],inclusive:!1},INITIAL:{rules:[0,1,44],inclusive:!0}},e}();return t.lexer=i,e.prototype=t,t.Parser=e,new e}();t.__esModule=!0,t["default"]=i},function(e,t,i){"use strict";function n(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];this.options=e}function s(e,t,i){void 0===t&&(t=e.length);var n=e[t-1],s=e[t-2];return n?"ContentStatement"===n.type?(s||!i?/\r?\n\s*?$/:/(^|\r?\n)\s*?$/).test(n.original):void 0:i}function r(e,t,i){void 0===t&&(t=-1);var n=e[t+1],s=e[t+2];return n?"ContentStatement"===n.type?(s||!i?/^\s*?\r?\n/:/^\s*?(\r?\n|$)/).test(n.original):void 0:i}function a(e,t,i){var n=e[null==t?0:t+1];if(n&&"ContentStatement"===n.type&&(i||!n.rightStripped)){var s=n.value;n.value=n.value.replace(i?/^\s+/:/^[ \t]*\r?\n?/,""),n.rightStripped=n.value!==s}}function o(e,t,i){var n=e[null==t?e.length-1:t-1];if(n&&"ContentStatement"===n.type&&(i||!n.leftStripped)){var s=n.value;return n.value=n.value.replace(i?/\s+$/:/[ \t]+$/,""),n.leftStripped=n.value!==s,n.leftStripped}}var l=i(1)["default"];t.__esModule=!0;var c=i(25),u=l(c);n.prototype=new u["default"],n.prototype.Program=function(e){var t=!this.options.ignoreStandalone,i=!this.isRootSeen;this.isRootSeen=!0;for(var n=e.body,l=0,c=n.length;c>l;l++){var u=n[l],h=this.accept(u);if(h){var d=s(n,l,i),p=r(n,l,i),f=h.openStandalone&&d,m=h.closeStandalone&&p,g=h.inlineStandalone&&d&&p;h.close&&a(n,l,!0),h.open&&o(n,l,!0),t&&g&&(a(n,l),o(n,l)&&"PartialStatement"===u.type&&(u.indent=/([ \t]+$)/.exec(n[l-1].original)[1])),t&&f&&(a((u.program||u.inverse).body),o(n,l)),t&&m&&(a(n,l),o((u.inverse||u.program).body))}}return e},n.prototype.BlockStatement=n.prototype.DecoratorBlock=n.prototype.PartialBlockStatement=function(e){this.accept(e.program),this.accept(e.inverse);var t=e.program||e.inverse,i=e.program&&e.inverse,n=i,l=i;if(i&&i.chained)for(n=i.body[0].program;l.chained;)l=l.body[l.body.length-1].program;var c={open:e.openStrip.open,close:e.closeStrip.close,openStandalone:r(t.body),closeStandalone:s((n||t).body)};if(e.openStrip.close&&a(t.body,null,!0),i){var u=e.inverseStrip;u.open&&o(t.body,null,!0),u.close&&a(n.body,null,!0),e.closeStrip.open&&o(l.body,null,!0),!this.options.ignoreStandalone&&s(t.body)&&r(n.body)&&(o(t.body),a(n.body))}else e.closeStrip.open&&o(t.body,null,!0);return c},n.prototype.Decorator=n.prototype.MustacheStatement=function(e){return e.strip},n.prototype.PartialStatement=n.prototype.CommentStatement=function(e){var t=e.strip||{};return{inlineStandalone:!0,open:t.open,close:t.close}},t["default"]=n,e.exports=t["default"]},function(e,t,i){"use strict";function n(){this.parents=[]}function s(e){this.acceptRequired(e,"path"),this.acceptArray(e.params),this.acceptKey(e,"hash")}function r(e){s.call(this,e),this.acceptKey(e,"program"),this.acceptKey(e,"inverse")}function a(e){this.acceptRequired(e,"name"),this.acceptArray(e.params),this.acceptKey(e,"hash")}var o=i(1)["default"];t.__esModule=!0;var l=i(6),c=o(l);n.prototype={constructor:n,mutating:!1,acceptKey:function(e,t){var i=this.accept(e[t]);if(this.mutating){if(i&&!n.prototype[i.type])throw new c["default"]('Unexpected node type "'+i.type+'" found when accepting '+t+" on "+e.type);e[t]=i}},acceptRequired:function(e,t){if(this.acceptKey(e,t),!e[t])throw new c["default"](e.type+" requires "+t)},acceptArray:function(e){for(var t=0,i=e.length;i>t;t++)this.acceptKey(e,t),e[t]||(e.splice(t,1),t--,i--)},accept:function(e){if(e){if(!this[e.type])throw new c["default"]("Unknown type: "+e.type,e);this.current&&this.parents.unshift(this.current),this.current=e;var t=this[e.type](e);return this.current=this.parents.shift(),!this.mutating||t?t:t!==!1?e:void 0}},Program:function(e){this.acceptArray(e.body)},MustacheStatement:s,Decorator:s,BlockStatement:r,DecoratorBlock:r,PartialStatement:a,PartialBlockStatement:function(e){a.call(this,e),this.acceptKey(e,"program")},ContentStatement:function(){},CommentStatement:function(){},SubExpression:s,PathExpression:function(){},StringLiteral:function(){},NumberLiteral:function(){},BooleanLiteral:function(){},UndefinedLiteral:function(){},NullLiteral:function(){},Hash:function(e){this.acceptArray(e.pairs)},HashPair:function(e){this.acceptRequired(e,"value")}},t["default"]=n,e.exports=t["default"]},function(e,t,i){"use strict";function n(e,t){if(t=t.path?t.path.original:t,e.path.original!==t){var i={loc:e.path.loc};throw new g["default"](e.path.original+" doesn't match "+t,i)}}function s(e,t){this.source=e,this.start={line:t.first_line,column:t.first_column},this.end={line:t.last_line,column:t.last_column}}function r(e){return/^\[.*\]$/.test(e)?e.substr(1,e.length-2):e}function a(e,t){return{open:"~"===e.charAt(2),close:"~"===t.charAt(t.length-3)}}function o(e){return e.replace(/^\{\{~?\!-?-?/,"").replace(/-?-?~?\}\}$/,"")}function l(e,t,i){i=this.locInfo(i);for(var n=e?"@":"",s=[],r=0,a="",o=0,l=t.length;l>o;o++){var c=t[o].part,u=t[o].original!==c;if(n+=(t[o].separator||"")+c,u||".."!==c&&"."!==c&&"this"!==c)s.push(c);else{if(s.length>0)throw new g["default"]("Invalid path: "+n,{loc:i});".."===c&&(r++,a+="../")}}return{type:"PathExpression",data:e,depth:r,parts:s,original:n,loc:i}}function c(e,t,i,n,s,r){var a=n.charAt(3)||n.charAt(2),o="{"!==a&&"&"!==a,l=/\*/.test(n);return{type:l?"Decorator":"MustacheStatement",path:e,params:t,hash:i,escaped:o,strip:s,loc:this.locInfo(r)}}function u(e,t,i,s){n(e,i),s=this.locInfo(s);var r={type:"Program",body:t,strip:{},loc:s};return{type:"BlockStatement",path:e.path,params:e.params,hash:e.hash,program:r,openStrip:{},inverseStrip:{},closeStrip:{},loc:s}}function h(e,t,i,s,r,a){s&&s.path&&n(e,s);var o=/\*/.test(e.open);t.blockParams=e.blockParams;var l=void 0,c=void 0;if(i){if(o)throw new g["default"]("Unexpected inverse block on decorator",i);i.chain&&(i.program.body[0].closeStrip=s.strip),c=i.strip,l=i.program}return r&&(r=l,l=t,t=r),{type:o?"DecoratorBlock":"BlockStatement",path:e.path,params:e.params,hash:e.hash,program:t,inverse:l,openStrip:e.strip,inverseStrip:c,closeStrip:s&&s.strip,loc:this.locInfo(a)}}function d(e,t){if(!t&&e.length){var i=e[0].loc,n=e[e.length-1].loc;i&&n&&(t={source:i.source,start:{line:i.start.line,column:i.start.column},end:{line:n.end.line,column:n.end.column}})}return{type:"Program",body:e,strip:{},loc:t}}function p(e,t,i,s){return n(e,i),{type:"PartialBlockStatement",name:e.path,params:e.params,hash:e.hash,program:t,openStrip:e.strip,closeStrip:i&&i.strip,loc:this.locInfo(s)}}var f=i(1)["default"];t.__esModule=!0,t.SourceLocation=s,t.id=r,t.stripFlags=a,t.stripComment=o,t.preparePath=l,t.prepareMustache=c,t.prepareRawBlock=u,t.prepareBlock=h,t.prepareProgram=d,t.preparePartialBlock=p;var m=i(6),g=f(m)},function(e,t,i){"use strict";function n(){}function s(e,t,i){if(null==e||"string"!=typeof e&&"Program"!==e.type)throw new u["default"]("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+e);t=t||{},"data"in t||(t.data=!0),t.compat&&(t.useDepths=!0);var n=i.parse(e,t),s=(new i.Compiler).compile(n,t);return(new i.JavaScriptCompiler).compile(s,t)}function r(e,t,i){function n(){var n=i.parse(e,t),s=(new i.Compiler).compile(n,t),r=(new i.JavaScriptCompiler).compile(s,t,void 0,!0);return i.template(r)}function s(e,t){return r||(r=n()),r.call(this,e,t)}if(void 0===t&&(t={}),null==e||"string"!=typeof e&&"Program"!==e.type)throw new u["default"]("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+e);"data"in t||(t.data=!0),t.compat&&(t.useDepths=!0);var r=void 0;return s._setup=function(e){return r||(r=n()),r._setup(e)},s._child=function(e,t,i,s){return r||(r=n()),r._child(e,t,i,s)},s}function a(e,t){if(e===t)return!0;if(h.isArray(e)&&h.isArray(t)&&e.length===t.length){for(var i=0;i<e.length;i++)if(!a(e[i],t[i]))return!1;return!0}}function o(e){if(!e.path.parts){var t=e.path;e.path={type:"PathExpression",data:!1,depth:0,parts:[t.original+""],original:t.original+"",loc:t.loc}}}var l=i(1)["default"];t.__esModule=!0,t.Compiler=n,t.precompile=s,t.compile=r;var c=i(6),u=l(c),h=i(5),d=i(21),p=l(d),f=[].slice;n.prototype={compiler:n,equals:function(e){var t=this.opcodes.length;if(e.opcodes.length!==t)return!1;for(var i=0;t>i;i++){var n=this.opcodes[i],s=e.opcodes[i];if(n.opcode!==s.opcode||!a(n.args,s.args))return!1}t=this.children.length;for(var i=0;t>i;i++)if(!this.children[i].equals(e.children[i]))return!1;return!0},guid:0,compile:function(e,t){this.sourceNode=[],this.opcodes=[],this.children=[],this.options=t,this.stringParams=t.stringParams,this.trackIds=t.trackIds,t.blockParams=t.blockParams||[];var i=t.knownHelpers;if(t.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,"if":!0,unless:!0,"with":!0,log:!0,lookup:!0},i)for(var n in i)n in i&&(t.knownHelpers[n]=i[n]);return this.accept(e)},compileProgram:function(e){var t=new this.compiler,i=t.compile(e,this.options),n=this.guid++;return this.usePartial=this.usePartial||i.usePartial,this.children[n]=i,this.useDepths=this.useDepths||i.useDepths,n},accept:function(e){if(!this[e.type])throw new u["default"]("Unknown type: "+e.type,e);this.sourceNode.unshift(e);var t=this[e.type](e);return this.sourceNode.shift(),t},Program:function(e){this.options.blockParams.unshift(e.blockParams);for(var t=e.body,i=t.length,n=0;i>n;n++)this.accept(t[n]);return this.options.blockParams.shift(),this.isSimple=1===i,this.blockParams=e.blockParams?e.blockParams.length:0,this},BlockStatement:function(e){o(e);var t=e.program,i=e.inverse;t=t&&this.compileProgram(t),i=i&&this.compileProgram(i);var n=this.classifySexpr(e);"helper"===n?this.helperSexpr(e,t,i):"simple"===n?(this.simpleSexpr(e),this.opcode("pushProgram",t),this.opcode("pushProgram",i),this.opcode("emptyHash"),this.opcode("blockValue",e.path.original)):(this.ambiguousSexpr(e,t,i),this.opcode("pushProgram",t),this.opcode("pushProgram",i),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},DecoratorBlock:function(e){var t=e.program&&this.compileProgram(e.program),i=this.setupFullMustacheParams(e,t,void 0),n=e.path;this.useDecorators=!0,this.opcode("registerDecorator",i.length,n.original)},PartialStatement:function(e){this.usePartial=!0;var t=e.program;t&&(t=this.compileProgram(e.program));var i=e.params;if(i.length>1)throw new u["default"]("Unsupported number of partial arguments: "+i.length,e);i.length||(this.options.explicitPartialContext?this.opcode("pushLiteral","undefined"):i.push({type:"PathExpression",parts:[],depth:0}));var n=e.name.original,s="SubExpression"===e.name.type;s&&this.accept(e.name),this.setupFullMustacheParams(e,t,void 0,!0);var r=e.indent||"";this.options.preventIndent&&r&&(this.opcode("appendContent",r),r=""),this.opcode("invokePartial",s,n,r),this.opcode("append")},PartialBlockStatement:function(e){this.PartialStatement(e)},MustacheStatement:function(e){this.SubExpression(e),e.escaped&&!this.options.noEscape?this.opcode("appendEscaped"):this.opcode("append")},Decorator:function(e){this.DecoratorBlock(e)},ContentStatement:function(e){e.value&&this.opcode("appendContent",e.value)},CommentStatement:function(){},SubExpression:function(e){o(e);var t=this.classifySexpr(e);"simple"===t?this.simpleSexpr(e):"helper"===t?this.helperSexpr(e):this.ambiguousSexpr(e)},ambiguousSexpr:function(e,t,i){var n=e.path,s=n.parts[0],r=null!=t||null!=i;this.opcode("getContext",n.depth),this.opcode("pushProgram",t),this.opcode("pushProgram",i),n.strict=!0,this.accept(n),this.opcode("invokeAmbiguous",s,r)},simpleSexpr:function(e){var t=e.path;t.strict=!0,this.accept(t),this.opcode("resolvePossibleLambda")},helperSexpr:function(e,t,i){var n=this.setupFullMustacheParams(e,t,i),s=e.path,r=s.parts[0];if(this.options.knownHelpers[r])this.opcode("invokeKnownHelper",n.length,r);else{if(this.options.knownHelpersOnly)throw new u["default"]("You specified knownHelpersOnly, but used the unknown helper "+r,e);s.strict=!0,s.falsy=!0,this.accept(s),this.opcode("invokeHelper",n.length,s.original,p["default"].helpers.simpleId(s))}},PathExpression:function(e){this.addDepth(e.depth),this.opcode("getContext",e.depth);var t=e.parts[0],i=p["default"].helpers.scopedId(e),n=!e.depth&&!i&&this.blockParamIndex(t);n?this.opcode("lookupBlockParam",n,e.parts):t?e.data?(this.options.data=!0,this.opcode("lookupData",e.depth,e.parts,e.strict)):this.opcode("lookupOnContext",e.parts,e.falsy,e.strict,i):this.opcode("pushContext")},StringLiteral:function(e){this.opcode("pushString",e.value)},NumberLiteral:function(e){this.opcode("pushLiteral",e.value)},BooleanLiteral:function(e){this.opcode("pushLiteral",e.value)},UndefinedLiteral:function(){this.opcode("pushLiteral","undefined")},NullLiteral:function(){this.opcode("pushLiteral","null")},Hash:function(e){var t=e.pairs,i=0,n=t.length;for(this.opcode("pushHash");n>i;i++)this.pushParam(t[i].value);for(;i--;)this.opcode("assignToHash",t[i].key);this.opcode("popHash")},opcode:function(e){this.opcodes.push({opcode:e,args:f.call(arguments,1),loc:this.sourceNode[0].loc})},addDepth:function(e){e&&(this.useDepths=!0)},classifySexpr:function(e){var t=p["default"].helpers.simpleId(e.path),i=t&&!!this.blockParamIndex(e.path.parts[0]),n=!i&&p["default"].helpers.helperExpression(e),s=!i&&(n||t);if(s&&!n){var r=e.path.parts[0],a=this.options;a.knownHelpers[r]?n=!0:a.knownHelpersOnly&&(s=!1)}return n?"helper":s?"ambiguous":"simple"},pushParams:function(e){for(var t=0,i=e.length;i>t;t++)this.pushParam(e[t])},pushParam:function(e){var t=null!=e.value?e.value:e.original||"";if(this.stringParams)t.replace&&(t=t.replace(/^(\.?\.\/)*/g,"").replace(/\//g,".")),e.depth&&this.addDepth(e.depth),this.opcode("getContext",e.depth||0),this.opcode("pushStringParam",t,e.type),"SubExpression"===e.type&&this.accept(e);else{if(this.trackIds){var i=void 0;if(!e.parts||p["default"].helpers.scopedId(e)||e.depth||(i=this.blockParamIndex(e.parts[0])),i){var n=e.parts.slice(1).join(".");this.opcode("pushId","BlockParam",i,n)}else t=e.original||t,t.replace&&(t=t.replace(/^this(?:\.|$)/,"").replace(/^\.\//,"").replace(/^\.$/,"")),this.opcode("pushId",e.type,t)}this.accept(e)}},setupFullMustacheParams:function(e,t,i,n){var s=e.params;return this.pushParams(s),this.opcode("pushProgram",t),this.opcode("pushProgram",i),e.hash?this.accept(e.hash):this.opcode("emptyHash",n),s},blockParamIndex:function(e){for(var t=0,i=this.options.blockParams.length;i>t;t++){var n=this.options.blockParams[t],s=n&&h.indexOf(n,e);if(n&&s>=0)return[t,s]}}}},function(e,t,i){"use strict";function n(e){this.value=e}function s(){}function r(e,t,i,n){var s=t.popStack(),r=0,a=i.length;for(e&&a--;a>r;r++)s=t.nameLookup(s,i[r],n);return e?[t.aliasable("container.strict"),"(",s,", ",t.quotedString(i[r]),")"]:s}var a=i(1)["default"];t.__esModule=!0;var o=i(4),l=i(6),c=a(l),u=i(5),h=i(29),d=a(h);s.prototype={nameLookup:function(e,t){return s.isValidJavaScriptVariableName(t)?[e,".",t]:[e,"[",JSON.stringify(t),"]"]},depthedLookup:function(e){return[this.aliasable("container.lookup"),'(depths, "',e,'")']},compilerInfo:function(){var e=o.COMPILER_REVISION,t=o.REVISION_CHANGES[e];return[e,t]},appendToBuffer:function(e,t,i){return u.isArray(e)||(e=[e]),e=this.source.wrap(e,t),this.environment.isSimple?["return ",e,";"]:i?["buffer += ",e,";"]:(e.appendToBuffer=!0,e)},initializeBuffer:function(){return this.quotedString("")},compile:function(e,t,i,n){this.environment=e,this.options=t,this.stringParams=this.options.stringParams,this.trackIds=this.options.trackIds,this.precompile=!n,this.name=this.environment.name,this.isChild=!!i,this.context=i||{decorators:[],programs:[],environments:[]},this.preamble(),this.stackSlot=0,this.stackVars=[],this.aliases={},this.registers={list:[]},this.hashes=[],this.compileStack=[],this.inlineStack=[],this.blockParams=[],this.compileChildren(e,t),this.useDepths=this.useDepths||e.useDepths||e.useDecorators||this.options.compat,this.useBlockParams=this.useBlockParams||e.useBlockParams;var s=e.opcodes,r=void 0,a=void 0,o=void 0,l=void 0;for(o=0,l=s.length;l>o;o++)r=s[o],this.source.currentLocation=r.loc,a=a||r.loc,this[r.opcode].apply(this,r.args);if(this.source.currentLocation=a,this.pushSource(""),this.stackSlot||this.inlineStack.length||this.compileStack.length)throw new c["default"]("Compile completed with content left on stack");this.decorators.isEmpty()?this.decorators=void 0:(this.useDecorators=!0,this.decorators.prepend("var decorators = container.decorators;\n"),this.decorators.push("return fn;"),n?this.decorators=Function.apply(this,["fn","props","container","depth0","data","blockParams","depths",this.decorators.merge()]):(this.decorators.prepend("function(fn, props, container, depth0, data, blockParams, depths) {\n"),this.decorators.push("}\n"),this.decorators=this.decorators.merge()));var u=this.createFunctionContext(n);if(this.isChild)return u;var h={compiler:this.compilerInfo(),main:u};this.decorators&&(h.main_d=this.decorators,h.useDecorators=!0);var d=this.context,p=d.programs,f=d.decorators;for(o=0,l=p.length;l>o;o++)p[o]&&(h[o]=p[o],f[o]&&(h[o+"_d"]=f[o],h.useDecorators=!0));return this.environment.usePartial&&(h.usePartial=!0),this.options.data&&(h.useData=!0),this.useDepths&&(h.useDepths=!0),this.useBlockParams&&(h.useBlockParams=!0),this.options.compat&&(h.compat=!0),n?h.compilerOptions=this.options:(h.compiler=JSON.stringify(h.compiler),this.source.currentLocation={start:{line:1,column:0}},h=this.objectLiteral(h),t.srcName?(h=h.toStringWithSourceMap({file:t.destName}),h.map=h.map&&h.map.toString()):h=h.toString()),h},preamble:function(){this.lastContext=0,this.source=new d["default"](this.options.srcName),this.decorators=new d["default"](this.options.srcName)},createFunctionContext:function(e){var t="",i=this.stackVars.concat(this.registers.list);i.length>0&&(t+=", "+i.join(", "));var n=0;for(var s in this.aliases){var r=this.aliases[s];this.aliases.hasOwnProperty(s)&&r.children&&r.referenceCount>1&&(t+=", alias"+ ++n+"="+s,r.children[0]="alias"+n)}var a=["container","depth0","helpers","partials","data"];(this.useBlockParams||this.useDepths)&&a.push("blockParams"),this.useDepths&&a.push("depths");var o=this.mergeSource(t);return e?(a.push(o),Function.apply(this,a)):this.source.wrap(["function(",a.join(","),") {\n  ",o,"}"])},mergeSource:function(e){var t=this.environment.isSimple,i=!this.forceBuffer,n=void 0,s=void 0,r=void 0,a=void 0;return this.source.each(function(e){e.appendToBuffer?(r?e.prepend("  + "):r=e,a=e):(r&&(s?r.prepend("buffer += "):n=!0,a.add(";"),r=a=void 0),s=!0,t||(i=!1))}),i?r?(r.prepend("return "),a.add(";")):s||this.source.push('return "";'):(e+=", buffer = "+(n?"":this.initializeBuffer()),r?(r.prepend("return buffer + "),a.add(";")):this.source.push("return buffer;")),e&&this.source.prepend("var "+e.substring(2)+(n?"":";\n")),this.source.merge()},blockValue:function(e){var t=this.aliasable("helpers.blockHelperMissing"),i=[this.contextName(0)];this.setupHelperArgs(e,0,i);var n=this.popStack();i.splice(1,0,n),this.push(this.source.functionCall(t,"call",i))},ambiguousBlockValue:function(){var e=this.aliasable("helpers.blockHelperMissing"),t=[this.contextName(0)];this.setupHelperArgs("",0,t,!0),this.flushInline();var i=this.topStack();t.splice(1,0,i),this.pushSource(["if (!",this.lastHelper,") { ",i," = ",this.source.functionCall(e,"call",t),"}"])},appendContent:function(e){this.pendingContent?e=this.pendingContent+e:this.pendingLocation=this.source.currentLocation,this.pendingContent=e},append:function(){if(this.isInline())this.replaceStack(function(e){return[" != null ? ",e,' : ""']}),this.pushSource(this.appendToBuffer(this.popStack()));else{var e=this.popStack();this.pushSource(["if (",e," != null) { ",this.appendToBuffer(e,void 0,!0)," }"]),this.environment.isSimple&&this.pushSource(["else { ",this.appendToBuffer("''",void 0,!0)," }"])}},appendEscaped:function(){this.pushSource(this.appendToBuffer([this.aliasable("container.escapeExpression"),"(",this.popStack(),")"]))},getContext:function(e){this.lastContext=e},pushContext:function(){this.pushStackLiteral(this.contextName(this.lastContext))},lookupOnContext:function(e,t,i,n){var s=0;n||!this.options.compat||this.lastContext?this.pushContext():this.push(this.depthedLookup(e[s++])),this.resolvePath("context",e,s,t,i)},lookupBlockParam:function(e,t){this.useBlockParams=!0,this.push(["blockParams[",e[0],"][",e[1],"]"]),this.resolvePath("context",t,1)},lookupData:function(e,t,i){e?this.pushStackLiteral("container.data(data, "+e+")"):this.pushStackLiteral("data"),this.resolvePath("data",t,0,!0,i)},resolvePath:function(e,t,i,n,s){var a=this;if(this.options.strict||this.options.assumeObjects)return void this.push(r(this.options.strict&&s,this,t,e));for(var o=t.length;o>i;i++)this.replaceStack(function(s){var r=a.nameLookup(s,t[i],e);return n?[" && ",r]:[" != null ? ",r," : ",s]})},resolvePossibleLambda:function(){this.push([this.aliasable("container.lambda"),"(",this.popStack(),", ",this.contextName(0),")"])},pushStringParam:function(e,t){this.pushContext(),this.pushString(t),"SubExpression"!==t&&("string"==typeof e?this.pushString(e):this.pushStackLiteral(e))},emptyHash:function(e){this.trackIds&&this.push("{}"),this.stringParams&&(this.push("{}"),this.push("{}")),this.pushStackLiteral(e?"undefined":"{}")},pushHash:function(){this.hash&&this.hashes.push(this.hash),this.hash={values:[],types:[],contexts:[],ids:[]}},popHash:function(){var e=this.hash;this.hash=this.hashes.pop(),this.trackIds&&this.push(this.objectLiteral(e.ids)),this.stringParams&&(this.push(this.objectLiteral(e.contexts)),this.push(this.objectLiteral(e.types))),this.push(this.objectLiteral(e.values))},pushString:function(e){this.pushStackLiteral(this.quotedString(e))},pushLiteral:function(e){this.pushStackLiteral(e)},pushProgram:function(e){null!=e?this.pushStackLiteral(this.programExpression(e)):this.pushStackLiteral(null)},registerDecorator:function(e,t){var i=this.nameLookup("decorators",t,"decorator"),n=this.setupHelperArgs(t,e);this.decorators.push(["fn = ",this.decorators.functionCall(i,"",["fn","props","container",n])," || fn;"])},invokeHelper:function(e,t,i){var n=this.popStack(),s=this.setupHelper(e,t),r=i?[s.name," || "]:"",a=["("].concat(r,n);this.options.strict||a.push(" || ",this.aliasable("helpers.helperMissing")),a.push(")"),this.push(this.source.functionCall(a,"call",s.callParams))},invokeKnownHelper:function(e,t){var i=this.setupHelper(e,t);this.push(this.source.functionCall(i.name,"call",i.callParams))},invokeAmbiguous:function(e,t){this.useRegister("helper");var i=this.popStack();this.emptyHash();var n=this.setupHelper(0,e,t),s=this.lastHelper=this.nameLookup("helpers",e,"helper"),r=["(","(helper = ",s," || ",i,")"];this.options.strict||(r[0]="(helper = ",r.push(" != null ? helper : ",this.aliasable("helpers.helperMissing"))),this.push(["(",r,n.paramsInit?["),(",n.paramsInit]:[],"),","(typeof helper === ",this.aliasable('"function"')," ? ",this.source.functionCall("helper","call",n.callParams)," : helper))"])},invokePartial:function(e,t,i){var n=[],s=this.setupParams(t,1,n);e&&(t=this.popStack(),delete s.name),i&&(s.indent=JSON.stringify(i)),s.helpers="helpers",s.partials="partials",s.decorators="container.decorators",e?n.unshift(t):n.unshift(this.nameLookup("partials",t,"partial")),this.options.compat&&(s.depths="depths"),
s=this.objectLiteral(s),n.push(s),this.push(this.source.functionCall("container.invokePartial","",n))},assignToHash:function(e){var t=this.popStack(),i=void 0,n=void 0,s=void 0;this.trackIds&&(s=this.popStack()),this.stringParams&&(n=this.popStack(),i=this.popStack());var r=this.hash;i&&(r.contexts[e]=i),n&&(r.types[e]=n),s&&(r.ids[e]=s),r.values[e]=t},pushId:function(e,t,i){"BlockParam"===e?this.pushStackLiteral("blockParams["+t[0]+"].path["+t[1]+"]"+(i?" + "+JSON.stringify("."+i):"")):"PathExpression"===e?this.pushString(t):"SubExpression"===e?this.pushStackLiteral("true"):this.pushStackLiteral("null")},compiler:s,compileChildren:function(e,t){for(var i=e.children,n=void 0,s=void 0,r=0,a=i.length;a>r;r++){n=i[r],s=new this.compiler;var o=this.matchExistingProgram(n);null==o?(this.context.programs.push(""),o=this.context.programs.length,n.index=o,n.name="program"+o,this.context.programs[o]=s.compile(n,t,this.context,!this.precompile),this.context.decorators[o]=s.decorators,this.context.environments[o]=n,this.useDepths=this.useDepths||s.useDepths,this.useBlockParams=this.useBlockParams||s.useBlockParams):(n.index=o,n.name="program"+o,this.useDepths=this.useDepths||n.useDepths,this.useBlockParams=this.useBlockParams||n.useBlockParams)}},matchExistingProgram:function(e){for(var t=0,i=this.context.environments.length;i>t;t++){var n=this.context.environments[t];if(n&&n.equals(e))return t}},programExpression:function(e){var t=this.environment.children[e],i=[t.index,"data",t.blockParams];return(this.useBlockParams||this.useDepths)&&i.push("blockParams"),this.useDepths&&i.push("depths"),"container.program("+i.join(", ")+")"},useRegister:function(e){this.registers[e]||(this.registers[e]=!0,this.registers.list.push(e))},push:function(e){return e instanceof n||(e=this.source.wrap(e)),this.inlineStack.push(e),e},pushStackLiteral:function(e){this.push(new n(e))},pushSource:function(e){this.pendingContent&&(this.source.push(this.appendToBuffer(this.source.quotedString(this.pendingContent),this.pendingLocation)),this.pendingContent=void 0),e&&this.source.push(e)},replaceStack:function(e){var t=["("],i=void 0,s=void 0,r=void 0;if(!this.isInline())throw new c["default"]("replaceStack on non-inline");var a=this.popStack(!0);if(a instanceof n)i=[a.value],t=["(",i],r=!0;else{s=!0;var o=this.incrStack();t=["((",this.push(o)," = ",a,")"],i=this.topStack()}var l=e.call(this,i);r||this.popStack(),s&&this.stackSlot--,this.push(t.concat(l,")"))},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var e=this.inlineStack;this.inlineStack=[];for(var t=0,i=e.length;i>t;t++){var s=e[t];if(s instanceof n)this.compileStack.push(s);else{var r=this.incrStack();this.pushSource([r," = ",s,";"]),this.compileStack.push(r)}}},isInline:function(){return this.inlineStack.length},popStack:function(e){var t=this.isInline(),i=(t?this.inlineStack:this.compileStack).pop();if(!e&&i instanceof n)return i.value;if(!t){if(!this.stackSlot)throw new c["default"]("Invalid stack pop");this.stackSlot--}return i},topStack:function(){var e=this.isInline()?this.inlineStack:this.compileStack,t=e[e.length-1];return t instanceof n?t.value:t},contextName:function(e){return this.useDepths&&e?"depths["+e+"]":"depth"+e},quotedString:function(e){return this.source.quotedString(e)},objectLiteral:function(e){return this.source.objectLiteral(e)},aliasable:function(e){var t=this.aliases[e];return t?(t.referenceCount++,t):(t=this.aliases[e]=this.source.wrap(e),t.aliasable=!0,t.referenceCount=1,t)},setupHelper:function(e,t,i){var n=[],s=this.setupHelperArgs(t,e,n,i),r=this.nameLookup("helpers",t,"helper"),a=this.aliasable(this.contextName(0)+" != null ? "+this.contextName(0)+" : {}");return{params:n,paramsInit:s,name:r,callParams:[a].concat(n)}},setupParams:function(e,t,i){var n={},s=[],r=[],a=[],o=!i,l=void 0;o&&(i=[]),n.name=this.quotedString(e),n.hash=this.popStack(),this.trackIds&&(n.hashIds=this.popStack()),this.stringParams&&(n.hashTypes=this.popStack(),n.hashContexts=this.popStack());var c=this.popStack(),u=this.popStack();(u||c)&&(n.fn=u||"container.noop",n.inverse=c||"container.noop");for(var h=t;h--;)l=this.popStack(),i[h]=l,this.trackIds&&(a[h]=this.popStack()),this.stringParams&&(r[h]=this.popStack(),s[h]=this.popStack());return o&&(n.args=this.source.generateArray(i)),this.trackIds&&(n.ids=this.source.generateArray(a)),this.stringParams&&(n.types=this.source.generateArray(r),n.contexts=this.source.generateArray(s)),this.options.data&&(n.data="data"),this.useBlockParams&&(n.blockParams="blockParams"),n},setupHelperArgs:function(e,t,i,n){var s=this.setupParams(e,t,i);return s=this.objectLiteral(s),n?(this.useRegister("options"),i.push("options"),["options=",s]):i?(i.push(s),""):s}},function(){for(var e="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield await null true false".split(" "),t=s.RESERVED_WORDS={},i=0,n=e.length;n>i;i++)t[e[i]]=!0}(),s.isValidJavaScriptVariableName=function(e){return!s.RESERVED_WORDS[e]&&/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(e)},t["default"]=s,e.exports=t["default"]},function(e,t,i){"use strict";function n(e,t,i){if(r.isArray(e)){for(var n=[],s=0,a=e.length;a>s;s++)n.push(t.wrap(e[s],i));return n}return"boolean"==typeof e||"number"==typeof e?e+"":e}function s(e){this.srcFile=e,this.source=[]}t.__esModule=!0;var r=i(5),a=void 0;try{}catch(o){}a||(a=function(e,t,i,n){this.src="",n&&this.add(n)},a.prototype={add:function(e){r.isArray(e)&&(e=e.join("")),this.src+=e},prepend:function(e){r.isArray(e)&&(e=e.join("")),this.src=e+this.src},toStringWithSourceMap:function(){return{code:this.toString()}},toString:function(){return this.src}}),s.prototype={isEmpty:function(){return!this.source.length},prepend:function(e,t){this.source.unshift(this.wrap(e,t))},push:function(e,t){this.source.push(this.wrap(e,t))},merge:function(){var e=this.empty();return this.each(function(t){e.add(["  ",t,"\n"])}),e},each:function(e){for(var t=0,i=this.source.length;i>t;t++)e(this.source[t])},empty:function(){var e=this.currentLocation||{start:{}};return new a(e.start.line,e.start.column,this.srcFile)},wrap:function(e){var t=arguments.length<=1||void 0===arguments[1]?this.currentLocation||{start:{}}:arguments[1];return e instanceof a?e:(e=n(e,this,t),new a(t.start.line,t.start.column,this.srcFile,e))},functionCall:function(e,t,i){return i=this.generateList(i),this.wrap([e,t?"."+t+"(":"(",i,")"])},quotedString:function(e){return'"'+(e+"").replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},objectLiteral:function(e){var t=[];for(var i in e)if(e.hasOwnProperty(i)){var s=n(e[i],this);"undefined"!==s&&t.push([this.quotedString(i),":",s])}var r=this.generateList(t);return r.prepend("{"),r.add("}"),r},generateList:function(e){for(var t=this.empty(),i=0,s=e.length;s>i;i++)i&&t.add(","),t.add(n(e[i],this));return t},generateArray:function(e){var t=this.generateList(e);return t.prepend("["),t.add("]"),t}},t["default"]=s,e.exports=t["default"]}])}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define("moment",t):e.moment=t()}(this,function(){"use strict";function e(){return Zi.apply(null,arguments)}function t(e){Zi=e}function i(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function n(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function s(e,t){var i,n=[];for(i=0;i<e.length;++i)n.push(t(e[i],i));return n}function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function a(e,t){for(var i in t)r(t,i)&&(e[i]=t[i]);return r(t,"toString")&&(e.toString=t.toString),r(t,"valueOf")&&(e.valueOf=t.valueOf),e}function o(e,t,i,n){return Fe(e,t,i,n,!0).utc()}function l(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function c(e){return null==e._pf&&(e._pf=l()),e._pf}function u(e){if(null==e._isValid){var t=c(e);e._isValid=!(isNaN(e._d.getTime())||!(t.overflow<0)||t.empty||t.invalidMonth||t.invalidWeekday||t.nullInput||t.invalidFormat||t.userInvalidated),e._strict&&(e._isValid=e._isValid&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour)}return e._isValid}function h(e){var t=o(NaN);return null!=e?a(c(t),e):c(t).userInvalidated=!0,t}function d(e){return void 0===e}function p(e,t){var i,n,s;if(d(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),d(t._i)||(e._i=t._i),d(t._f)||(e._f=t._f),d(t._l)||(e._l=t._l),d(t._strict)||(e._strict=t._strict),d(t._tzm)||(e._tzm=t._tzm),d(t._isUTC)||(e._isUTC=t._isUTC),d(t._offset)||(e._offset=t._offset),d(t._pf)||(e._pf=c(t)),d(t._locale)||(e._locale=t._locale),Qi.length>0)for(i in Qi)n=Qi[i],s=t[n],d(s)||(e[n]=s);return e}function f(t){p(this,t),this._d=new Date(null!=t._d?t._d.getTime():NaN),Xi===!1&&(Xi=!0,e.updateOffset(this),Xi=!1)}function m(e){return e instanceof f||null!=e&&null!=e._isAMomentObject}function g(e){return 0>e?Math.ceil(e):Math.floor(e)}function v(e){var t=+e,i=0;return 0!==t&&isFinite(t)&&(i=g(t)),i}function y(e,t,i){var n,s=Math.min(e.length,t.length),r=Math.abs(e.length-t.length),a=0;for(n=0;s>n;n++)(i&&e[n]!==t[n]||!i&&v(e[n])!==v(t[n]))&&a++;return a+r}function b(t){e.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+t)}function _(e,t){var i=!0;return a(function(){return i&&(b(e+"\nArguments: "+Array.prototype.slice.call(arguments).join(", ")+"\n"+(new Error).stack),i=!1),t.apply(this,arguments)},t)}function k(e,t){en[e]||(b(t),en[e]=!0)}function w(e){return e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function S(e){return"[object Object]"===Object.prototype.toString.call(e)}function x(e){var t,i;for(i in e)t=e[i],w(t)?this[i]=t:this["_"+i]=t;this._config=e,this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)}function M(e,t){var i,n=a({},e);for(i in t)r(t,i)&&(S(e[i])&&S(t[i])?(n[i]={},a(n[i],e[i]),a(n[i],t[i])):null!=t[i]?n[i]=t[i]:delete n[i]);return n}function C(e){null!=e&&this.set(e)}function P(e){return e?e.toLowerCase().replace("_","-"):e}function T(e){for(var t,i,n,s,r=0;r<e.length;){for(s=P(e[r]).split("-"),t=s.length,i=P(e[r+1]),i=i?i.split("-"):null;t>0;){if(n=R(s.slice(0,t).join("-")))return n;if(i&&i.length>=t&&y(s,i,!0)>=t-1)break;t--}r++}return null}function R(e){var t=null;if(!nn[e]&&"undefined"!=typeof module&&module&&module.exports)try{t=tn._abbr,require("./locale/"+e),D(t)}catch(i){}return nn[e]}function D(e,t){var i;return e&&(i=d(t)?$(e):O(e,t),i&&(tn=i)),tn._abbr}function O(e,t){return null!==t?(t.abbr=e,null!=nn[e]?(k("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale"),t=M(nn[e]._config,t)):null!=t.parentLocale&&(null!=nn[t.parentLocale]?t=M(nn[t.parentLocale]._config,t):k("parentLocaleUndefined","specified parentLocale is not defined yet")),nn[e]=new C(t),D(e),nn[e]):(delete nn[e],null)}function E(e,t){if(null!=t){var i;null!=nn[e]&&(t=M(nn[e]._config,t)),i=new C(t),i.parentLocale=nn[e],nn[e]=i,D(e)}else null!=nn[e]&&(null!=nn[e].parentLocale?nn[e]=nn[e].parentLocale:null!=nn[e]&&delete nn[e]);return nn[e]}function $(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return tn;if(!i(e)){if(t=R(e))return t;e=[e]}return T(e)}function F(){return Object.keys(nn)}function V(e,t){var i=e.toLowerCase();sn[i]=sn[i+"s"]=sn[t]=e}function N(e){return"string"==typeof e?sn[e]||sn[e.toLowerCase()]:void 0}function A(e){var t,i,n={};for(i in e)r(e,i)&&(t=N(i),t&&(n[t]=e[i]));return n}function I(t,i){return function(n){return null!=n?(L(this,t,n),e.updateOffset(this,i),this):H(this,t)}}function H(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function L(e,t,i){e.isValid()&&e._d["set"+(e._isUTC?"UTC":"")+t](i)}function B(e,t){var i;if("object"==typeof e)for(i in e)this.set(i,e[i]);else if(e=N(e),w(this[e]))return this[e](t);return this}function Y(e,t,i){var n=""+Math.abs(e),s=t-n.length,r=e>=0;return(r?i?"+":"":"-")+Math.pow(10,Math.max(0,s)).toString().substr(1)+n}function U(e,t,i,n){var s=n;"string"==typeof n&&(s=function(){return this[n]()}),e&&(ln[e]=s),t&&(ln[t[0]]=function(){return Y(s.apply(this,arguments),t[1],t[2])}),i&&(ln[i]=function(){return this.localeData().ordinal(s.apply(this,arguments),e)})}function j(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function z(e){var t,i,n=e.match(rn);for(t=0,i=n.length;i>t;t++)ln[n[t]]?n[t]=ln[n[t]]:n[t]=j(n[t]);return function(s){var r="";for(t=0;i>t;t++)r+=n[t]instanceof Function?n[t].call(s,e):n[t];return r}}function q(e,t){return e.isValid()?(t=W(t,e.localeData()),on[t]=on[t]||z(t),on[t](e)):e.localeData().invalidDate()}function W(e,t){function i(e){return t.longDateFormat(e)||e}var n=5;for(an.lastIndex=0;n>=0&&an.test(e);)e=e.replace(an,i),an.lastIndex=0,n-=1;return e}function G(e,t,i){Cn[e]=w(t)?t:function(e,n){return e&&i?i:t}}function K(e,t){return r(Cn,e)?Cn[e](t._strict,t._locale):new RegExp(J(e))}function J(e){return Z(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,i,n,s){return t||i||n||s}))}function Z(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Q(e,t){var i,n=t;for("string"==typeof e&&(e=[e]),"number"==typeof t&&(n=function(e,i){i[t]=v(e)}),i=0;i<e.length;i++)Pn[e[i]]=n}function X(e,t){Q(e,function(e,i,n,s){n._w=n._w||{},t(e,n._w,n,s)})}function ee(e,t,i){null!=t&&r(Pn,e)&&Pn[e](t,i._a,i,e)}function te(e,t){return new Date(Date.UTC(e,t+1,0)).getUTCDate()}function ie(e,t){return i(this._months)?this._months[e.month()]:this._months[An.test(t)?"format":"standalone"][e.month()]}function ne(e,t){return i(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[An.test(t)?"format":"standalone"][e.month()]}function se(e,t,i){var n,s,r;for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;12>n;n++){if(s=o([2e3,n]),i&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(s,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(s,"").replace(".","")+"$","i")),i||this._monthsParse[n]||(r="^"+this.months(s,"")+"|^"+this.monthsShort(s,""),this._monthsParse[n]=new RegExp(r.replace(".",""),"i")),i&&"MMMM"===t&&this._longMonthsParse[n].test(e))return n;if(i&&"MMM"===t&&this._shortMonthsParse[n].test(e))return n;if(!i&&this._monthsParse[n].test(e))return n}}function re(e,t){var i;if(!e.isValid())return e;if("string"==typeof t)if(/^\d+$/.test(t))t=v(t);else if(t=e.localeData().monthsParse(t),"number"!=typeof t)return e;return i=Math.min(e.date(),te(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,i),e}function ae(t){return null!=t?(re(this,t),e.updateOffset(this,!0),this):H(this,"Month")}function oe(){return te(this.year(),this.month())}function le(e){return this._monthsParseExact?(r(this,"_monthsRegex")||ue.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex}function ce(e){return this._monthsParseExact?(r(this,"_monthsRegex")||ue.call(this),e?this._monthsStrictRegex:this._monthsRegex):this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex}function ue(){function e(e,t){return t.length-e.length}var t,i,n=[],s=[],r=[];for(t=0;12>t;t++)i=o([2e3,t]),n.push(this.monthsShort(i,"")),s.push(this.months(i,"")),r.push(this.months(i,"")),r.push(this.monthsShort(i,""));for(n.sort(e),s.sort(e),r.sort(e),t=0;12>t;t++)n[t]=Z(n[t]),s[t]=Z(s[t]),r[t]=Z(r[t]);this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+s.join("|")+")$","i"),this._monthsShortStrictRegex=new RegExp("^("+n.join("|")+")$","i")}function he(e){var t,i=e._a;return i&&-2===c(e).overflow&&(t=i[Rn]<0||i[Rn]>11?Rn:i[Dn]<1||i[Dn]>te(i[Tn],i[Rn])?Dn:i[On]<0||i[On]>24||24===i[On]&&(0!==i[En]||0!==i[$n]||0!==i[Fn])?On:i[En]<0||i[En]>59?En:i[$n]<0||i[$n]>59?$n:i[Fn]<0||i[Fn]>999?Fn:-1,c(e)._overflowDayOfYear&&(Tn>t||t>Dn)&&(t=Dn),c(e)._overflowWeeks&&-1===t&&(t=Vn),c(e)._overflowWeekday&&-1===t&&(t=Nn),c(e).overflow=t),e}function de(e){var t,i,n,s,r,a,o=e._i,l=Yn.exec(o)||Un.exec(o);if(l){for(c(e).iso=!0,t=0,i=zn.length;i>t;t++)if(zn[t][1].exec(l[1])){s=zn[t][0],n=zn[t][2]!==!1;break}if(null==s)return void(e._isValid=!1);if(l[3]){for(t=0,i=qn.length;i>t;t++)if(qn[t][1].exec(l[3])){r=(l[2]||" ")+qn[t][0];break}if(null==r)return void(e._isValid=!1)}if(!n&&null!=r)return void(e._isValid=!1);if(l[4]){if(!jn.exec(l[4]))return void(e._isValid=!1);a="Z"}e._f=s+(r||"")+(a||""),Pe(e)}else e._isValid=!1}function pe(t){var i=Wn.exec(t._i);return null!==i?void(t._d=new Date(+i[1])):(de(t),void(t._isValid===!1&&(delete t._isValid,e.createFromInputFallback(t))))}function fe(e,t,i,n,s,r,a){var o=new Date(e,t,i,n,s,r,a);return 100>e&&e>=0&&isFinite(o.getFullYear())&&o.setFullYear(e),o}function me(e){var t=new Date(Date.UTC.apply(null,arguments));return 100>e&&e>=0&&isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e),t}function ge(e){return ve(e)?366:365}function ve(e){return e%4===0&&e%100!==0||e%400===0}function ye(){return ve(this.year())}function be(e,t,i){var n=7+t-i,s=(7+me(e,0,n).getUTCDay()-t)%7;return-s+n-1}function _e(e,t,i,n,s){var r,a,o=(7+i-n)%7,l=be(e,n,s),c=1+7*(t-1)+o+l;return 0>=c?(r=e-1,a=ge(r)+c):c>ge(e)?(r=e+1,a=c-ge(e)):(r=e,a=c),{year:r,dayOfYear:a}}function ke(e,t,i){var n,s,r=be(e.year(),t,i),a=Math.floor((e.dayOfYear()-r-1)/7)+1;return 1>a?(s=e.year()-1,n=a+we(s,t,i)):a>we(e.year(),t,i)?(n=a-we(e.year(),t,i),s=e.year()+1):(s=e.year(),n=a),{week:n,year:s}}function we(e,t,i){var n=be(e,t,i),s=be(e+1,t,i);return(ge(e)-n+s)/7}function Se(e,t,i){return null!=e?e:null!=t?t:i}function xe(t){var i=new Date(e.now());return t._useUTC?[i.getUTCFullYear(),i.getUTCMonth(),i.getUTCDate()]:[i.getFullYear(),i.getMonth(),i.getDate()]}function Me(e){var t,i,n,s,r=[];if(!e._d){for(n=xe(e),e._w&&null==e._a[Dn]&&null==e._a[Rn]&&Ce(e),e._dayOfYear&&(s=Se(e._a[Tn],n[Tn]),e._dayOfYear>ge(s)&&(c(e)._overflowDayOfYear=!0),i=me(s,0,e._dayOfYear),e._a[Rn]=i.getUTCMonth(),e._a[Dn]=i.getUTCDate()),t=0;3>t&&null==e._a[t];++t)e._a[t]=r[t]=n[t];for(;7>t;t++)e._a[t]=r[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[On]&&0===e._a[En]&&0===e._a[$n]&&0===e._a[Fn]&&(e._nextDay=!0,e._a[On]=0),e._d=(e._useUTC?me:fe).apply(null,r),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[On]=24)}}function Ce(e){var t,i,n,s,r,a,o,l;t=e._w,null!=t.GG||null!=t.W||null!=t.E?(r=1,a=4,i=Se(t.GG,e._a[Tn],ke(Ve(),1,4).year),n=Se(t.W,1),s=Se(t.E,1),(1>s||s>7)&&(l=!0)):(r=e._locale._week.dow,a=e._locale._week.doy,i=Se(t.gg,e._a[Tn],ke(Ve(),r,a).year),n=Se(t.w,1),null!=t.d?(s=t.d,(0>s||s>6)&&(l=!0)):null!=t.e?(s=t.e+r,(t.e<0||t.e>6)&&(l=!0)):s=r),1>n||n>we(i,r,a)?c(e)._overflowWeeks=!0:null!=l?c(e)._overflowWeekday=!0:(o=_e(i,n,s,r,a),e._a[Tn]=o.year,e._dayOfYear=o.dayOfYear)}function Pe(t){if(t._f===e.ISO_8601)return void de(t);t._a=[],c(t).empty=!0;var i,n,s,r,a,o=""+t._i,l=o.length,u=0;for(s=W(t._f,t._locale).match(rn)||[],i=0;i<s.length;i++)r=s[i],n=(o.match(K(r,t))||[])[0],n&&(a=o.substr(0,o.indexOf(n)),a.length>0&&c(t).unusedInput.push(a),o=o.slice(o.indexOf(n)+n.length),u+=n.length),ln[r]?(n?c(t).empty=!1:c(t).unusedTokens.push(r),ee(r,n,t)):t._strict&&!n&&c(t).unusedTokens.push(r);c(t).charsLeftOver=l-u,o.length>0&&c(t).unusedInput.push(o),c(t).bigHour===!0&&t._a[On]<=12&&t._a[On]>0&&(c(t).bigHour=void 0),t._a[On]=Te(t._locale,t._a[On],t._meridiem),Me(t),he(t)}function Te(e,t,i){var n;return null==i?t:null!=e.meridiemHour?e.meridiemHour(t,i):null!=e.isPM?(n=e.isPM(i),n&&12>t&&(t+=12),n||12!==t||(t=0),t):t}function Re(e){var t,i,n,s,r;if(0===e._f.length)return c(e).invalidFormat=!0,void(e._d=new Date(NaN));for(s=0;s<e._f.length;s++)r=0,t=p({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[s],Pe(t),u(t)&&(r+=c(t).charsLeftOver,r+=10*c(t).unusedTokens.length,c(t).score=r,(null==n||n>r)&&(n=r,i=t));a(e,i||t)}function De(e){if(!e._d){var t=A(e._i);e._a=s([t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],function(e){return e&&parseInt(e,10)}),Me(e)}}function Oe(e){var t=new f(he(Ee(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function Ee(e){var t=e._i,s=e._f;return e._locale=e._locale||$(e._l),null===t||void 0===s&&""===t?h({nullInput:!0}):("string"==typeof t&&(e._i=t=e._locale.preparse(t)),m(t)?new f(he(t)):(i(s)?Re(e):s?Pe(e):n(t)?e._d=t:$e(e),u(e)||(e._d=null),e))}function $e(t){var r=t._i;void 0===r?t._d=new Date(e.now()):n(r)?t._d=new Date(+r):"string"==typeof r?pe(t):i(r)?(t._a=s(r.slice(0),function(e){return parseInt(e,10)}),Me(t)):"object"==typeof r?De(t):"number"==typeof r?t._d=new Date(r):e.createFromInputFallback(t)}function Fe(e,t,i,n,s){var r={};return"boolean"==typeof i&&(n=i,i=void 0),r._isAMomentObject=!0,r._useUTC=r._isUTC=s,r._l=i,r._i=e,r._f=t,r._strict=n,Oe(r)}function Ve(e,t,i,n){return Fe(e,t,i,n,!1)}function Ne(e,t){var n,s;if(1===t.length&&i(t[0])&&(t=t[0]),!t.length)return Ve();for(n=t[0],s=1;s<t.length;++s)(!t[s].isValid()||t[s][e](n))&&(n=t[s]);return n}function Ae(){var e=[].slice.call(arguments,0);return Ne("isBefore",e)}function Ie(){var e=[].slice.call(arguments,0);return Ne("isAfter",e)}function He(e){var t=A(e),i=t.year||0,n=t.quarter||0,s=t.month||0,r=t.week||0,a=t.day||0,o=t.hour||0,l=t.minute||0,c=t.second||0,u=t.millisecond||0;this._milliseconds=+u+1e3*c+6e4*l+36e5*o,this._days=+a+7*r,this._months=+s+3*n+12*i,this._data={},this._locale=$(),this._bubble()}function Le(e){return e instanceof He}function Be(e,t){U(e,0,0,function(){var e=this.utcOffset(),i="+";return 0>e&&(e=-e,i="-"),i+Y(~~(e/60),2)+t+Y(~~e%60,2)})}function Ye(e,t){var i=(t||"").match(e)||[],n=i[i.length-1]||[],s=(n+"").match(Qn)||["-",0,0],r=+(60*s[1])+v(s[2]);return"+"===s[0]?r:-r}function Ue(t,i){var s,r;return i._isUTC?(s=i.clone(),r=(m(t)||n(t)?+t:+Ve(t))-+s,s._d.setTime(+s._d+r),e.updateOffset(s,!1),s):Ve(t).local()}function je(e){return 15*-Math.round(e._d.getTimezoneOffset()/15)}function ze(t,i){var n,s=this._offset||0;return this.isValid()?null!=t?("string"==typeof t?t=Ye(Sn,t):Math.abs(t)<16&&(t=60*t),!this._isUTC&&i&&(n=je(this)),this._offset=t,this._isUTC=!0,null!=n&&this.add(n,"m"),s!==t&&(!i||this._changeInProgress?lt(this,it(t-s,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,e.updateOffset(this,!0),this._changeInProgress=null)),this):this._isUTC?s:je(this):null!=t?this:NaN}function qe(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function We(e){return this.utcOffset(0,e)}function Ge(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(je(this),"m")),this}function Ke(){return this._tzm?this.utcOffset(this._tzm):"string"==typeof this._i&&this.utcOffset(Ye(wn,this._i)),this}function Je(e){return this.isValid()?(e=e?Ve(e).utcOffset():0,(this.utcOffset()-e)%60===0):!1}function Ze(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Qe(){if(!d(this._isDSTShifted))return this._isDSTShifted;var e={};if(p(e,this),e=Ee(e),e._a){var t=e._isUTC?o(e._a):Ve(e._a);this._isDSTShifted=this.isValid()&&y(e._a,t.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}function Xe(){return this.isValid()?!this._isUTC:!1}function et(){return this.isValid()?this._isUTC:!1}function tt(){return this.isValid()?this._isUTC&&0===this._offset:!1}function it(e,t){var i,n,s,a=e,o=null;return Le(e)?a={ms:e._milliseconds,d:e._days,M:e._months}:"number"==typeof e?(a={},t?a[t]=e:a.milliseconds=e):(o=Xn.exec(e))?(i="-"===o[1]?-1:1,a={y:0,d:v(o[Dn])*i,h:v(o[On])*i,m:v(o[En])*i,s:v(o[$n])*i,ms:v(o[Fn])*i}):(o=es.exec(e))?(i="-"===o[1]?-1:1,a={y:nt(o[2],i),M:nt(o[3],i),w:nt(o[4],i),d:nt(o[5],i),h:nt(o[6],i),m:nt(o[7],i),s:nt(o[8],i)}):null==a?a={}:"object"==typeof a&&("from"in a||"to"in a)&&(s=rt(Ve(a.from),Ve(a.to)),a={},a.ms=s.milliseconds,a.M=s.months),n=new He(a),Le(e)&&r(e,"_locale")&&(n._locale=e._locale),n}function nt(e,t){var i=e&&parseFloat(e.replace(",","."));return(isNaN(i)?0:i)*t}function st(e,t){var i={milliseconds:0,months:0};return i.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(i.months,"M").isAfter(t)&&--i.months,i.milliseconds=+t-+e.clone().add(i.months,"M"),i}function rt(e,t){var i;return e.isValid()&&t.isValid()?(t=Ue(t,e),e.isBefore(t)?i=st(e,t):(i=st(t,e),i.milliseconds=-i.milliseconds,i.months=-i.months),i):{milliseconds:0,months:0}}function at(e){return 0>e?-1*Math.round(-1*e):Math.round(e)}function ot(e,t){return function(i,n){var s,r;return null===n||isNaN(+n)||(k(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period)."),r=i,i=n,n=r),i="string"==typeof i?+i:i,s=it(i,n),lt(this,s,e),this}}function lt(t,i,n,s){var r=i._milliseconds,a=at(i._days),o=at(i._months);t.isValid()&&(s=null==s?!0:s,r&&t._d.setTime(+t._d+r*n),a&&L(t,"Date",H(t,"Date")+a*n),o&&re(t,H(t,"Month")+o*n),s&&e.updateOffset(t,a||o))}function ct(e,t){var i=e||Ve(),n=Ue(i,this).startOf("day"),s=this.diff(n,"days",!0),r=-6>s?"sameElse":-1>s?"lastWeek":0>s?"lastDay":1>s?"sameDay":2>s?"nextDay":7>s?"nextWeek":"sameElse",a=t&&(w(t[r])?t[r]():t[r]);return this.format(a||this.localeData().calendar(r,this,Ve(i)))}function ut(){return new f(this)}function ht(e,t){var i=m(e)?e:Ve(e);return this.isValid()&&i.isValid()?(t=N(d(t)?"millisecond":t),"millisecond"===t?+this>+i:+i<+this.clone().startOf(t)):!1}function dt(e,t){var i=m(e)?e:Ve(e);return this.isValid()&&i.isValid()?(t=N(d(t)?"millisecond":t),"millisecond"===t?+i>+this:+this.clone().endOf(t)<+i):!1}function pt(e,t,i){return this.isAfter(e,i)&&this.isBefore(t,i)}function ft(e,t){var i,n=m(e)?e:Ve(e);return this.isValid()&&n.isValid()?(t=N(t||"millisecond"),"millisecond"===t?+this===+n:(i=+n,+this.clone().startOf(t)<=i&&i<=+this.clone().endOf(t))):!1}function mt(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function gt(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function vt(e,t,i){var n,s,r,a;return this.isValid()?(n=Ue(e,this),n.isValid()?(s=6e4*(n.utcOffset()-this.utcOffset()),t=N(t),"year"===t||"month"===t||"quarter"===t?(a=yt(this,n),"quarter"===t?a/=3:"year"===t&&(a/=12)):(r=this-n,a="second"===t?r/1e3:"minute"===t?r/6e4:"hour"===t?r/36e5:"day"===t?(r-s)/864e5:"week"===t?(r-s)/6048e5:r),i?a:g(a)):NaN):NaN}function yt(e,t){var i,n,s=12*(t.year()-e.year())+(t.month()-e.month()),r=e.clone().add(s,"months");return 0>t-r?(i=e.clone().add(s-1,"months"),n=(t-r)/(r-i)):(i=e.clone().add(s+1,"months"),n=(t-r)/(i-r)),-(s+n)}function bt(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function _t(){var e=this.clone().utc();return 0<e.year()&&e.year()<=9999?w(Date.prototype.toISOString)?this.toDate().toISOString():q(e,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):q(e,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}function kt(t){var i=q(this,t||e.defaultFormat);return this.localeData().postformat(i)}function wt(e,t){return this.isValid()&&(m(e)&&e.isValid()||Ve(e).isValid())?it({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function St(e){return this.from(Ve(),e)}function xt(e,t){return this.isValid()&&(m(e)&&e.isValid()||Ve(e).isValid())?it({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function Mt(e){return this.to(Ve(),e)}function Ct(e){var t;return void 0===e?this._locale._abbr:(t=$(e),null!=t&&(this._locale=t),this)}function Pt(){return this._locale}function Tt(e){switch(e=N(e)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e&&this.weekday(0),"isoWeek"===e&&this.isoWeekday(1),"quarter"===e&&this.month(3*Math.floor(this.month()/3)),this}function Rt(e){return e=N(e),void 0===e||"millisecond"===e?this:this.startOf(e).add(1,"isoWeek"===e?"week":e).subtract(1,"ms")}function Dt(){return+this._d-6e4*(this._offset||0)}function Ot(){return Math.floor(+this/1e3)}function Et(){return this._offset?new Date(+this):this._d}function $t(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function Ft(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function Vt(){return this.isValid()?this.toISOString():null}function Nt(){return u(this)}function At(){return a({},c(this))}function It(){return c(this).overflow}function Ht(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function Lt(e,t){U(0,[e,e.length],0,t)}function Bt(e){return zt.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function Yt(e){return zt.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function Ut(){return we(this.year(),1,4)}function jt(){var e=this.localeData()._week;return we(this.year(),e.dow,e.doy)}function zt(e,t,i,n,s){var r;return null==e?ke(this,n,s).year:(r=we(e,n,s),t>r&&(t=r),qt.call(this,e,t,i,n,s))}function qt(e,t,i,n,s){var r=_e(e,t,i,n,s),a=me(r.year,0,r.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}function Wt(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)}function Gt(e){return ke(e,this._week.dow,this._week.doy).week}function Kt(){return this._week.dow}function Jt(){return this._week.doy}function Zt(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")}function Qt(e){var t=ke(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")}function Xt(e,t){return"string"!=typeof e?e:isNaN(e)?(e=t.weekdaysParse(e),"number"==typeof e?e:null):parseInt(e,10)}function ei(e,t){return i(this._weekdays)?this._weekdays[e.day()]:this._weekdays[this._weekdays.isFormat.test(t)?"format":"standalone"][e.day()]}function ti(e){return this._weekdaysShort[e.day()]}function ii(e){return this._weekdaysMin[e.day()]}function ni(e,t,i){var n,s,r;for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;7>n;n++){if(s=Ve([2e3,1]).day(n),i&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(s,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(s,"").replace(".",".?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(s,"").replace(".",".?")+"$","i")),this._weekdaysParse[n]||(r="^"+this.weekdays(s,"")+"|^"+this.weekdaysShort(s,"")+"|^"+this.weekdaysMin(s,""),this._weekdaysParse[n]=new RegExp(r.replace(".",""),"i")),i&&"dddd"===t&&this._fullWeekdaysParse[n].test(e))return n;if(i&&"ddd"===t&&this._shortWeekdaysParse[n].test(e))return n;if(i&&"dd"===t&&this._minWeekdaysParse[n].test(e))return n;if(!i&&this._weekdaysParse[n].test(e))return n}}function si(e){if(!this.isValid())return null!=e?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=Xt(e,this.localeData()),this.add(e-t,"d")):t}function ri(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d");
}function ai(e){return this.isValid()?null==e?this.day()||7:this.day(this.day()%7?e:e-7):null!=e?this:NaN}function oi(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")}function li(){return this.hours()%12||12}function ci(e,t){U(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function ui(e,t){return t._meridiemParse}function hi(e){return"p"===(e+"").toLowerCase().charAt(0)}function di(e,t,i){return e>11?i?"pm":"PM":i?"am":"AM"}function pi(e,t){t[Fn]=v(1e3*("0."+e))}function fi(){return this._isUTC?"UTC":""}function mi(){return this._isUTC?"Coordinated Universal Time":""}function gi(e){return Ve(1e3*e)}function vi(){return Ve.apply(null,arguments).parseZone()}function yi(e,t,i){var n=this._calendar[e];return w(n)?n.call(t,i):n}function bi(e){var t=this._longDateFormat[e],i=this._longDateFormat[e.toUpperCase()];return t||!i?t:(this._longDateFormat[e]=i.replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e])}function _i(){return this._invalidDate}function ki(e){return this._ordinal.replace("%d",e)}function wi(e){return e}function Si(e,t,i,n){var s=this._relativeTime[i];return w(s)?s(e,t,i,n):s.replace(/%d/i,e)}function xi(e,t){var i=this._relativeTime[e>0?"future":"past"];return w(i)?i(t):i.replace(/%s/i,t)}function Mi(e,t,i,n){var s=$(),r=o().set(n,t);return s[i](r,e)}function Ci(e,t,i,n,s){if("number"==typeof e&&(t=e,e=void 0),e=e||"",null!=t)return Mi(e,t,i,s);var r,a=[];for(r=0;n>r;r++)a[r]=Mi(e,r,i,s);return a}function Pi(e,t){return Ci(e,t,"months",12,"month")}function Ti(e,t){return Ci(e,t,"monthsShort",12,"month")}function Ri(e,t){return Ci(e,t,"weekdays",7,"day")}function Di(e,t){return Ci(e,t,"weekdaysShort",7,"day")}function Oi(e,t){return Ci(e,t,"weekdaysMin",7,"day")}function Ei(){var e=this._data;return this._milliseconds=xs(this._milliseconds),this._days=xs(this._days),this._months=xs(this._months),e.milliseconds=xs(e.milliseconds),e.seconds=xs(e.seconds),e.minutes=xs(e.minutes),e.hours=xs(e.hours),e.months=xs(e.months),e.years=xs(e.years),this}function $i(e,t,i,n){var s=it(t,i);return e._milliseconds+=n*s._milliseconds,e._days+=n*s._days,e._months+=n*s._months,e._bubble()}function Fi(e,t){return $i(this,e,t,1)}function Vi(e,t){return $i(this,e,t,-1)}function Ni(e){return 0>e?Math.floor(e):Math.ceil(e)}function Ai(){var e,t,i,n,s,r=this._milliseconds,a=this._days,o=this._months,l=this._data;return r>=0&&a>=0&&o>=0||0>=r&&0>=a&&0>=o||(r+=864e5*Ni(Hi(o)+a),a=0,o=0),l.milliseconds=r%1e3,e=g(r/1e3),l.seconds=e%60,t=g(e/60),l.minutes=t%60,i=g(t/60),l.hours=i%24,a+=g(i/24),s=g(Ii(a)),o+=s,a-=Ni(Hi(s)),n=g(o/12),o%=12,l.days=a,l.months=o,l.years=n,this}function Ii(e){return 4800*e/146097}function Hi(e){return 146097*e/4800}function Li(e){var t,i,n=this._milliseconds;if(e=N(e),"month"===e||"year"===e)return t=this._days+n/864e5,i=this._months+Ii(t),"month"===e?i:i/12;switch(t=this._days+Math.round(Hi(this._months)),e){case"week":return t/7+n/6048e5;case"day":return t+n/864e5;case"hour":return 24*t+n/36e5;case"minute":return 1440*t+n/6e4;case"second":return 86400*t+n/1e3;case"millisecond":return Math.floor(864e5*t)+n;default:throw new Error("Unknown unit "+e)}}function Bi(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*v(this._months/12)}function Yi(e){return function(){return this.as(e)}}function Ui(e){return e=N(e),this[e+"s"]()}function ji(e){return function(){return this._data[e]}}function zi(){return g(this.days()/7)}function qi(e,t,i,n,s){return s.relativeTime(t||1,!!i,e,n)}function Wi(e,t,i){var n=it(e).abs(),s=Ls(n.as("s")),r=Ls(n.as("m")),a=Ls(n.as("h")),o=Ls(n.as("d")),l=Ls(n.as("M")),c=Ls(n.as("y")),u=s<Bs.s&&["s",s]||1>=r&&["m"]||r<Bs.m&&["mm",r]||1>=a&&["h"]||a<Bs.h&&["hh",a]||1>=o&&["d"]||o<Bs.d&&["dd",o]||1>=l&&["M"]||l<Bs.M&&["MM",l]||1>=c&&["y"]||["yy",c];return u[2]=t,u[3]=+e>0,u[4]=i,qi.apply(null,u)}function Gi(e,t){return void 0===Bs[e]?!1:void 0===t?Bs[e]:(Bs[e]=t,!0)}function Ki(e){var t=this.localeData(),i=Wi(this,!e,t);return e&&(i=t.pastFuture(+this,i)),t.postformat(i)}function Ji(){var e,t,i,n=Ys(this._milliseconds)/1e3,s=Ys(this._days),r=Ys(this._months);e=g(n/60),t=g(e/60),n%=60,e%=60,i=g(r/12),r%=12;var a=i,o=r,l=s,c=t,u=e,h=n,d=this.asSeconds();return d?(0>d?"-":"")+"P"+(a?a+"Y":"")+(o?o+"M":"")+(l?l+"D":"")+(c||u||h?"T":"")+(c?c+"H":"")+(u?u+"M":"")+(h?h+"S":""):"P0D"}var Zi,Qi=e.momentProperties=[],Xi=!1,en={};e.suppressDeprecationWarnings=!1;var tn,nn={},sn={},rn=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,an=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,on={},ln={},cn=/\d/,un=/\d\d/,hn=/\d{3}/,dn=/\d{4}/,pn=/[+-]?\d{6}/,fn=/\d\d?/,mn=/\d\d\d\d?/,gn=/\d\d\d\d\d\d?/,vn=/\d{1,3}/,yn=/\d{1,4}/,bn=/[+-]?\d{1,6}/,_n=/\d+/,kn=/[+-]?\d+/,wn=/Z|[+-]\d\d:?\d\d/gi,Sn=/Z|[+-]\d\d(?::?\d\d)?/gi,xn=/[+-]?\d+(\.\d{1,3})?/,Mn=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Cn={},Pn={},Tn=0,Rn=1,Dn=2,On=3,En=4,$n=5,Fn=6,Vn=7,Nn=8;U("M",["MM",2],"Mo",function(){return this.month()+1}),U("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),U("MMMM",0,0,function(e){return this.localeData().months(this,e)}),V("month","M"),G("M",fn),G("MM",fn,un),G("MMM",function(e,t){return t.monthsShortRegex(e)}),G("MMMM",function(e,t){return t.monthsRegex(e)}),Q(["M","MM"],function(e,t){t[Rn]=v(e)-1}),Q(["MMM","MMMM"],function(e,t,i,n){var s=i._locale.monthsParse(e,n,i._strict);null!=s?t[Rn]=s:c(i).invalidMonth=e});var An=/D[oD]?(\[[^\[\]]*\]|\s+)+MMMM?/,In="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Hn="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),Ln=Mn,Bn=Mn,Yn=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,Un=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,jn=/Z|[+-]\d\d(?::?\d\d)?/,zn=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],qn=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Wn=/^\/?Date\((\-?\d+)/i;e.createFromInputFallback=_("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),U("Y",0,0,function(){var e=this.year();return 9999>=e?""+e:"+"+e}),U(0,["YY",2],0,function(){return this.year()%100}),U(0,["YYYY",4],0,"year"),U(0,["YYYYY",5],0,"year"),U(0,["YYYYYY",6,!0],0,"year"),V("year","y"),G("Y",kn),G("YY",fn,un),G("YYYY",yn,dn),G("YYYYY",bn,pn),G("YYYYYY",bn,pn),Q(["YYYYY","YYYYYY"],Tn),Q("YYYY",function(t,i){i[Tn]=2===t.length?e.parseTwoDigitYear(t):v(t)}),Q("YY",function(t,i){i[Tn]=e.parseTwoDigitYear(t)}),Q("Y",function(e,t){t[Tn]=parseInt(e,10)}),e.parseTwoDigitYear=function(e){return v(e)+(v(e)>68?1900:2e3)};var Gn=I("FullYear",!1);e.ISO_8601=function(){};var Kn=_("moment().min is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(){var e=Ve.apply(null,arguments);return this.isValid()&&e.isValid()?this>e?this:e:h()}),Jn=_("moment().max is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(){var e=Ve.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:h()}),Zn=function(){return Date.now?Date.now():+new Date};Be("Z",":"),Be("ZZ",""),G("Z",Sn),G("ZZ",Sn),Q(["Z","ZZ"],function(e,t,i){i._useUTC=!0,i._tzm=Ye(Sn,e)});var Qn=/([\+\-]|\d\d)/gi;e.updateOffset=function(){};var Xn=/^(\-)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?\d*)?$/,es=/^(-)?P(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)W)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?$/;it.fn=He.prototype;var ts=ot(1,"add"),is=ot(-1,"subtract");e.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";var ns=_("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return void 0===e?this.localeData():this.locale(e)});U(0,["gg",2],0,function(){return this.weekYear()%100}),U(0,["GG",2],0,function(){return this.isoWeekYear()%100}),Lt("gggg","weekYear"),Lt("ggggg","weekYear"),Lt("GGGG","isoWeekYear"),Lt("GGGGG","isoWeekYear"),V("weekYear","gg"),V("isoWeekYear","GG"),G("G",kn),G("g",kn),G("GG",fn,un),G("gg",fn,un),G("GGGG",yn,dn),G("gggg",yn,dn),G("GGGGG",bn,pn),G("ggggg",bn,pn),X(["gggg","ggggg","GGGG","GGGGG"],function(e,t,i,n){t[n.substr(0,2)]=v(e)}),X(["gg","GG"],function(t,i,n,s){i[s]=e.parseTwoDigitYear(t)}),U("Q",0,"Qo","quarter"),V("quarter","Q"),G("Q",cn),Q("Q",function(e,t){t[Rn]=3*(v(e)-1)}),U("w",["ww",2],"wo","week"),U("W",["WW",2],"Wo","isoWeek"),V("week","w"),V("isoWeek","W"),G("w",fn),G("ww",fn,un),G("W",fn),G("WW",fn,un),X(["w","ww","W","WW"],function(e,t,i,n){t[n.substr(0,1)]=v(e)});var ss={dow:0,doy:6};U("D",["DD",2],"Do","date"),V("date","D"),G("D",fn),G("DD",fn,un),G("Do",function(e,t){return e?t._ordinalParse:t._ordinalParseLenient}),Q(["D","DD"],Dn),Q("Do",function(e,t){t[Dn]=v(e.match(fn)[0],10)});var rs=I("Date",!0);U("d",0,"do","day"),U("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),U("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),U("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),U("e",0,0,"weekday"),U("E",0,0,"isoWeekday"),V("day","d"),V("weekday","e"),V("isoWeekday","E"),G("d",fn),G("e",fn),G("E",fn),G("dd",Mn),G("ddd",Mn),G("dddd",Mn),X(["dd","ddd","dddd"],function(e,t,i,n){var s=i._locale.weekdaysParse(e,n,i._strict);null!=s?t.d=s:c(i).invalidWeekday=e}),X(["d","e","E"],function(e,t,i,n){t[n]=v(e)});var as="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),os="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),ls="Su_Mo_Tu_We_Th_Fr_Sa".split("_");U("DDD",["DDDD",3],"DDDo","dayOfYear"),V("dayOfYear","DDD"),G("DDD",vn),G("DDDD",hn),Q(["DDD","DDDD"],function(e,t,i){i._dayOfYear=v(e)}),U("H",["HH",2],0,"hour"),U("h",["hh",2],0,li),U("hmm",0,0,function(){return""+li.apply(this)+Y(this.minutes(),2)}),U("hmmss",0,0,function(){return""+li.apply(this)+Y(this.minutes(),2)+Y(this.seconds(),2)}),U("Hmm",0,0,function(){return""+this.hours()+Y(this.minutes(),2)}),U("Hmmss",0,0,function(){return""+this.hours()+Y(this.minutes(),2)+Y(this.seconds(),2)}),ci("a",!0),ci("A",!1),V("hour","h"),G("a",ui),G("A",ui),G("H",fn),G("h",fn),G("HH",fn,un),G("hh",fn,un),G("hmm",mn),G("hmmss",gn),G("Hmm",mn),G("Hmmss",gn),Q(["H","HH"],On),Q(["a","A"],function(e,t,i){i._isPm=i._locale.isPM(e),i._meridiem=e}),Q(["h","hh"],function(e,t,i){t[On]=v(e),c(i).bigHour=!0}),Q("hmm",function(e,t,i){var n=e.length-2;t[On]=v(e.substr(0,n)),t[En]=v(e.substr(n)),c(i).bigHour=!0}),Q("hmmss",function(e,t,i){var n=e.length-4,s=e.length-2;t[On]=v(e.substr(0,n)),t[En]=v(e.substr(n,2)),t[$n]=v(e.substr(s)),c(i).bigHour=!0}),Q("Hmm",function(e,t,i){var n=e.length-2;t[On]=v(e.substr(0,n)),t[En]=v(e.substr(n))}),Q("Hmmss",function(e,t,i){var n=e.length-4,s=e.length-2;t[On]=v(e.substr(0,n)),t[En]=v(e.substr(n,2)),t[$n]=v(e.substr(s))});var cs=/[ap]\.?m?\.?/i,us=I("Hours",!0);U("m",["mm",2],0,"minute"),V("minute","m"),G("m",fn),G("mm",fn,un),Q(["m","mm"],En);var hs=I("Minutes",!1);U("s",["ss",2],0,"second"),V("second","s"),G("s",fn),G("ss",fn,un),Q(["s","ss"],$n);var ds=I("Seconds",!1);U("S",0,0,function(){return~~(this.millisecond()/100)}),U(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),U(0,["SSS",3],0,"millisecond"),U(0,["SSSS",4],0,function(){return 10*this.millisecond()}),U(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),U(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),U(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),U(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),U(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),V("millisecond","ms"),G("S",vn,cn),G("SS",vn,un),G("SSS",vn,hn);var ps;for(ps="SSSS";ps.length<=9;ps+="S")G(ps,_n);for(ps="S";ps.length<=9;ps+="S")Q(ps,pi);var fs=I("Milliseconds",!1);U("z",0,0,"zoneAbbr"),U("zz",0,0,"zoneName");var ms=f.prototype;ms.add=ts,ms.calendar=ct,ms.clone=ut,ms.diff=vt,ms.endOf=Rt,ms.format=kt,ms.from=wt,ms.fromNow=St,ms.to=xt,ms.toNow=Mt,ms.get=B,ms.invalidAt=It,ms.isAfter=ht,ms.isBefore=dt,ms.isBetween=pt,ms.isSame=ft,ms.isSameOrAfter=mt,ms.isSameOrBefore=gt,ms.isValid=Nt,ms.lang=ns,ms.locale=Ct,ms.localeData=Pt,ms.max=Jn,ms.min=Kn,ms.parsingFlags=At,ms.set=B,ms.startOf=Tt,ms.subtract=is,ms.toArray=$t,ms.toObject=Ft,ms.toDate=Et,ms.toISOString=_t,ms.toJSON=Vt,ms.toString=bt,ms.unix=Ot,ms.valueOf=Dt,ms.creationData=Ht,ms.year=Gn,ms.isLeapYear=ye,ms.weekYear=Bt,ms.isoWeekYear=Yt,ms.quarter=ms.quarters=Wt,ms.month=ae,ms.daysInMonth=oe,ms.week=ms.weeks=Zt,ms.isoWeek=ms.isoWeeks=Qt,ms.weeksInYear=jt,ms.isoWeeksInYear=Ut,ms.date=rs,ms.day=ms.days=si,ms.weekday=ri,ms.isoWeekday=ai,ms.dayOfYear=oi,ms.hour=ms.hours=us,ms.minute=ms.minutes=hs,ms.second=ms.seconds=ds,ms.millisecond=ms.milliseconds=fs,ms.utcOffset=ze,ms.utc=We,ms.local=Ge,ms.parseZone=Ke,ms.hasAlignedHourOffset=Je,ms.isDST=Ze,ms.isDSTShifted=Qe,ms.isLocal=Xe,ms.isUtcOffset=et,ms.isUtc=tt,ms.isUTC=tt,ms.zoneAbbr=fi,ms.zoneName=mi,ms.dates=_("dates accessor is deprecated. Use date instead.",rs),ms.months=_("months accessor is deprecated. Use month instead",ae),ms.years=_("years accessor is deprecated. Use year instead",Gn),ms.zone=_("moment().zone is deprecated, use moment().utcOffset instead. https://github.com/moment/moment/issues/1779",qe);var gs=ms,vs={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},ys={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},bs="Invalid date",_s="%d",ks=/\d{1,2}/,ws={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},Ss=C.prototype;Ss._calendar=vs,Ss.calendar=yi,Ss._longDateFormat=ys,Ss.longDateFormat=bi,Ss._invalidDate=bs,Ss.invalidDate=_i,Ss._ordinal=_s,Ss.ordinal=ki,Ss._ordinalParse=ks,Ss.preparse=wi,Ss.postformat=wi,Ss._relativeTime=ws,Ss.relativeTime=Si,Ss.pastFuture=xi,Ss.set=x,Ss.months=ie,Ss._months=In,Ss.monthsShort=ne,Ss._monthsShort=Hn,Ss.monthsParse=se,Ss._monthsRegex=Bn,Ss.monthsRegex=ce,Ss._monthsShortRegex=Ln,Ss.monthsShortRegex=le,Ss.week=Gt,Ss._week=ss,Ss.firstDayOfYear=Jt,Ss.firstDayOfWeek=Kt,Ss.weekdays=ei,Ss._weekdays=as,Ss.weekdaysMin=ii,Ss._weekdaysMin=ls,Ss.weekdaysShort=ti,Ss._weekdaysShort=os,Ss.weekdaysParse=ni,Ss.isPM=hi,Ss._meridiemParse=cs,Ss.meridiem=di,D("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,i=1===v(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+i}}),e.lang=_("moment.lang is deprecated. Use moment.locale instead.",D),e.langData=_("moment.langData is deprecated. Use moment.localeData instead.",$);var xs=Math.abs,Ms=Yi("ms"),Cs=Yi("s"),Ps=Yi("m"),Ts=Yi("h"),Rs=Yi("d"),Ds=Yi("w"),Os=Yi("M"),Es=Yi("y"),$s=ji("milliseconds"),Fs=ji("seconds"),Vs=ji("minutes"),Ns=ji("hours"),As=ji("days"),Is=ji("months"),Hs=ji("years"),Ls=Math.round,Bs={s:45,m:45,h:22,d:26,M:11},Ys=Math.abs,Us=He.prototype;Us.abs=Ei,Us.add=Fi,Us.subtract=Vi,Us.as=Li,Us.asMilliseconds=Ms,Us.asSeconds=Cs,Us.asMinutes=Ps,Us.asHours=Ts,Us.asDays=Rs,Us.asWeeks=Ds,Us.asMonths=Os,Us.asYears=Es,Us.valueOf=Bi,Us._bubble=Ai,Us.get=Ui,Us.milliseconds=$s,Us.seconds=Fs,Us.minutes=Vs,Us.hours=Ns,Us.days=As,Us.weeks=zi,Us.months=Is,Us.years=Hs,Us.humanize=Ki,Us.toISOString=Ji,Us.toString=Ji,Us.toJSON=Ji,Us.locale=Ct,Us.localeData=Pt,Us.toIsoString=_("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Ji),Us.lang=ns,U("X",0,0,"unix"),U("x",0,0,"valueOf"),G("x",kn),G("X",xn),Q("X",function(e,t,i){i._d=new Date(1e3*parseFloat(e,10))}),Q("x",function(e,t,i){i._d=new Date(v(e))}),e.version="2.12.0",t(Ve),e.fn=gs,e.min=Ae,e.max=Ie,e.now=Zn,e.utc=o,e.unix=gi,e.months=Pi,e.isDate=n,e.locale=D,e.invalid=h,e.duration=it,e.isMoment=m,e.weekdays=Ri,e.parseZone=vi,e.localeData=$,e.isDuration=Le,e.monthsShort=Ti,e.weekdaysMin=Oi,e.defineLocale=O,e.updateLocale=E,e.locales=F,e.weekdaysShort=Di,e.normalizeUnits=N,e.relativeTimeThreshold=Gi,e.prototype=gs;var js=e;return js}),define("app/util/utils",["jquery"],function(e){function t(e){var t=null;if(document.cookie&&""!=document.cookie)for(var i=document.cookie.split(";"),n=0;n<i.length;n++){var s=jQuery.trim(i[n]);if(s.substring(0,e.length+1)==e+"="){t=decodeURIComponent(s.substring(e.length+1));break}}return t}function i(e){return/^(GET|HEAD|OPTIONS|TRACE)$/.test(e)}var n=t("csrftoken");return e.ajaxSetup({beforeSend:function(e,t){i(t.type)||this.crossDomain||e.setRequestHeader("X-CSRFToken",n)}}),{toggleClass:function(e,t,i){return"undefined"!=typeof i?(i?e.addClass(t):e.removeClass(t),i):e.hasClass(t)?(e.removeClass(t),!1):(e.addClass(t),!0)},getParameterByName:function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var i=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),n=i.exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null},bindLoadingButtons:function(t){t.on("click",".loading-button",function(t){var i=e(t.target).closest(".loading-button");return i.data("busy")?(t.stopPropagation(),void t.stopImmediatePropagation()):(i.data("busy",!0),void i.find(".eai").removeAttr("class").addClass("eai eai-loading"))})},restoreLoadingButton:function(e,t){e.data("busy",!1),e.find(".eai").removeAttr("class").addClass("eai "+t)},popup:function(e,t,i,n){t=t||"etalia-popup",i=i||520,n=n||460;var s=Math.round(window.innerWidth/2-i/2),r=Math.round(window.innerHeight/2-n/2),a="menubar=no,toolbar=no,resizable=yes,scrollbars=yes,width="+i+",height="+n+",top="+r+",left="+s;return window.open(e,t,a)}}}),define("app/ui/layout/flap",["jquery"],function(e){var t=function(t){t=t||{},this.config=e.extend({debug:!1,flap:null,side:null,button:null,backdrop:null,mobileMaxWidth:992},t),this.$flap=e(this.config.flap),this.$button=e(this.config.button),this.$backdrop=e(this.config.backdrop),this.mobile=null,this.clickHandlersEnabled=!1,this.opened=!1;var i=this;this.log=function(e){i.config.debug&&console.log("[Flap "+this.config.side+"] "+e)},this.buttonClickHandler=function(){i.log("Button click handler"),i.open()},this.backdropClickHandler=function(){i.log("Overlay click handler"),i.close()},this.$flap.on("redraw",function(){i.init()})};return t.prototype.init=function(){this.log("Flap init"),this.$flap.css({height:window.innerHeight+"px"});var e=window.innerWidth<this.config.mobileMaxWidth;e!=this.mobile&&(this.close(),e?this.enableClickHandlers():this.disableClickHandlers()),this.mobile=e},t.prototype.enableClickHandlers=function(){this.clickHandlersEnabled||(this.log("enableClickHandlers"),this.$button.on("click",this.buttonClickHandler),this.$backdrop.on("click",this.backdropClickHandler),this.clickHandlersEnabled=!0)},t.prototype.disableClickHandlers=function(){this.clickHandlersEnabled&&(this.log("disableClickHandlers"),this.$button.off("click",this.buttonClickHandler),this.$backdrop.off("click",this.backdropClickHandler),this.clickHandlersEnabled=!1)},t.prototype.open=function(){return this.opened?this:(e("body").addClass("flap-opened").addClass(this.config.side),void(this.opened=!0))},t.prototype.close=function(){return this.opened?(e("body").removeClass("flap-opened").removeClass(this.config.side),void(this.opened=!1)):this},t}),define("app/ui/layout/interact",["jquery"],function(e){var t=function(t){this.config=e.extend({debug:!1},t)};return t.prototype.log=function(){return this.config.debug&&console.log("[Interact] "+arguments[0],Array.prototype.splice.call(arguments,1)),this},t.prototype.init=function(){this.log("init()");var e=this,t=0,i=setInterval(function(){return e.log("check ga",t,typeof ga),"function"==typeof ga?(e.initHandlers(),void clearInterval(i)):(t++,void(t>20&&clearInterval(i)))},500);return this},t.prototype.initHandlers=function(){this.log("initHandlers()");var t=this,i=e("body"),n="control";return i.on("etalia.control.search.change",function(e,i){var s={hitType:"event",eventCategory:n,eventAction:"search",eventLabel:i.expression};t.log("ga.send()",s),ga("send",s)}).on("etalia.control.timespan.change",function(e,i){var s={hitType:"event",eventCategory:n,eventAction:"timespan",eventLabel:i.label,eventValue:i.value};t.log("ga.send()",s),ga("send",s)}).on("etalia.control.cluster.change",function(e,i){var s={hitType:"event",eventCategory:n,eventAction:"cluster",eventLabel:i.label,eventValue:i.value};t.log("ga.send()",s),ga("send",s)}).on("etalia.control.pinned.change",function(e,i){var s={hitType:"event",eventCategory:n,eventAction:i.active?"pin":"unpin"};t.log("ga.send()",s),ga("send",s)}).on("etalia.control.filters.change",function(e,i){var s={hitType:"event",eventCategory:n,eventAction:(i.active?"select_":"deselect_")+i.group,eventLabel:i.label,eventValue:i.value};t.log("ga.send()",s),ga("send",s)}).on("etalia.control.filters.more",function(e,i){var s={hitType:"event",eventCategory:n,eventAction:"more_filter",eventLabel:i.group};t.log("ga.send()",s),ga("send",s)}),i.on("etalia.publication.pin",function(e,i){var n={hitType:"event",eventCategory:i.getExtra("source"),eventAction:i.isPinned()?"pin":"unpin",eventLabel:i.getExtra("title"),eventValue:i.getId()};t.log("ga.send()",n),ga("send",n)}).on("etalia.publication.ban",function(e,i){var n={hitType:"event",eventCategory:i.getExtra("source"),eventAction:"ban",eventLabel:i.getExtra("title"),eventValue:i.getId()};t.log("ga.send()",n),ga("send",n)}).on("etalia.publication.add",function(e,i){var n={hitType:"event",eventCategory:i.getExtra("source"),eventAction:"add",eventLabel:i.getExtra("title"),eventValue:i.getId()};t.log("ga.send()",n),ga("send",n)}).on("etalia.publication.trash",function(e,i){var n={hitType:"event",eventCategory:i.getExtra("source"),eventAction:"trash",eventLabel:i.getExtra("title"),eventValue:i.getId()};t.log("ga.send()",n),ga("send",n)}).on("etalia.publication.restore",function(e,i){var n={hitType:"event",eventCategory:i.getExtra("source"),eventAction:"restore",eventLabel:i.getExtra("title"),eventValue:i.getId()};t.log("ga.send()",n),ga("send",n)}).on("etalia.publication.trash-clear",function(){var e={hitType:"event",eventCategory:"library",eventAction:"trash-clear"};t.log("ga.send()",e),ga("send",e)}).on("etalia.publication.share",function(e,i){var n={hitType:"event",eventCategory:i.source,eventAction:"share_"+i.support,eventLabel:i.title,eventValue:i.id};t.log("ga.send()",n),ga("send",n)}),i.on("etalia.detail.similar_timespan.change",function(e,i){var n={hitType:"event",eventCategory:"detail",eventAction:"similar_timespan",eventLabel:i.title,eventValue:i.value};t.log("ga.send()",n),ga("send",n)}),this},(new t).init()}),define("app/ui/layout/invite",["jquery"],function(e){function t(t){t.preventDefault();var n=i.find(".modal-form"),s=i.find(".modal-result");return e.ajax({type:n.attr("method"),url:n.attr("action"),data:n.serialize(),success:function(e){i.find(".form-errors").empty(),n.hide().find("input, textarea").val(""),s.show()},error:function(t){console.log(t.responseText);var n=i.find(".form-errors").empty(),s=JSON.parse(t.responseText);e.each(s,function(e,t){n.prepend('<div class="alert alert-danger" role="alert"><span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>'+t+"</div>")})}}),!1}var i;e(function(){i=e("#invite-modal"),e("#open-invite").on("click",function(){e("#profile-dropdown").hide(),i.modal("show")}),i.find("form[data-async]").on("submit",t),i.find(".form-errors").empty(),i.on("hidden.bs.modal",function(){i.find(".modal-form").show(),i.find(".modal-result").hide()})})}),define("app/ui/layout/close-alerts",["jquery"],function(e){e(function(){e("a.close[close-href]").click(function(t){t.preventDefault(),e.post(e(this).attr("close-href"),"",function(){})})})}),define("app/ui/layout",["jquery","app/util/utils","app/ui/layout/flap","app/ui/layout/interact","app/ui/layout/invite","app/ui/layout/close-alerts"],function(e,t,i){var n=function(t){this.config=e.extend({debug:!1,leftFlap:"#nav-flap",leftFlapButton:"#toggle-nav",rightFlap:"#filter-flap",rightFlapButton:"#toggle-filter",backdrop:"#backdrop"},t),this.leftFlap=null,this.rightFlap=null,this.busy=!1;var i=this;this.log=function(e){i.config.debug&&console.log("[Layout] "+e)},this.resizeTimeout=null,this.resizeHandler=function(){i.log("Resize handler"),i.leftFlap&&i.leftFlap.init(),i.rightFlap&&i.rightFlap.init()}};n.prototype.init=function(){var n=this,s=e("body"),r=e(this.config.leftFlap),a=e(this.config.leftFlapButton),o=e(this.config.rightFlap),l=e(this.config.rightFlapButton),c=!1;this.log("Init"),r.length?(this.log("Left flap found"),this.leftFlap=new i({debug:this.config.debug,flap:this.config.leftFlap,side:"left",button:this.config.leftFlapButton,backdrop:this.config.backdrop,mobileMaxWidth:992}),c=!0):a.hide(),o.length?(this.log("Right flap found"),this.rightFlap=new i({debug:this.config.debug,flap:this.config.rightFlap,side:"right",button:this.config.rightFlapButton,backdrop:this.config.backdrop,mobileMaxWidth:1200}),c=!0):l.hide(),c&&(e(window).on("resize",function(){n.resizeTimeout&&clearTimeout(n.resizeTimeout),n.resizeTimeout=setTimeout(n.resizeHandler,100)}),n.resizeHandler());var u=e("#toggle-profile"),h=e("#profile-dropdown");h.length&&(u.on("click",function(i){t.toggleClass(e(i.delegateTarget),"active")?h.show():h.hide()}),h.on("click",function(e){e.stopPropagation()}),e(window).on("click",function(t){0==e(t.target).closest("#toggle-profile").length&&(e("#toggle-profile").removeClass("active"),e("#profile-dropdown").hide())}));var d=s.data("busy-check");d&&n.checkBusyUrl(d)},n.prototype.setBusy=function(t){e("#busy-content").html(t),this.busy||(this.busy=!0,e("body").addClass("busy"))},n.prototype.setAvailable=function(){this.busy&&(this.busy=!1,e("#busy-content").html(""),e("body").removeClass("busy"))},n.prototype.checkBusyUrl=function(t){var i,n=this;n.setBusy(),i=setInterval(function(){e.getJSON(t,function(e){if(e.done){if(clearInterval(i),e.hasOwnProperty("redirect"))return void(window.location.href=e.redirect);n.setAvailable()}else n.setBusy("<p><strong>"+e.messages[0]+"</strong></p><p>"+e.messages[1]+"</p>")})},1e3)};var s=new n;return s.init(),s}),define("app/ui/control/search",["jquery","app/util/utils"],function(e,t){var i=function(t){this.config=e.extend({debug:!1,element:"#search",toggle:"#toggle-search",close:"#close-search",input:"#search-input"},t),this.$element=e(this.config.element),this.$toggle=e(this.config.toggle),this.$close=this.$element.find(this.config.close),this.$input=this.$element.find(this.config.input),this.keyUpTimeout=null};return i.prototype.init=function(){var i=this,n=e("body");return this.$toggle.on("click",function(e){return console.log("test"),t.toggleClass(i.$element,"opened"),e.preventDefault(),!1}),this.$close.on("click",function(e){return t.toggleClass(i.$element,"opened"),e.preventDefault(),!1}),this.$input.on("focus",function(t){t.stopPropagation(),e(t.delegateTarget).parents("form").addClass("active")}).on("blur",function(t){t.stopPropagation(),e(t.delegateTarget).parents("form").removeClass("active")}).on("keyup",function(e){i.keyUpTimeout&&clearTimeout(i.keyUpTimeout);var t=e.keyCode||e.which;13==t?n.trigger("etalia.control.search.change",{expression:i.getValue()}):i.keyUpTimeout=setTimeout(function(){n.trigger("etalia.control.search.change",{expression:i.getValue()})},1e3)}),this},i.prototype.setValue=function(e){return this.$input.val(e),this},i.prototype.getValue=function(){return this.$input.val()},i}),define("app/ui/control/timespan",["jquery","app/util/utils"],function(e,t){var i={7:{icon:"W",label:"Week"},30:{icon:"1m",label:"1 month"},60:{icon:"2m",label:"2 months"},365:{icon:"1y",label:"1 year"}},n=function(t){this.config=e.extend({debug:!1,element:"#timespan",toggle:"#toggle-timespan",selection:"#timespan-selection"},t),this.$element=e(this.config.element),this.$toggle=e(this.config.toggle),this.$selection=e(this.config.selection)};return n.getValues=function(){return i},n.getValueIcon=function(e){if(i.hasOwnProperty(e))return i[e].icon;throw"Unexpected timespan value"},n.getValueLabel=function(e){if(i.hasOwnProperty(e))return i[e].label;throw"Unexpected timespan value"},n.prototype.init=function(){var i=this,s=e("body");return this.$toggle.on("click",function(e){return t.toggleClass(i.$element,"opened"),e.preventDefault(),!1}),e(window).on("click",function(t){0==e(t.target).closest(i.config.element).length&&i.$element.removeClass("opened")}),this.$element.on("click",".choices a",function(t){var r=e(t.target).closest("a").data("timespan");return i.setValue(r),i.$toggle.trigger("click"),s.trigger("etalia.control.timespan.change",{value:r,label:n.getValueLabel(r)}),t.preventDefault(),!1}),this},n.prototype.setValue=function(e){return this.$selection.html(n.getValueIcon(e)).data("value",e),this},n.prototype.getValue=function(){return this.$selection.data("value")},n}),define("app/ui/control/cluster",["jquery","app/util/utils"],function(e,t){var i={0:{label:"All"},1:{label:"Purple"},2:{label:"Red"},3:{label:"Orange"},4:{label:"White"}},n=function(t){this.config=e.extend({debug:!1,element:"#cluster",toggle:"#toggle-cluster",selection:"#cluster-selection"},t),this.$element=e(this.config.element),this.$toggle=e(this.config.toggle),this.$selection=e(this.config.selection),this.selected=null};return n.prototype.init=function(){var i=this,n=e("body");return this.$toggle.on("click",function(e){return t.toggleClass(i.$element,"opened"),e.preventDefault(),!1}),e(window).on("click",function(t){0==e(t.target).closest(i.config.element).length&&i.$element.removeClass("opened")}),this.$element.on("click",".choices a",function(t){var s=e(t.target).closest("a").data("cluster");return i.setValue(s),i.$toggle.trigger("click"),n.trigger("etalia.control.timespan.change",{value:s,label:i.getValueColor(s)}),t.preventDefault(),!1}),this},n.prototype.getValueColor=function(e){if(i.hasOwnProperty(e))return i[e].label;throw"Unexpected cluster value"},n.prototype.setValue=function(e){if(e=parseInt(e),this.$selection.removeClass("cluster-"+this.selected),0==e)this.$selection.hide(),this.$toggle.find(".cluster-icon").show();else{if(!(e>0&&4>=e))throw"Unexpected cluster value";this.$selection.css({display:"inline-block"}).addClass("cluster-"+(this.selected-1)),this.$toggle.find(".cluster-icon").hide()}return this.$selection.data("value",e),this.selected=e,this},n.prototype.getValue=function(){return this.$selection.data("value")},n}),define("app/ui/control/pinned",["jquery","app/util/utils"],function(e,t){var i=function(t){this.config=e.extend({debug:!1,element:"#toggle-pinned"},t),this.$element=e(this.config.element)};return i.prototype.init=function(){var i=this,n=e("body");return this.$element.on("click",function(e){var s=t.toggleClass(i.$element,"active");return n.trigger("etalia.control.pinned.change",{active:s}),e.preventDefault(),!1}),this},i.prototype.setValue=function(e){return t.toggleClass(this.$element,"active",e),this},i.prototype.getValue=function(){
return this.$element.hasClass("active")},i});var Hogan={};!function(e){function t(e,t,i){var n;return t&&"object"==typeof t&&(void 0!==t[e]?n=t[e]:i&&t.get&&"function"==typeof t.get&&(n=t.get(e))),n}function i(e,t,i,n,s,r){function a(){}function o(){}a.prototype=e,o.prototype=e.subs;var l,c=new a;c.subs=new o,c.subsText={},c.buf="",n=n||{},c.stackSubs=n,c.subsText=r;for(l in t)n[l]||(n[l]=t[l]);for(l in n)c.subs[l]=n[l];s=s||{},c.stackPartials=s;for(l in i)s[l]||(s[l]=i[l]);for(l in s)c.partials[l]=s[l];return c}function n(e){return String(null===e||void 0===e?"":e)}function s(e){return e=n(e),u.test(e)?e.replace(r,"&amp;").replace(a,"&lt;").replace(o,"&gt;").replace(l,"&#39;").replace(c,"&quot;"):e}e.Template=function(e,t,i,n){e=e||{},this.r=e.code||this.r,this.c=i,this.options=n||{},this.text=t||"",this.partials=e.partials||{},this.subs=e.subs||{},this.buf=""},e.Template.prototype={r:function(e,t,i){return""},v:s,t:n,render:function(e,t,i){return this.ri([e],t||{},i)},ri:function(e,t,i){return this.r(e,t,i)},ep:function(e,t){var n=this.partials[e],s=t[n.name];if(n.instance&&n.base==s)return n.instance;if("string"==typeof s){if(!this.c)throw new Error("No compiler available.");s=this.c.compile(s,this.options)}if(!s)return null;if(this.partials[e].base=s,n.subs){t.stackText||(t.stackText={});for(key in n.subs)t.stackText[key]||(t.stackText[key]=void 0!==this.activeSub&&t.stackText[this.activeSub]?t.stackText[this.activeSub]:this.text);s=i(s,n.subs,n.partials,this.stackSubs,this.stackPartials,t.stackText)}return this.partials[e].instance=s,s},rp:function(e,t,i,n){var s=this.ep(e,i);return s?s.ri(t,i,n):""},rs:function(e,t,i){var n=e[e.length-1];if(!h(n))return void i(e,t,this);for(var s=0;s<n.length;s++)e.push(n[s]),i(e,t,this),e.pop()},s:function(e,t,i,n,s,r,a){var o;return h(e)&&0===e.length?!1:("function"==typeof e&&(e=this.ms(e,t,i,n,s,r,a)),o=!!e,!n&&o&&t&&t.push("object"==typeof e?e:t[t.length-1]),o)},d:function(e,i,n,s){var r,a=e.split("."),o=this.f(a[0],i,n,s),l=this.options.modelGet,c=null;if("."===e&&h(i[i.length-2]))o=i[i.length-1];else for(var u=1;u<a.length;u++)r=t(a[u],o,l),void 0!==r?(c=o,o=r):o="";return s&&!o?!1:(s||"function"!=typeof o||(i.push(c),o=this.mv(o,i,n),i.pop()),o)},f:function(e,i,n,s){for(var r=!1,a=null,o=!1,l=this.options.modelGet,c=i.length-1;c>=0;c--)if(a=i[c],r=t(e,a,l),void 0!==r){o=!0;break}return o?(s||"function"!=typeof r||(r=this.mv(r,i,n)),r):s?!1:""},ls:function(e,t,i,s,r){var a=this.options.delimiters;return this.options.delimiters=r,this.b(this.ct(n(e.call(t,s)),t,i)),this.options.delimiters=a,!1},ct:function(e,t,i){if(this.options.disableLambda)throw new Error("Lambda features disabled.");return this.c.compile(e,this.options).render(t,i)},b:function(e){this.buf+=e},fl:function(){var e=this.buf;return this.buf="",e},ms:function(e,t,i,n,s,r,a){var o,l=t[t.length-1],c=e.call(l);return"function"==typeof c?n?!0:(o=this.activeSub&&this.subsText&&this.subsText[this.activeSub]?this.subsText[this.activeSub]:this.text,this.ls(c,l,i,o.substring(s,r),a)):c},mv:function(e,t,i){var s=t[t.length-1],r=e.call(s);return"function"==typeof r?this.ct(n(r.call(s)),s,i):r},sub:function(e,t,i,n){var s=this.subs[e];s&&(this.activeSub=e,s(t,i,this,n),this.activeSub=!1)}};var r=/&/g,a=/</g,o=/>/g,l=/\'/g,c=/\"/g,u=/[&<>\"\']/,h=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}}("undefined"!=typeof exports?exports:Hogan),function(e){function t(e){"}"===e.n.substr(e.n.length-1)&&(e.n=e.n.substring(0,e.n.length-1))}function i(e){return e.trim?e.trim():e.replace(/^\s*|\s*$/g,"")}function n(e,t,i){if(t.charAt(i)!=e.charAt(0))return!1;for(var n=1,s=e.length;s>n;n++)if(t.charAt(i+n)!=e.charAt(n))return!1;return!0}function s(t,i,n,o){var l=[],c=null,u=null,h=null;for(u=n[n.length-1];t.length>0;){if(h=t.shift(),u&&"<"==u.tag&&!(h.tag in k))throw new Error("Illegal content in < super tag.");if(e.tags[h.tag]<=e.tags.$||r(h,o))n.push(h),h.nodes=s(t,h.tag,n,o);else{if("/"==h.tag){if(0===n.length)throw new Error("Closing tag without opener: /"+h.n);if(c=n.pop(),h.n!=c.n&&!a(h.n,c.n,o))throw new Error("Nesting error: "+c.n+" vs. "+h.n);return c.end=h.i,l}"\n"==h.tag&&(h.last=0==t.length||"\n"==t[0].tag)}l.push(h)}if(n.length>0)throw new Error("missing closing tag: "+n.pop().n);return l}function r(e,t){for(var i=0,n=t.length;n>i;i++)if(t[i].o==e.n)return e.tag="#",!0}function a(e,t,i){for(var n=0,s=i.length;s>n;n++)if(i[n].c==e&&i[n].o==t)return!0}function o(e){var t=[];for(var i in e)t.push('"'+c(i)+'": function(c,p,t,i) {'+e[i]+"}");return"{ "+t.join(",")+" }"}function l(e){var t=[];for(var i in e.partials)t.push('"'+c(i)+'":{name:"'+c(e.partials[i].name)+'", '+l(e.partials[i])+"}");return"partials: {"+t.join(",")+"}, subs: "+o(e.subs)}function c(e){return e.replace(y,"\\\\").replace(m,'\\"').replace(g,"\\n").replace(v,"\\r").replace(b,"\\u2028").replace(_,"\\u2029")}function u(e){return~e.indexOf(".")?"d":"f"}function h(e,t){var i="<"+(t.prefix||""),n=i+e.n+w++;return t.partials[n]={name:e.n,partials:{}},t.code+='t.b(t.rp("'+c(n)+'",c,p,"'+(e.indent||"")+'"));',n}function d(e,t){t.code+="t.b(t.t(t."+u(e.n)+'("'+c(e.n)+'",c,p,0)));'}function p(e){return"t.b("+e+");"}var f=/\S/,m=/\"/g,g=/\n/g,v=/\r/g,y=/\\/g,b=/\u2028/,_=/\u2029/;e.tags={"#":1,"^":2,"<":3,$:4,"/":5,"!":6,">":7,"=":8,_v:9,"{":10,"&":11,_t:12},e.scan=function(s,r){function a(){y.length>0&&(b.push({tag:"_t",text:new String(y)}),y="")}function o(){for(var t=!0,i=w;i<b.length;i++)if(t=e.tags[b[i].tag]<e.tags._v||"_t"==b[i].tag&&null===b[i].text.match(f),!t)return!1;return t}function l(e,t){if(a(),e&&o())for(var i,n=w;n<b.length;n++)b[n].text&&((i=b[n+1])&&">"==i.tag&&(i.indent=b[n].text.toString()),b.splice(n,1));else t||b.push({tag:"\n"});_=!1,w=b.length}function c(e,t){var n="="+x,s=e.indexOf(n,t),r=i(e.substring(e.indexOf("=",t)+1,s)).split(" ");return S=r[0],x=r[r.length-1],s+n.length-1}var u=s.length,h=0,d=1,p=2,m=h,g=null,v=null,y="",b=[],_=!1,k=0,w=0,S="{{",x="}}";for(r&&(r=r.split(" "),S=r[0],x=r[1]),k=0;u>k;k++)m==h?n(S,s,k)?(--k,a(),m=d):"\n"==s.charAt(k)?l(_):y+=s.charAt(k):m==d?(k+=S.length-1,v=e.tags[s.charAt(k+1)],g=v?s.charAt(k+1):"_v","="==g?(k=c(s,k),m=h):(v&&k++,m=p),_=k):n(x,s,k)?(b.push({tag:g,n:i(y),otag:S,ctag:x,i:"/"==g?_-S.length:k+x.length}),y="",k+=x.length-1,m=h,"{"==g&&("}}"==x?k++:t(b[b.length-1]))):y+=s.charAt(k);return l(_,!0),b};var k={_t:!0,"\n":!0,$:!0,"/":!0};e.stringify=function(t,i,n){return"{code: function (c,p,i) { "+e.wrapMain(t.code)+" },"+l(t)+"}"};var w=0;e.generate=function(t,i,n){w=0;var s={code:"",subs:{},partials:{}};return e.walk(t,s),n.asString?this.stringify(s,i,n):this.makeTemplate(s,i,n)},e.wrapMain=function(e){return'var t=this;t.b(i=i||"");'+e+"return t.fl();"},e.template=e.Template,e.makeTemplate=function(e,t,i){var n=this.makePartials(e);return n.code=new Function("c","p","i",this.wrapMain(e.code)),new this.template(n,t,this,i)},e.makePartials=function(e){var t,i={subs:{},partials:e.partials,name:e.name};for(t in i.partials)i.partials[t]=this.makePartials(i.partials[t]);for(t in e.subs)i.subs[t]=new Function("c","p","t","i",e.subs[t]);return i},e.codegen={"#":function(t,i){i.code+="if(t.s(t."+u(t.n)+'("'+c(t.n)+'",c,p,1),c,p,0,'+t.i+","+t.end+',"'+t.otag+" "+t.ctag+'")){t.rs(c,p,function(c,p,t){',e.walk(t.nodes,i),i.code+="});c.pop();}"},"^":function(t,i){i.code+="if(!t.s(t."+u(t.n)+'("'+c(t.n)+'",c,p,1),c,p,1,0,0,"")){',e.walk(t.nodes,i),i.code+="};"},">":h,"<":function(t,i){var n={partials:{},code:"",subs:{},inPartial:!0};e.walk(t.nodes,n);var s=i.partials[h(t,i)];s.subs=n.subs,s.partials=n.partials},$:function(t,i){var n={subs:{},code:"",partials:i.partials,prefix:t.n};e.walk(t.nodes,n),i.subs[t.n]=n.code,i.inPartial||(i.code+='t.sub("'+c(t.n)+'",c,p,i);')},"\n":function(e,t){t.code+=p('"\\n"'+(e.last?"":" + i"))},_v:function(e,t){t.code+="t.b(t.v(t."+u(e.n)+'("'+c(e.n)+'",c,p,0)));'},_t:function(e,t){t.code+=p('"'+c(e.text)+'"')},"{":d,"&":d},e.walk=function(t,i){for(var n,s=0,r=t.length;r>s;s++)n=e.codegen[t[s].tag],n&&n(t[s],i);return i},e.parse=function(e,t,i){return i=i||{},s(e,"",[],i.sectionTags||[])},e.cache={},e.cacheKey=function(e,t){return[e,!!t.asString,!!t.disableLambda,t.delimiters,!!t.modelGet].join("||")},e.compile=function(t,i){i=i||{};var n=e.cacheKey(t,i),s=this.cache[n];if(s){var r=s.partials;for(var a in r)delete r[a].instance;return s}return s=this.generate(this.parse(this.scan(t,i.delimiters),t,i),t,i),this.cache[n]=s}}("undefined"!=typeof exports?exports:Hogan),"function"==typeof define&&define.amd&&define("hogan",Hogan),define("app/util/templates",["require","hogan"],function(e){var t=e("hogan"),i={};return i.filters=new t.Template({code:function(e,t,i){var n=this;return n.b(i=i||""),n.s(n.f("groups",e,t,1),e,t,0,11,771,"{{ }}")&&(n.rs(e,t,function(e,t,n){n.b('<div class="filter-group" data-id="'),n.b(n.v(n.f("id",e,t,0))),n.b('">'),n.b("\n"+i),n.b('    <a href="javascript: void(0)" class="filter-toggle">'),n.b("\n"+i),n.b("        "),n.b(n.v(n.f("id",e,t,0))),n.b(' <span class="eai eai-down"></span>'),n.b("\n"+i),n.b("    </a>"),n.b("\n"+i),n.b('    <div class="filter-filters collapse">'),n.b("\n"+i),n.b("        <ul>"),n.b("\n"+i),n.s(n.f("entries",e,t,1),e,t,0,251,621,"{{ }}")&&(n.rs(e,t,function(e,t,n){n.b("            <li>"),n.b("\n"+i),n.b('                <a href="javascript: void(0)" data-id="'),n.b(n.v(n.f("pk",e,t,0))),n.b('" title="'),n.b(n.v(n.f("name",e,t,0))),n.b('"'),n.b("\n"+i),n.b("                    "),n.s(n.f("is_checked",e,t,1),e,t,0,384,400,"{{ }}")&&(n.rs(e,t,function(e,t,i){i.b(' class="active" ')}),e.pop()),n.b(">"),n.b("\n"+i),n.b("                    "),n.s(n.f("count",e,t,1),e,t,0,447,492,"{{ }}")&&(n.rs(e,t,function(e,t,i){i.b('<span class="filter-count">('),i.b(i.v(i.f("count",e,t,0))),i.b(")</span>")}),e.pop()),n.b("\n"+i),n.b('                    <span class="filter-checkbox"></span> '),n.b(n.v(n.f("name",e,t,0))),n.b("\n"+i),n.b("                </a>"),n.b("\n"+i),n.b("            </li>"),n.b("\n"+i)}),e.pop()),n.b("        </ul>"),n.b("\n"+i),n.b('        <a href="javascript: void(0)" class="filter-more">'),n.b("\n"+i),n.b("            More filters&hellip;"),n.b("\n"+i),n.b("        </a>"),n.b("\n"+i),n.b("    </div>"),n.b("\n"+i),n.b("</div>"),n.b("\n"+i)}),e.pop()),n.fl()},partials:{},subs:{}}),i}),define("app/ui/control/filters",["jquery","app/util/templates","app/util/utils"],function(e,t,i){var n={id:[],opened:[],count:[]};n.has=function(e){return 0<=this.id.indexOf(e)},n.add=function(e,t,i){this.has(e)&&this.set(e,t,i),this.id.push(e),this.opened.push(t),this.count.push(i)},n.set=function(e,t,i){this.has(e)||this.add(e,t,i);var n=this.id.indexOf(e);this.opened[n]=t,this.count[n]=i},n.get=function(e){if(!this.has(e))throw'Undefined group "'+e+'"';var t=this.id.indexOf(e);return{opened:this.opened[t],count:this.count[t]}},n.setOpened=function(e,t){if(!this.has(e))throw'Undefined group "'+e+'"';var i=this.id.indexOf(e);this.opened[i]=t},n.getOpened=function(e){if(!this.has(e))throw'Undefined group "'+e+'"';return this.opened[this.id.indexOf(e)]},n.setCount=function(e,t){if(!this.has(e))throw'Undefined group "'+e+'"';var i=this.id.indexOf(e);this.count[i]=t},n.getCount=function(e){if(!this.has(e))throw'Undefined group "'+e+'"';return this.count[this.id.indexOf(e)]};var s=function(t){this.config=e.extend({debug:!1,element:"#filter-flap"},t),this.$element=e(this.config.element),this.$toggle=e(this.config.selection),this.$selection=e(this.config.selection),this.selected=null};return s.prototype.init=function(){var t=this,s=e("body");return this.$element.find(".filter-group").each(function(i,s){var r=e(s),a=r.find(".filter-filters ul a:visible").length;n.add(r.data("id"),r.hasClass("active"),a),t.applyUserSelection(r)}),this.$element.on("hidden.bs.collapse shown.bs.collapse",".filter-filters",function(){t.$element.trigger("redraw")}).on("click",".filter-toggle",function(t){var s=e(t.target).closest(".filter-group"),r=s.data("id");i.toggleClass(s,"active")?(s.find(".filter-filters").collapse("show"),n.setOpened(r,!0)):(s.find(".filter-filters").collapse("hide"),n.setOpened(r,!1))}).on("click",".filter-group ul a",function(t){var n=e(t.target).closest("a"),r=n.closest(".filter-group"),a=i.toggleClass(n,"active");s.trigger("etalia.control.filters.change",{value:n.data("id"),label:n.attr("title"),group:r.data("id"),active:a})}).on("click",".filter-more",function(i){var r=e(i.target).closest(".filter-group"),a=r.data("id"),o=n.getCount(a);n.setCount(a,o+10),t.applyUserSelection(r),s.trigger("etalia.control.filters.more",{group:r.data("id"),count:o}),t.$element.trigger("redraw")}),this},s.prototype.applyUserSelection=function(e){var t=e.find("ul li"),i=n.get(e.data("id"));return i.opened?e.addClass("active").find(".filter-filters").addClass("in"):e.removeClass("active").find(".filter-filters").removeClass("in"),i.count>=t.length?(t.show(),e.find(".filter-more").hide()):(t.filter(":lt("+i.count+")").show(),t.filter(":gt("+(i.count-1)+")").hide(),e.find(".filter-more").show()),this},s.prototype.render=function(i){var n=this;return this.$element.find(".flap-inner").html(t.filters.render({groups:i})).find(".filter-group").each(function(t,i){n.applyUserSelection(e(i))}),this.$element.trigger("redraw"),this},s.prototype.setValue=function(){throw"Not implemented"},s.prototype.getValue=function(){var t=[];return this.$element.find(".filter-group").each(function(i,n){var s=e(n),r=[];s.find("li a.active").each(function(){r.push(e(this).data("id"))}),t.push({id:s.data("id"),pk:r})}),t},s}),define("app/ui/controls",["jquery","app/ui/control/search","app/ui/control/timespan","app/ui/control/cluster","app/ui/control/pinned","app/ui/control/filters"],function(e,t,i,n,s,r){var a={search:(new t).init(),timespan:(new i).init(),cluster:(new n).init(),pinned:(new s).init(),filters:(new r).init()};return a.getStates=function(){return{time_span:this.timespan.getValue(),cluster:this.cluster.getValue(),pin:this.pinned.getValue(),search_query:this.search.getValue(),filters:this.filters.getValue()}},a.setStates=function(e){return e.hasOwnProperty("cluster")&&this.cluster.setValue(e.cluster||0),e.hasOwnProperty("time_span")&&this.timespan.setValue(e.time_span),e.hasOwnProperty("pin")&&this.pinned.setValue(e.pin),e.hasOwnProperty("search_query")&&this.search.setValue(e.search_query),e.hasOwnProperty("filters")&&this.filters.render(e.filters),this},a}),function(e,t){"function"==typeof define&&define.amd?define("backbone/relational",["exports","backbone","underscore"],t):"undefined"!=typeof exports?t(exports,require("backbone"),require("underscore")):t(e,e.Backbone,e._)}(this,function(e,t,i){"use strict";t.Relational={showWarnings:!0},t.Semaphore={_permitsAvailable:null,_permitsUsed:0,acquire:function(){if(this._permitsAvailable&&this._permitsUsed>=this._permitsAvailable)throw new Error("Max permits acquired");this._permitsUsed++},release:function(){if(0===this._permitsUsed)throw new Error("All permits released");this._permitsUsed--},isLocked:function(){return this._permitsUsed>0},setAvailablePermits:function(e){if(this._permitsUsed>e)throw new Error("Available permits cannot be less than used permits");this._permitsAvailable=e}},t.BlockingQueue=function(){this._queue=[]},i.extend(t.BlockingQueue.prototype,t.Semaphore,{_queue:null,add:function(e){this.isBlocked()?this._queue.push(e):e()},process:function(){var e=this._queue;for(this._queue=[];e&&e.length;)e.shift()()},block:function(){this.acquire()},unblock:function(){this.release(),this.isBlocked()||this.process()},isBlocked:function(){return this.isLocked()}}),t.Relational.eventQueue=new t.BlockingQueue,t.Store=function(){this._collections=[],this._reverseRelations=[],this._orphanRelations=[],this._subModels=[],this._modelScopes=[e]},i.extend(t.Store.prototype,t.Events,{initializeRelation:function(e,n,s){var r=i.isString(n.type)?t[n.type]||this.getObjectByName(n.type):n.type;if(r&&r.prototype instanceof t.Relation){new r(e,n,s)}else t.Relational.showWarnings&&"undefined"!=typeof console&&console.warn("Relation=%o; missing or invalid relation type!",n)},addModelScope:function(e){this._modelScopes.push(e)},removeModelScope:function(e){this._modelScopes=i.without(this._modelScopes,e)},addSubModels:function(e,t){this._subModels.push({superModelType:t,subModels:e})},setupSuperModel:function(e){i.find(this._subModels,function(t){return i.filter(t.subModels||[],function(i,n){var s=this.getObjectByName(i);return e===s?(t.superModelType._subModels[n]=e,e._superModel=t.superModelType,e._subModelTypeValue=n,e._subModelTypeAttribute=t.superModelType.prototype.subModelTypeAttribute,!0):void 0},this).length},this)},addReverseRelation:function(e){var t=i.any(this._reverseRelations,function(t){return i.all(e||[],function(e,i){return e===t[i]})});!t&&e.model&&e.type&&(this._reverseRelations.push(e),this._addRelation(e.model,e),this.retroFitRelation(e))},addOrphanRelation:function(e){var t=i.any(this._orphanRelations,function(t){return i.all(e||[],function(e,i){return e===t[i]})});!t&&e.model&&e.type&&this._orphanRelations.push(e)},processOrphanRelations:function(){i.each(this._orphanRelations.slice(0),function(e){var n=t.Relational.store.getObjectByName(e.relatedModel);n&&(this.initializeRelation(null,e),this._orphanRelations=i.without(this._orphanRelations,e))},this)},_addRelation:function(e,t){e.prototype.relations||(e.prototype.relations=[]),e.prototype.relations.push(t),i.each(e._subModels||[],function(e){this._addRelation(e,t)},this)},retroFitRelation:function(e){var t=this.getCollection(e.model,!1);t&&t.each(function(t){if(t instanceof e.model){new e.type(t,e)}},this)},getCollection:function(e,n){e instanceof t.RelationalModel&&(e=e.constructor);for(var s=e;s._superModel;)s=s._superModel;var r=i.find(this._collections,function(e){return e.model===s});return r||n===!1||(r=this._createCollection(s)),r},getObjectByName:function(e){var t=e.split("."),n=null;return i.find(this._modelScopes,function(e){return n=i.reduce(t||[],function(e,t){return e?e[t]:void 0},e),n&&n!==e?!0:void 0},this),n},_createCollection:function(e){var i;return e instanceof t.RelationalModel&&(e=e.constructor),e.prototype instanceof t.RelationalModel&&(i=new t.Collection,i.model=e,this._collections.push(i)),i},resolveIdForItem:function(e,n){var s=i.isString(n)||i.isNumber(n)?n:null;return null===s&&(n instanceof t.RelationalModel?s=n.id:i.isObject(n)&&(s=n[e.prototype.idAttribute])),s||0===s||(s=null),s},find:function(e,t){var i=this.resolveIdForItem(e,t),n=this.getCollection(e);if(n){var s=n.get(i);if(s instanceof e)return s}return null},register:function(e){var t=this.getCollection(e);if(t){var i=e.collection;t.add(e),e.collection=i}},checkId:function(e,i){var n=this.getCollection(e),s=n&&n.get(i);if(s&&e!==s)throw t.Relational.showWarnings&&"undefined"!=typeof console&&console.warn("Duplicate id! Old RelationalModel=%o, new RelationalModel=%o",s,e),new Error("Cannot instantiate more than one Backbone.RelationalModel with the same id per type!")},update:function(e){var t=this.getCollection(e);t.contains(e)||this.register(e),t._onModelEvent("change:"+e.idAttribute,e,t),e.trigger("relational:change:id",e,t)},unregister:function(e){var n,s;e instanceof t.Model?(n=this.getCollection(e),s=[e]):e instanceof t.Collection?(n=this.getCollection(e.model),s=i.clone(e.models)):(n=this.getCollection(e),s=i.clone(n.models)),i.each(s,function(e){this.stopListening(e),i.invoke(e.getRelations(),"stopListening")},this),i.contains(this._collections,e)?n.reset([]):i.each(s,function(e){n.get(e)?n.remove(e):n.trigger("relational:remove",e,n)},this)},reset:function(){this.stopListening(),i.each(this._collections,function(e){this.unregister(e)},this),this._collections=[],this._subModels=[],this._modelScopes=[e]}}),t.Relational.store=new t.Store,t.Relation=function(e,n,s){if(this.instance=e,n=i.isObject(n)?n:{},this.reverseRelation=i.defaults(n.reverseRelation||{},this.options.reverseRelation),this.options=i.defaults(n,this.options,t.Relation.prototype.options),this.reverseRelation.type=i.isString(this.reverseRelation.type)?t[this.reverseRelation.type]||t.Relational.store.getObjectByName(this.reverseRelation.type):this.reverseRelation.type,this.key=this.options.key,this.keySource=this.options.keySource||this.key,this.keyDestination=this.options.keyDestination||this.keySource||this.key,this.model=this.options.model||this.instance.constructor,this.relatedModel=this.options.relatedModel,i.isUndefined(this.relatedModel)&&(this.relatedModel=this.model),!i.isFunction(this.relatedModel)||this.relatedModel.prototype instanceof t.RelationalModel||(this.relatedModel=i.result(this,"relatedModel")),i.isString(this.relatedModel)&&(this.relatedModel=t.Relational.store.getObjectByName(this.relatedModel)),this.checkPreconditions()&&(!this.options.isAutoRelation&&this.reverseRelation.type&&this.reverseRelation.key&&t.Relational.store.addReverseRelation(i.defaults({isAutoRelation:!0,model:this.relatedModel,relatedModel:this.model,reverseRelation:this.options},this.reverseRelation)),e)){var r=this.keySource;r!==this.key&&i.isObject(this.instance.get(this.key))&&(r=this.key),this.setKeyContents(this.instance.get(r)),this.relatedCollection=t.Relational.store.getCollection(this.relatedModel),this.keySource!==this.key&&delete this.instance.attributes[this.keySource],this.instance._relations[this.key]=this,this.initialize(s),this.options.autoFetch&&this.instance.getAsync(this.key,i.isObject(this.options.autoFetch)?this.options.autoFetch:{}),this.listenTo(this.instance,"destroy",this.destroy).listenTo(this.relatedCollection,"relational:add relational:change:id",this.tryAddRelated).listenTo(this.relatedCollection,"relational:remove",this.removeRelated)}},t.Relation.extend=t.Model.extend,i.extend(t.Relation.prototype,t.Events,t.Semaphore,{options:{createModels:!0,includeInJSON:!0,isAutoRelation:!1,autoFetch:!1,parse:!1},instance:null,key:null,keyContents:null,relatedModel:null,relatedCollection:null,reverseRelation:null,related:null,checkPreconditions:function(){var e=this.instance,n=this.key,s=this.model,r=this.relatedModel,a=t.Relational.showWarnings&&"undefined"!=typeof console;if(!s||!n||!r)return a&&console.warn("Relation=%o: missing model, key or relatedModel (%o, %o, %o).",this,s,n,r),!1;if(!(s.prototype instanceof t.RelationalModel))return a&&console.warn("Relation=%o: model does not inherit from Backbone.RelationalModel (%o).",this,e),!1;if(!(r.prototype instanceof t.RelationalModel))return a&&console.warn("Relation=%o: relatedModel does not inherit from Backbone.RelationalModel (%o).",this,r),!1;if(this instanceof t.HasMany&&this.reverseRelation.type===t.HasMany)return a&&console.warn("Relation=%o: relation is a HasMany, and the reverseRelation is HasMany as well.",this),!1;if(e&&i.keys(e._relations).length){var o=i.find(e._relations,function(e){return e.key===n},this);if(o)return a&&console.warn("Cannot create relation=%o on %o for model=%o: already taken by relation=%o.",this,n,e,o),!1}return!0},setRelated:function(e){this.related=e,this.instance.attributes[this.key]=e},_isReverseRelation:function(e){return e.instance instanceof this.relatedModel&&this.reverseRelation.key===e.key&&this.key===e.reverseRelation.key},getReverseRelations:function(e){for(var t=[],n=i.isUndefined(e)?this.related&&(this.related.models||[this.related]):[e],s=null,r=null,a=0;a<(n||[]).length;a++){s=n[a].getRelations()||[];for(var o=0;o<s.length;o++)r=s[o],this._isReverseRelation(r)&&t.push(r)}return t},destroy:function(){this.stopListening(),this instanceof t.HasOne?this.setRelated(null):this instanceof t.HasMany&&this.setRelated(this._prepareCollection()),i.each(this.getReverseRelations(),function(e){e.removeRelated(this.instance)},this)}}),t.HasOne=t.Relation.extend({options:{reverseRelation:{type:"HasMany"}},initialize:function(e){this.listenTo(this.instance,"relational:change:"+this.key,this.onChange);var t=this.findRelated(e);this.setRelated(t),i.each(this.getReverseRelations(),function(t){t.addRelated(this.instance,e)},this)},findRelated:function(e){var t=null;if(e=i.defaults({parse:this.options.parse},e),this.keyContents instanceof this.relatedModel)t=this.keyContents;else if(this.keyContents||0===this.keyContents){var n=i.defaults({create:this.options.createModels},e);t=this.relatedModel.findOrCreate(this.keyContents,n)}return t&&(this.keyId=null),t},setKeyContents:function(e){this.keyContents=e,this.keyId=t.Relational.store.resolveIdForItem(this.relatedModel,this.keyContents)},onChange:function(e,n,s){if(!this.isLocked()){this.acquire(),s=s?i.clone(s):{};var r=i.isUndefined(s.__related),a=r?this.related:s.__related;if(r){this.setKeyContents(n);var o=this.findRelated(s);this.setRelated(o)}if(a&&this.related!==a&&i.each(this.getReverseRelations(a),function(e){e.removeRelated(this.instance,null,s)},this),i.each(this.getReverseRelations(),function(e){e.addRelated(this.instance,s)},this),!s.silent&&this.related!==a){var l=this;this.changed=!0,t.Relational.eventQueue.add(function(){l.instance.trigger("change:"+l.key,l.instance,l.related,s,!0),l.changed=!1})}this.release()}},tryAddRelated:function(e,t,i){!this.keyId&&0!==this.keyId||e.id!==this.keyId||(this.addRelated(e,i),this.keyId=null)},addRelated:function(e,t){var n=this;e.queue(function(){if(e!==n.related){var s=n.related||null;n.setRelated(e),n.onChange(n.instance,e,i.defaults({__related:s},t))}})},removeRelated:function(e,t,n){if(this.related&&e===this.related){var s=this.related||null;this.setRelated(null),this.onChange(this.instance,e,i.defaults({__related:s},n))}}}),t.HasMany=t.Relation.extend({collectionType:null,options:{reverseRelation:{type:"HasOne"},collectionType:t.Collection,collectionKey:!0,collectionOptions:{}},initialize:function(e){if(this.listenTo(this.instance,"relational:change:"+this.key,this.onChange),this.collectionType=this.options.collectionType,!i.isFunction(this.collectionType)||this.collectionType===t.Collection||this.collectionType.prototype instanceof t.Collection||(this.collectionType=i.result(this,"collectionType")),i.isString(this.collectionType)&&(this.collectionType=t.Relational.store.getObjectByName(this.collectionType)),this.collectionType!==t.Collection&&!(this.collectionType.prototype instanceof t.Collection))throw new Error("`collectionType` must inherit from Backbone.Collection");var n=this.findRelated(e);this.setRelated(n)},_prepareCollection:function(e){if(this.related&&this.stopListening(this.related),!(e&&e instanceof t.Collection)){var n=i.isFunction(this.options.collectionOptions)?this.options.collectionOptions(this.instance):this.options.collectionOptions;e=new this.collectionType(null,n)}if(e.model=this.relatedModel,this.options.collectionKey){var s=this.options.collectionKey===!0?this.options.reverseRelation.key:this.options.collectionKey;e[s]&&e[s]!==this.instance?t.Relational.showWarnings&&"undefined"!=typeof console&&console.warn("Relation=%o; collectionKey=%s already exists on collection=%o",this,s,this.options.collectionKey):s&&(e[s]=this.instance)}return this.listenTo(e,"relational:add",this.handleAddition).listenTo(e,"relational:remove",this.handleRemoval).listenTo(e,"relational:reset",this.handleReset),e},findRelated:function(e){var n=null;if(e=i.defaults({parse:this.options.parse},e),this.keyContents instanceof t.Collection)this._prepareCollection(this.keyContents),n=this.keyContents;else{var s=[];i.each(this.keyContents,function(t){var n=null;n=t instanceof this.relatedModel?t:i.isObject(t)&&e.parse&&this.relatedModel.prototype.parse?this.relatedModel.prototype.parse(i.clone(t),e):t,n&&s.push(n)},this),n=this.related instanceof t.Collection?this.related:this._prepareCollection(),n.set(s,i.defaults({parse:!1},e))}return this.keyIds=i.difference(this.keyIds,i.pluck(n.models,"id")),n},setKeyContents:function(e){this.keyContents=e instanceof t.Collection?e:null,this.keyIds=[],this.keyContents||!e&&0!==e||(this.keyContents=i.isArray(e)?e:[e],i.each(this.keyContents,function(e){var i=t.Relational.store.resolveIdForItem(this.relatedModel,e);(i||0===i)&&this.keyIds.push(i)},this))},onChange:function(e,n,s){s=s?i.clone(s):{},this.setKeyContents(n),this.changed=!1;var r=this.findRelated(s);if(this.setRelated(r),!s.silent){var a=this;t.Relational.eventQueue.add(function(){a.changed&&(a.instance.trigger("change:"+a.key,a.instance,a.related,s,!0),a.changed=!1)})}},handleAddition:function(e,n,s){s=s?i.clone(s):{},this.changed=!0,i.each(this.getReverseRelations(e),function(e){e.addRelated(this.instance,s)},this);var r=this;!s.silent&&t.Relational.eventQueue.add(function(){r.instance.trigger("add:"+r.key,e,r.related,s)})},handleRemoval:function(e,n,s){s=s?i.clone(s):{},this.changed=!0,i.each(this.getReverseRelations(e),function(e){e.removeRelated(this.instance,null,s)},this);var r=this;!s.silent&&t.Relational.eventQueue.add(function(){r.instance.trigger("remove:"+r.key,e,r.related,s)})},handleReset:function(e,n){var s=this;n=n?i.clone(n):{},!n.silent&&t.Relational.eventQueue.add(function(){s.instance.trigger("reset:"+s.key,s.related,n)})},tryAddRelated:function(e,t,n){var s=i.contains(this.keyIds,e.id);s&&(this.addRelated(e,n),this.keyIds=i.without(this.keyIds,e.id))},addRelated:function(e,t){var n=this;e.queue(function(){n.related&&!n.related.get(e)&&n.related.add(e,i.defaults({parse:!1},t))})},removeRelated:function(e,t,i){this.related.get(e)&&this.related.remove(e,i)}}),t.RelationalModel=t.Model.extend({relations:null,_relations:null,_isInitialized:!1,_deferProcessing:!1,_queue:null,_attributeChangeFired:!1,subModelTypeAttribute:"type",subModelTypes:null,constructor:function(e,n){if(n&&n.collection){var s=this,r=this.collection=n.collection;delete n.collection,this._deferProcessing=!0;var a=function(e){e===s&&(s._deferProcessing=!1,s.processQueue(),r.off("relational:add",a))};r.on("relational:add",a),i.defer(function(){a(s)})}t.Relational.store.processOrphanRelations(),t.Relational.store.listenTo(this,"relational:unregister",t.Relational.store.unregister),this._queue=new t.BlockingQueue,this._queue.block(),t.Relational.eventQueue.block();try{t.Model.apply(this,arguments)}finally{t.Relational.eventQueue.unblock()}},trigger:function(e){if(e.length>5&&0===e.indexOf("change")){var i=this,n=arguments;t.Relational.eventQueue.isBlocked()?t.Relational.eventQueue.add(function(){var s=!0;if("change"===e)s=i.hasChanged()||i._attributeChangeFired,i._attributeChangeFired=!1;else{var r=e.slice(7),a=i.getRelation(r);a?(s=n[4]===!0,s?i.changed[r]=n[2]:a.changed||delete i.changed[r]):s&&(i._attributeChangeFired=!0)}s&&t.Model.prototype.trigger.apply(i,n)}):t.Model.prototype.trigger.apply(i,n)}else"destroy"===e?(t.Model.prototype.trigger.apply(this,arguments),t.Relational.store.unregister(this)):t.Model.prototype.trigger.apply(this,arguments);return this},initializeRelations:function(e){this.acquire(),this._relations={},i.each(this.relations||[],function(i){t.Relational.store.initializeRelation(this,i,e)},this),this._isInitialized=!0,this.release(),this.processQueue()},updateRelations:function(e,t){this._isInitialized&&!this.isLocked()&&i.each(this._relations,function(i){if(!e||i.keySource in e||i.key in e){var n=this.attributes[i.keySource]||this.attributes[i.key],s=e&&(e[i.keySource]||e[i.key]);(i.related!==n||null===n&&null===s)&&this.trigger("relational:change:"+i.key,this,n,t||{})}i.keySource!==i.key&&delete this.attributes[i.keySource]},this)},queue:function(e){this._queue.add(e)},processQueue:function(){this._isInitialized&&!this._deferProcessing&&this._queue.isBlocked()&&this._queue.unblock()},getRelation:function(e){return this._relations[e]},getRelations:function(){return i.values(this._relations)},getIdsToFetch:function(e,n){var s=e instanceof t.Relation?e:this.getRelation(e),r=s?s.keyIds&&s.keyIds.slice(0)||(s.keyId||0===s.keyId?[s.keyId]:[]):[];if(n){var a=s.related&&(s.related.models||[s.related]);i.each(a,function(e){(e.id||0===e.id)&&r.push(e.id)})}return r},getAsync:function(e,n){n=i.extend({add:!0,remove:!1,refresh:!1},n);var s=this,r=[],a=this.getRelation(e),o=a&&this.getIdsToFetch(a,n.refresh),l=a.related instanceof t.Collection?a.related:a.relatedCollection;
if(o&&o.length){var c,u=[],h=[],d=function(){u=i.map(o,function(e){var t=a.relatedModel.findModel(e);if(!t){var i={};i[a.relatedModel.prototype.idAttribute]=e,t=a.relatedModel.findOrCreate(i,n),h.push(t)}return t},this)};if(l instanceof t.Collection&&i.isFunction(l.url)){var p=l.url();c=l.url(o),c===p&&(d(),c=l.url(u),c===p&&(c=null))}if(c){var f=i.defaults({error:function(){i.each(h,function(e){e.trigger("destroy",e,e.collection,n)}),n.error&&n.error.apply(u,arguments)},url:c},n);r=[l.fetch(f)]}else u.length||d(),r=i.map(u,function(e){var t=i.defaults({error:function(){i.contains(h,e)&&e.trigger("destroy",e,e.collection,n),n.error&&n.error.apply(u,arguments)}},n);return e.fetch(t)},this)}return this.deferArray(r).then(function(){return t.Model.prototype.get.call(s,e)})},deferArray:function(e){return t.$.when.apply(null,e)},set:function(e,n,s){t.Relational.eventQueue.block();var r,a;i.isObject(e)||null==e?(r=e,s=n):(r={},r[e]=n);try{var o=this.id,l=r&&this.idAttribute in r&&r[this.idAttribute];t.Relational.store.checkId(this,l),a=t.Model.prototype.set.apply(this,arguments),this._isInitialized||this.isLocked()?l&&l!==o&&t.Relational.store.update(this):(this.constructor.initializeModelHierarchy(),(l||0===l)&&t.Relational.store.register(this),this.initializeRelations(s)),r&&this.updateRelations(r,s)}finally{t.Relational.eventQueue.unblock()}return a},clone:function(){var e=i.clone(this.attributes);return i.isUndefined(e[this.idAttribute])||(e[this.idAttribute]=null),i.each(this.getRelations(),function(t){delete e[t.key]}),new this.constructor(e)},toJSON:function(e){if(this.isLocked())return this.id;this.acquire();var n=t.Model.prototype.toJSON.call(this,e);return!this.constructor._superModel||this.constructor._subModelTypeAttribute in n||(n[this.constructor._subModelTypeAttribute]=this.constructor._subModelTypeValue),i.each(this._relations,function(s){var r=n[s.key],a=s.options.includeInJSON,o=null;a===!0?r&&i.isFunction(r.toJSON)&&(o=r.toJSON(e)):i.isString(a)?(r instanceof t.Collection?o=r.pluck(a):r instanceof t.Model&&(o=r.get(a)),a===s.relatedModel.prototype.idAttribute&&(s instanceof t.HasMany?o=o.concat(s.keyIds):s instanceof t.HasOne&&(o=o||s.keyId,o||i.isObject(s.keyContents)||(o=s.keyContents||null)))):i.isArray(a)?r instanceof t.Collection?(o=[],r.each(function(e){var t={};i.each(a,function(i){t[i]=e.get(i)}),o.push(t)})):r instanceof t.Model&&(o={},i.each(a,function(e){o[e]=r.get(e)})):delete n[s.key],null===o&&e&&e.wait&&(o=r),a&&(n[s.keyDestination]=o),s.keyDestination!==s.key&&delete n[s.key]}),this.release(),n}},{setup:function(e){return this.prototype.relations=(this.prototype.relations||[]).slice(0),this._subModels={},this._superModel=null,this.prototype.hasOwnProperty("subModelTypes")?t.Relational.store.addSubModels(this.prototype.subModelTypes,this):this.prototype.subModelTypes=null,i.each(this.prototype.relations||[],function(e){if(e.model||(e.model=this),e.reverseRelation&&e.model===this){var n=!0;if(i.isString(e.relatedModel)){var s=t.Relational.store.getObjectByName(e.relatedModel);n=s&&s.prototype instanceof t.RelationalModel}n?t.Relational.store.initializeRelation(null,e):i.isString(e.relatedModel)&&t.Relational.store.addOrphanRelation(e)}},this),this},build:function(e,t){this.initializeModelHierarchy();var i=this._findSubModelType(this,e)||this;return new i(e,t)},_findSubModelType:function(e,t){if(e._subModels&&e.prototype.subModelTypeAttribute in t){var i=t[e.prototype.subModelTypeAttribute],n=e._subModels[i];if(n)return n;for(i in e._subModels)if(n=this._findSubModelType(e._subModels[i],t))return n}return null},initializeModelHierarchy:function(){if(this.inheritRelations(),this.prototype.subModelTypes){var e=i.keys(this._subModels),n=i.omit(this.prototype.subModelTypes,e);i.each(n,function(e){var i=t.Relational.store.getObjectByName(e);i&&i.initializeModelHierarchy()})}},inheritRelations:function(){if(i.isUndefined(this._superModel)||i.isNull(this._superModel))if(t.Relational.store.setupSuperModel(this),this._superModel){if(this._superModel.inheritRelations(),this._superModel.prototype.relations){var e=i.filter(this._superModel.prototype.relations||[],function(e){return!i.any(this.prototype.relations||[],function(t){return e.relatedModel===t.relatedModel&&e.key===t.key},this)},this);this.prototype.relations=e.concat(this.prototype.relations)}}else this._superModel=!1},findOrCreate:function(e,t){t||(t={});var n=i.isObject(e)&&t.parse&&this.prototype.parse?this.prototype.parse(i.clone(e),t):e,s=this.findModel(n);return i.isObject(e)&&(s&&t.merge!==!1?(delete t.collection,delete t.url,s.set(n,t)):s||t.create===!1||(s=this.build(n,i.defaults({parse:!1},t)))),s},find:function(e,t){return t||(t={}),t.create=!1,this.findOrCreate(e,t)},findModel:function(e){return t.Relational.store.find(this,e)}}),i.extend(t.RelationalModel.prototype,t.Semaphore),t.Collection.prototype.__prepareModel=t.Collection.prototype._prepareModel,t.Collection.prototype._prepareModel=function(e,n){var s;return e instanceof t.Model?(e.collection||(e.collection=this),s=e):(n=n?i.clone(n):{},n.collection=this,s="undefined"!=typeof this.model.findOrCreate?this.model.findOrCreate(e,n):new this.model(e,n),s&&s.validationError&&(this.trigger("invalid",this,e,n),s=!1)),s};var n=t.Collection.prototype.__set=t.Collection.prototype.set;t.Collection.prototype.set=function(e,s){if(!(this.model.prototype instanceof t.RelationalModel))return n.call(this,e,s);s&&s.parse&&(e=this.parse(e,s));var r=!i.isArray(e),a=[],o=[],l=null;e=r?e?[e]:[]:i.clone(e);for(var c=0;c<e.length;c++)l=e[c],l instanceof t.Model||(l=t.Collection.prototype._prepareModel.call(this,l,s)),l&&(o.push(l),this.get(l)||this.get(l.cid)?null!==l.id&&void 0!==l.id&&(this._byId[l.id]=l):a.push(l));o=r?o.length?o[0]:null:o;var u=n.call(this,o,i.defaults({merge:!1,parse:!1},s));for(c=0;c<a.length;c++)l=a[c],(this.get(l)||this.get(l.cid))&&this.trigger("relational:add",l,this,s);return u};var s=t.Collection.prototype.___removeModels=t.Collection.prototype._removeModels;t.Collection.prototype._removeModels=function(e,n){if(!(this.model.prototype instanceof t.RelationalModel))return s.call(this,e,n);var r=[];i.each(e,function(e){e=this.get(e)||e&&this.get(e.cid),e&&r.push(e)},this);var a=s.call(this,r,n);return i.each(r,function(e){this.trigger("relational:remove",e,this,n)},this),a};var r=t.Collection.prototype.__reset=t.Collection.prototype.reset;t.Collection.prototype.reset=function(e,n){n=i.extend({merge:!0},n);var s=r.call(this,e,n);return this.model.prototype instanceof t.RelationalModel&&this.trigger("relational:reset",this,n),s};var a=t.Collection.prototype.__sort=t.Collection.prototype.sort;t.Collection.prototype.sort=function(e){var i=a.call(this,e);return this.model.prototype instanceof t.RelationalModel&&this.trigger("relational:reset",this,e),i};var o=t.Collection.prototype.__trigger=t.Collection.prototype.trigger;t.Collection.prototype.trigger=function(e){if(!(this.model.prototype instanceof t.RelationalModel))return o.apply(this,arguments);if("add"===e||"remove"===e||"reset"===e||"sort"===e){var n=this,s=arguments;i.isObject(s[3])&&(s=i.toArray(s),s[3]=i.clone(s[3])),t.Relational.eventQueue.add(function(){o.apply(n,s)})}else o.apply(this,arguments);return this},t.RelationalModel.extend=function(e,i){var n=t.Model.extend.call(this,e,i);return n.setup(this),n}}),function(e){if("object"==typeof exports&&"function"==typeof require)module.exports=e(require("underscore"),require("backbone"));else if("function"==typeof define&&define.amd)define("backbone/paginator",["underscore","backbone"],e);else if("undefined"!=typeof _&&"undefined"!=typeof Backbone){var t=Backbone.PageableCollection,i=e(_,Backbone);Backbone.PageableCollection.noConflict=function(){return Backbone.PageableCollection=t,i}}}(function(e,t){"use strict";function i(t,i){if(!e.isNumber(t)||e.isNaN(t)||!e.isFinite(t)||~~t!==t)throw new TypeError("`"+i+"` must be a finite integer");return t}function n(e){for(var t,i,n,s,r={},a=decodeURIComponent,o=e.split("&"),l=0,c=o.length;c>l;l++){var u=o[l];t=u.split("="),i=t[0],n=t[1],null==n&&(n=!0),i=a(i),n=a(n),s=r[i],f(s)?s.push(n):s?r[i]=[s,n]:r[i]=n}return r}function s(e,t,i){var n=e._events[t];if(n&&n.length){var s=n[n.length-1],r=s.callback;s.callback=function(){try{r.apply(this,arguments),i()}catch(e){throw e}finally{s.callback=r}}}else i()}var r=e.extend,a=e.omit,o=e.clone,l=e.each,c=e.pick,u=e.contains,h=e.isEmpty,d=e.pairs,p=e.invert,f=e.isArray,m=e.isFunction,g=e.isObject,v=e.keys,y=e.isUndefined,b=Math.ceil,_=Math.floor,k=Math.max,w=t.Collection.prototype,S=/[\s'"]/g,x=/[<>\s'"]/g,M=t.PageableCollection=t.Collection.extend({state:{firstPage:1,lastPage:null,currentPage:null,pageSize:25,totalPages:null,totalRecords:null,sortKey:null,order:-1},mode:"server",queryParams:{currentPage:"page",pageSize:"per_page",totalPages:"total_pages",totalRecords:"total_entries",sortKey:"sort_by",order:"order",directions:{"-1":"asc",1:"desc"}},constructor:function(e,t){w.constructor.apply(this,arguments),t=t||{};var i=this.mode=t.mode||this.mode||C.mode,n=r({},C.queryParams,this.queryParams,t.queryParams||{});n.directions=r({},C.queryParams.directions,this.queryParams.directions,n.directions),this.queryParams=n;var s=this.state=r({},C.state,this.state,t.state);s.currentPage=null==s.currentPage?s.firstPage:s.currentPage,f(e)||(e=e?[e]:[]),e=e.slice(),"server"==i||null!=s.totalRecords||h(e)||(s.totalRecords=e.length),this.switchMode(i,r({fetch:!1,resetState:!1,models:e},t));var a=t.comparator;if(s.sortKey&&!a&&this.setSorting(s.sortKey,s.order,t),"server"!=i){var l=this.fullCollection;a&&t.full&&(this.comparator=null,l.comparator=a),t.full&&l.sort(),h(e)||(this.reset(e,r({silent:!0},t)),this.getPage(s.currentPage),e.splice.apply(e,[0,e.length].concat(this.models)))}this._initState=o(this.state)},_makeFullCollection:function(e,i){var n,s,r,a=["url","model","sync","comparator"],o=this.constructor.prototype,l={};for(n=0,s=a.length;s>n;n++)r=a[n],y(o[r])||(l[r]=o[r]);var c=new(t.Collection.extend(l))(e,i);for(n=0,s=a.length;s>n;n++)r=a[n],this[r]!==o[r]&&(c[r]=this[r]);return c},_makeCollectionEventHandler:function(e,t){return function(i,n,a,c){var u=e._handlers;l(v(u),function(i){var n=u[i];e.off(i,n),t.off(i,n)});var h=o(e.state),d=h.firstPage,p=0===d?h.currentPage:h.currentPage-1,f=h.pageSize,m=p*f,g=m+f;if("add"==i){var _,k,w,S,c=c||{};if(a==t)k=t.indexOf(n),k>=m&&g>k&&(S=e,_=w=k-m);else{_=e.indexOf(n),k=m+_,S=t;var w=y(c.at)?k:c.at+m}if(c.onRemove||(++h.totalRecords,delete c.onRemove),e.state=e._checkState(h),S){S.add(n,r({},c,{at:w}));var x=_>=f?n:!y(c.at)&&g>w&&e.length>f?e.at(f):null;x&&s(a,i,function(){e.remove(x,{onAdd:!0})})}c.silent||e.trigger("pageable:state:change",e.state)}if("remove"==i){if(c.onAdd)delete c.onAdd;else{if(--h.totalRecords){var M=h.totalPages=b(h.totalRecords/f);h.lastPage=0===d?M-1:M||d,h.currentPage>M&&(h.currentPage=h.lastPage)}else h.totalRecords=null,h.totalPages=null;e.state=e._checkState(h);var C,P=c.index;a==e?((C=t.at(g))?s(e,i,function(){e.push(C,{onRemove:!0})}):!e.length&&h.totalRecords&&e.reset(t.models.slice(m-f,g-f),r({},c,{parse:!1})),t.remove(n)):P>=m&&g>P&&((C=t.at(g-1))&&s(e,i,function(){e.push(C,{onRemove:!0})}),e.remove(n),!e.length&&h.totalRecords&&e.reset(t.models.slice(m-f,g-f),r({},c,{parse:!1})))}c.silent||e.trigger("pageable:state:change",e.state)}if("reset"==i){if(c=a,a=n,a==e&&null==c.from&&null==c.to){var T=t.models.slice(0,m),R=t.models.slice(m+e.models.length);t.reset(T.concat(e.models).concat(R),c)}else a==t&&((h.totalRecords=t.models.length)||(h.totalRecords=null,h.totalPages=null),"client"==e.mode&&(d=h.lastPage=h.currentPage=h.firstPage,p=0===d?h.currentPage:h.currentPage-1,m=p*f,g=m+f),e.state=e._checkState(h),e.reset(t.models.slice(m,g),r({},c,{parse:!1})));c.silent||e.trigger("pageable:state:change",e.state)}"sort"==i&&(c=a,a=n,a===t&&e.reset(t.models.slice(m,g),r({},c,{parse:!1}))),l(v(u),function(i){var n=u[i];l([e,t],function(e){e.on(i,n);var t=e._events[i]||[];t.unshift(t.pop())})})}},_checkState:function(e){var t=this.mode,n=this.links,s=e.totalRecords,r=e.pageSize,a=e.currentPage,o=e.firstPage,l=e.totalPages;if(null!=s&&null!=r&&null!=a&&null!=o&&("infinite"==t?n:!0)){if(s=i(s,"totalRecords"),r=i(r,"pageSize"),a=i(a,"currentPage"),o=i(o,"firstPage"),1>r)throw new RangeError("`pageSize` must be >= 1");if(l=e.totalPages=b(s/r),0>o||o>1)throw new RangeError("`firstPage must be 0 or 1`");if(e.lastPage=0===o?k(0,l-1):l||o,"infinite"==t){if(!n[a+""])throw new RangeError("No link found for page "+a)}else if(o>a||l>0&&(o?a>l:a>=l))throw new RangeError("`currentPage` must be firstPage <= currentPage "+(o?"<":"<=")+" totalPages if "+o+"-based. Got "+a+".")}return e},setPageSize:function(e,t){e=i(e,"pageSize"),t=t||{first:!1};var n=this.state,s=b(n.totalRecords/e),o=s?k(n.firstPage,_(s*n.currentPage/n.totalPages)):n.firstPage;return n=this.state=this._checkState(r({},n,{pageSize:e,currentPage:t.first?n.firstPage:o,totalPages:s})),this.getPage(n.currentPage,a(t,["first"]))},switchMode:function(t,i){if(!u(["server","client","infinite"],t))throw new TypeError('`mode` must be one of "server", "client" or "infinite"');i=i||{fetch:!0,resetState:!0};var n=this.state=i.resetState?o(this._initState):this._checkState(r({},this.state));this.mode=t;var s,c=this,h=this.fullCollection,d=this._handlers=this._handlers||{};if("server"==t||h)"server"==t&&h&&(l(v(d),function(e){s=d[e],c.off(e,s),h.off(e,s)}),delete this._handlers,this._fullComparator=h.comparator,delete this.fullCollection);else{h=this._makeFullCollection(i.models||[],i),h.pageableCollection=this,this.fullCollection=h;var p=this._makeCollectionEventHandler(this,h);l(["add","remove","reset","sort"],function(t){d[t]=s=e.bind(p,{},t),c.on(t,s),h.on(t,s)}),h.comparator=this._fullComparator}if("infinite"==t)for(var f=this.links={},m=n.firstPage,g=b(n.totalRecords/n.pageSize),y=0===m?k(0,g-1):g||m,_=n.firstPage;y>=_;_++)f[_]=this.url;else this.links&&delete this.links;return i.silent||this.trigger("pageable:state:change",n),i.fetch?this.fetch(a(i,"fetch","resetState")):this},hasPreviousPage:function(){var e=this.state,t=e.currentPage;return"infinite"!=this.mode?t>e.firstPage:!!this.links[t-1]},hasNextPage:function(){var e=this.state,t=this.state.currentPage;return"infinite"!=this.mode?t<e.lastPage:!!this.links[t+1]},getFirstPage:function(e){return this.getPage("first",e)},getPreviousPage:function(e){return this.getPage("prev",e)},getNextPage:function(e){return this.getPage("next",e)},getLastPage:function(e){return this.getPage("last",e)},getPage:function(e,t){var n=this.mode,s=this.fullCollection;t=t||{fetch:!1};var o=this.state,l=o.firstPage,c=o.currentPage,u=o.lastPage,d=o.pageSize,p=e;switch(e){case"first":p=l;break;case"prev":p=c-1;break;case"next":p=c+1;break;case"last":p=u;break;default:p=i(e,"index")}this.state=this._checkState(r({},o,{currentPage:p})),t.silent||this.trigger("pageable:state:change",this.state),t.from=c,t.to=p;var f=(0===l?p:p-1)*d,m=s&&s.length?s.models.slice(f,f+d):[];return"client"!=n&&("infinite"!=n||h(m))||t.fetch?("infinite"==n&&(t.url=this.links[p]),this.fetch(a(t,"fetch"))):(this.reset(m,a(t,"fetch")),this)},getPageByOffset:function(e,t){if(0>e)throw new RangeError("`offset must be > 0`");e=i(e);var n=_(e/this.state.pageSize);return 0!==this.state.firstPage&&n++,n>this.state.lastPage&&(n=this.state.lastPage),this.getPage(n,t)},sync:function(e,i,n){var s=this;if("infinite"==s.mode){var a=n.success,o=s.state.currentPage;n.success=function(e,t,i){var l=s.links,c=s.parseLinks(e,r({xhr:i},n));c.first&&(l[s.state.firstPage]=c.first),c.prev&&(l[o-1]=c.prev),c.next&&(l[o+1]=c.next),a&&a(e,t,i)}}return(w.sync||t.sync).call(s,e,i,n)},parseLinks:function(e,t){var i={},n=t.xhr.getResponseHeader("Link");if(n){var s=["first","prev","next"];l(n.split(","),function(e){var t=e.split(";"),n=t[0].replace(x,""),r=t.slice(1);l(r,function(e){var t=e.split("="),r=t[0].replace(S,""),a=t[1].replace(S,"");"rel"==r&&u(s,a)&&(i[a]=n)})})}return i},parse:function(e,t){var i=this.parseState(e,o(this.queryParams),o(this.state),t);return i&&(this.state=this._checkState(r({},this.state,i))),this.parseRecords(e,t)},parseState:function(t,i,n,s){if(t&&2===t.length&&g(t[0])&&f(t[1])){var r=o(n),c=t[0];return l(d(a(i,"directions")),function(t){var i=t[0],n=t[1],s=c[n];y(s)||e.isNull(s)||(r[i]=c[n])}),c.order&&(r.order=1*p(i.directions)[c.order]),r}},parseRecords:function(e,t){return e&&2===e.length&&g(e[0])&&f(e[1])?e[1]:e},fetch:function(t){t=t||{};var i=this._checkState(this.state),s=this.mode;"infinite"!=s||t.url||(t.url=this.links[i.currentPage]);var o=t.data||{},l=t.url||this.url||"";m(l)&&(l=l.call(this));var u=l.indexOf("?");-1!=u&&(r(o,n(l.slice(u+1))),l=l.slice(0,u)),t.url=l,t.data=o;var h="client"==this.mode?c(this.queryParams,"sortKey","order"):a(c(this.queryParams,v(C.queryParams)),"directions"),p=e.clone(this);e.each(h,function(t,n){t=m(t)?t.call(p):t,null!=i[n]&&null!=t&&e.isUndefined(o[t])&&(o[t]=i[n])},this);var g;if(i.sortKey&&i.order){var b=m(h.order)?h.order.call(p):h.order;if(f(i.order))for(o[b]=[],g=0;g<i.order.length;g+=1)o[b].push(this.queryParams.directions[i.order[g]]);else o[b]=this.queryParams.directions[i.order+""]}else i.sortKey||delete o[h.order];var _,k,S=d(a(this.queryParams,v(C.queryParams)));for(g=0;g<S.length;g++)_=S[g],k=_[1],k=m(k)?k.call(p):k,null!=k&&(o[_[0]]=k);if("server"!=s){var x=this,M=this.fullCollection,P=t.success;return t.success=function(e,i,n){n=n||{},y(t.silent)?delete n.silent:n.silent=t.silent;var a=e.models;"client"==s?M.reset(a,n):(M.add(a,r({at:M.length},r(n,{parse:!1}))),x.trigger("reset",x,n)),P&&P(e,i,n)},w.fetch.call(this,r({},t,{silent:!0}))}return w.fetch.call(this,t)},_makeComparator:function(e,t,i){var n=this.state;return e=e||n.sortKey,t=t||n.order,e&&t?(i||(i=function(e,t){return e.get(t)}),function(n,s){var r,a=i(n,e),o=i(s,e);return 1===t&&(r=a,a=o,o=r),a===o?0:o>a?-1:1}):void 0},setSorting:function(e,t,i){var n=this.state;n.sortKey=e,n.order=t=t||n.order;var s=this.fullCollection,a=!1,o=!1;e||(a=o=!0);var l=this.mode;i=r({side:"client"==l?l:"server",full:!0},i);var c=this._makeComparator(e,t,i.sortValue),u=i.full,h=i.side;return"client"==h?u?(s&&(s.comparator=c),a=!0):(this.comparator=c,o=!0):"server"!=h||u||(this.comparator=c),a&&(this.comparator=null),o&&s&&(s.comparator=null),this}}),C=M.prototype;return M}),define("lib/backbone/forms",["jquery","underscore","backbone"],function(e,t,i){var n=i.View.extend({events:{submit:function(e){this.trigger("submit",e)}},initialize:function(e){var i=this;e=this.options=t.extend({submitButton:!1},e);var n=this.schema=function(){if(e.schema)return t.result(e,"schema");var n=e.model;return n&&n.schema?t.result(n,"schema"):i.schema?t.result(i,"schema"):{}}();t.extend(this,t.pick(e,"model","data","idPrefix","templateData"));var s=this.constructor;this.template=e.template||this.template||s.template,this.Fieldset=e.Fieldset||this.Fieldset||s.Fieldset,this.Field=e.Field||this.Field||s.Field,this.NestedField=e.NestedField||this.NestedField||s.NestedField;var r=this.selectedFields=e.fields||t.keys(n),a=this.fields={};t.each(r,function(e){var t=n[e];a[e]=this.createField(e,t)},this);var o=e.fieldsets||t.result(this,"fieldsets")||[r];this.fieldsets=[];t.each(o,function(e){this.fieldsets.push(this.createFieldset(e))},this)},createFieldset:function(e){var t={schema:e,fields:this.fields};return new this.Fieldset(t)},createField:function(e,t){var i={form:this,key:e,schema:t,idPrefix:this.idPrefix};this.model?i.model=this.model:this.data?i.value=this.data[e]:i.value=null;var n=new this.Field(i);return this.listenTo(n.editor,"all",this.handleEditorEvent),n},handleEditorEvent:function(e,i){var n=i.key+":"+e;switch(this.trigger.call(this,n,this,i,Array.prototype.slice.call(arguments,2)),e){case"change":this.trigger("change",this);break;case"focus":this.hasFocus||this.trigger("focus",this);break;case"blur":if(this.hasFocus){var s=this;setTimeout(function(){var e=t.find(s.fields,function(e){return e.editor.hasFocus});e||s.trigger("blur",s)},0)}}},templateData:function(){var e=this.options;return{submitButton:e.submitButton}},render:function(){var e=this,n=this.fields,s=i.$,r=s(s.trim(this.template(t.result(this,"templateData"))));return r.find("[data-editors]").add(r).each(function(i,r){var a=s(r),o=a.attr("data-editors");if(!t.isUndefined(o)){var l="*"==o?e.selectedFields||t.keys(n):o.split(",");t.each(l,function(e){var t=n[e];a.append(t.editor.render().el)})}}),r.find("[data-fields]").add(r).each(function(i,r){var a=s(r),o=a.attr("data-fields");if(!t.isUndefined(o)){var l="*"==o?e.selectedFields||t.keys(n):o.split(",");t.each(l,function(e){var t=n[e];a.append(t.render().el)})}}),r.find("[data-fieldsets]").add(r).each(function(i,n){var r=s(n),a=r.attr("data-fieldsets");t.isUndefined(a)||t.each(e.fieldsets,function(e){r.append(e.render().el)})}),this.setElement(r),r.addClass(this.className),this},validate:function(e){var i=this.fields,n=this.model,s={};if(e=e||{},t.each(i,function(e){var t=e.validate();t&&(s[e.key]=t)}),!e.skipModelValidate&&n&&n.validate){var r=n.validate(this.getValue());if(r){var a=t.isObject(r)&&!t.isArray(r);a||(s._others=s._others||[],s._others.push(r)),a&&t.each(r,function(e,t){if(i[t]&&!s[t])i[t].setError(e),s[t]=e;else{s._others=s._others||[];var n={};n[t]=e,s._others.push(n)}})}}return t.isEmpty(s)?null:s},commit:function(e){e=e||{};var i={skipModelValidate:!e.validate},n=this.validate(i);if(n)return n;var s,r=t.extend({error:function(e,t){s=t}},e);return this.model.set(this.getValue(),r),s?s:void 0},getValue:function(e){if(e)return this.fields[e].getValue();var i={};return t.each(this.fields,function(e){i[e.key]=e.getValue()}),i},setValue:function(e,t){var i={};"string"==typeof e?i[e]=t:i=e;var n;for(n in this.schema)void 0!==i[n]&&this.fields[n].setValue(i[n])},getEditor:function(e){var t=this.fields[e];if(!t)throw new Error("Field not found: "+e);return t.editor},focus:function(){if(!this.hasFocus){var e=this.fieldsets[0],t=e.getFieldAt(0);t&&t.editor.focus()}},blur:function(){if(this.hasFocus){var e=t.find(this.fields,function(e){return e.editor.hasFocus});e&&e.editor.blur()}},trigger:function(e){return"focus"===e?this.hasFocus=!0:"blur"===e&&(this.hasFocus=!1),i.View.prototype.trigger.apply(this,arguments)},remove:function(){return t.each(this.fieldsets,function(e){e.remove()}),t.each(this.fields,function(e){e.remove()}),i.View.prototype.remove.apply(this,arguments)}},{template:t.template('    <form>     <div data-fieldsets></div>      <% if (submitButton) { %>        <button type="submit"><%= submitButton %></button>      <% } %>    </form>  ',null,this.templateSettings),templateSettings:{evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},editors:{}});return n.validators=function(){var e={};return e.errMessages={required:"Required",regexp:"Invalid",number:"Must be a number",email:"Invalid email address",url:"Invalid URL",match:t.template('Must match field "<%= field %>"',null,n.templateSettings)},e.required=function(e){return e=t.extend({type:"required",message:this.errMessages.required},e),function(i){e.value=i;var n={type:e.type,message:t.isFunction(e.message)?e.message(e):e.message};return null===i||void 0===i||i===!1||""===i?n:void 0}},e.regexp=function(e){if(!e.regexp)throw new Error('Missing required "regexp" option for "regexp" validator');return e=t.extend({type:"regexp",match:!0,message:this.errMessages.regexp},e),function(i){e.value=i;var n={type:e.type,message:t.isFunction(e.message)?e.message(e):e.message};if(null!==i&&void 0!==i&&""!==i)return"string"==typeof e.regexp&&(e.regexp=new RegExp(e.regexp,e.flags)),(e.match?!e.regexp.test(i):e.regexp.test(i))?n:void 0}},e.number=function(i){return i=t.extend({type:"number",message:this.errMessages.number,regexp:/^[0-9]*\.?[0-9]*?$/},i),e.regexp(i)},e.email=function(i){return i=t.extend({type:"email",message:this.errMessages.email,regexp:/^[\w\-]{1,}([\w\-\+.]{1,1}[\w\-]{1,}){0,}[@][\w\-]{1,}([.]([\w\-]{1,})){1,3}$/},i),e.regexp(i)},e.url=function(i){return i=t.extend({type:"url",message:this.errMessages.url,regexp:/^(http|https):\/\/(([A-Z0-9][A-Z0-9_\-]*)(\.[A-Z0-9][A-Z0-9_\-]*)+)(:(\d+))?\/?/i},i),e.regexp(i)},e.match=function(e){if(!e.field)throw new Error('Missing required "field" options for "match" validator');return e=t.extend({type:"match",message:this.errMessages.match},e),function(i,n){e.value=i;var s={type:e.type,message:t.isFunction(e.message)?e.message(e):e.message};if(null!==i&&void 0!==i&&""!==i)return i!==n[e.field]?s:void 0}},e}(),n.Fieldset=i.View.extend({initialize:function(e){e=e||{};var i=this.schema=this.createSchema(e.schema);this.fields=t.pick(e.fields,i.fields),this.template=e.template||i.template||this.template||this.constructor.template},createSchema:function(e){return t.isArray(e)&&(e={fields:e}),e.legend=e.legend||null,e},getFieldAt:function(e){var t=this.schema.fields[e];return this.fields[t]},templateData:function(){return this.schema},render:function(){var e=(this.schema,this.fields),n=i.$,s=n(n.trim(this.template(t.result(this,"templateData"))));return s.find("[data-fields]").add(s).each(function(i,s){var r=n(s),a=r.attr("data-fields");t.isUndefined(a)||t.each(e,function(e){r.append(e.render().el)})}),this.setElement(s),this},remove:function(){t.each(this.fields,function(e){e.remove()}),i.View.prototype.remove.call(this)}},{template:t.template("    <fieldset data-fields>      <% if (legend) { %>        <legend><%= legend %></legend>      <% } %>    </fieldset>  ",null,n.templateSettings)}),n.Field=i.View.extend({initialize:function(e){e=e||{},t.extend(this,t.pick(e,"form","key","model","value","idPrefix"));var i=this.schema=this.createSchema(e.schema);this.template=e.template||i.template||this.template||this.constructor.template,this.errorClassName=e.errorClassName||this.errorClassName||this.constructor.errorClassName,this.editor=this.createEditor()},createSchema:function(e){return t.isString(e)&&(e={type:e}),e=t.extend({type:"Text",title:this.createTitle()},e),e.type=t.isString(e.type)?n.editors[e.type]:e.type,e},createEditor:function(){var e=t.extend(t.pick(this,"schema","form","key","model","value"),{id:this.createEditorId()}),i=this.schema.type;return new i(e)},createEditorId:function(){var e=this.idPrefix,i=this.key;return i=i.replace(/\./g,"_"),t.isString(e)||t.isNumber(e)?e+i:t.isNull(e)?i:this.model?this.model.cid+"_"+i:i},createTitle:function(){var e=this.key;return e=e.replace(/([A-Z])/g," $1"),e=e.replace(/^./,function(e){return e.toUpperCase()})},templateData:function(){var e=this.schema;return{help:e.help||"",title:e.title,fieldAttrs:e.fieldAttrs,editorAttrs:e.editorAttrs,key:this.key,editorId:this.editor.id}},render:function(){var e=this.schema,s=this.editor,r=i.$;if(e.type==n.editors.Hidden)return this.setElement(s.render().el);var a=r(r.trim(this.template(t.result(this,"templateData"))));return e.fieldClass&&a.addClass(e.fieldClass),e.fieldAttrs&&a.attr(e.fieldAttrs),a.find("[data-editor]").add(a).each(function(e,i){var n=r(i),a=n.attr("data-editor");t.isUndefined(a)||n.append(s.render().el)}),this.setElement(a),this},validate:function(){var e=this.editor.validate();return e?this.setError(e.message):this.clearError(),e},setError:function(e){this.editor.hasNestedForm||(this.$el.addClass(this.errorClassName),this.$("[data-error]").html(e))},clearError:function(){this.$el.removeClass(this.errorClassName),this.$("[data-error]").empty()},commit:function(){return this.editor.commit()},getValue:function(){return this.editor.getValue()},setValue:function(e){this.editor.setValue(e)},focus:function(){this.editor.focus()},blur:function(){this.editor.blur()},remove:function(){this.editor.remove(),i.View.prototype.remove.call(this)}},{template:t.template('    <div>      <label for="<%= editorId %>"><%= title %></label>      <div>        <span data-editor></span>        <div data-error></div>        <div><%= help %></div>      </div>    </div>  ',null,n.templateSettings),errorClassName:"error"}),n.NestedField=n.Field.extend({template:t.template("    <div>      <span data-editor></span>      <% if (help) { %>        <div><%= help %></div>      <% } %>      <div data-error></div>    </div>  ",null,n.templateSettings)}),n.Editor=n.editors.Base=i.View.extend({defaultValue:null,hasFocus:!1,initialize:function(e){var e=e||{};if(e.model){if(!e.key)throw new Error("Missing option: 'key'");this.model=e.model,this.value=this.model.get(e.key)}else void 0!==e.value&&(this.value=e.value);void 0===this.value&&(this.value=this.defaultValue),t.extend(this,t.pick(e,"key","form"));var i=this.schema=e.schema||{};this.validators=e.validators||i.validators,this.$el.attr("id",this.id),this.$el.attr("name",this.getName()),i.editorClass&&this.$el.addClass(i.editorClass),i.editorAttrs&&this.$el.attr(i.editorAttrs)},getName:function(){var e=this.key||"";return e.replace(/\./g,"_")},getValue:function(){return this.value},setValue:function(e){this.value=e},focus:function(){throw new Error("Not implemented")},blur:function(){throw new Error("Not implemented")},commit:function(e){var t=this.validate();return t?t:(this.listenTo(this.model,"invalid",function(e,i){t=i}),this.model.set(this.key,this.getValue(),e),t?t:void 0)},validate:function(){var e=(this.$el,null),i=this.getValue(),n=this.form?this.form.getValue():{},s=this.validators,r=this.getValidator;return s&&t.every(s,function(t){return e=r(t)(i,n),e?!1:!0}),e},trigger:function(e){return"focus"===e?this.hasFocus=!0:"blur"===e&&(this.hasFocus=!1),i.View.prototype.trigger.apply(this,arguments)},getValidator:function(e){var i=n.validators;if(t.isRegExp(e))return i.regexp({regexp:e});if(t.isString(e)){if(!i[e])throw new Error('Validator "'+e+'" not found');return i[e]()}if(t.isFunction(e))return e;if(t.isObject(e)&&e.type){var s=e;return i[s.type](s)}throw new Error("Invalid validator: "+e)}}),n.editors.Text=n.Editor.extend({tagName:"input",defaultValue:"",previousValue:"",events:{keyup:"determineChange",keypress:function(e){var t=this;setTimeout(function(){t.determineChange()},0)},select:function(e){this.trigger("select",this)},focus:function(e){this.trigger("focus",this)},blur:function(e){this.trigger("blur",this)}},initialize:function(e){n.editors.Base.prototype.initialize.call(this,e);var t=this.schema,i="text";t&&t.editorAttrs&&t.editorAttrs.type&&(i=t.editorAttrs.type),t&&t.dataType&&(i=t.dataType),this.$el.attr("type",i)},render:function(){return this.setValue(this.value),this},determineChange:function(e){var t=this.$el.val(),i=t!==this.previousValue;i&&(this.previousValue=t,this.trigger("change",this))},getValue:function(){return this.$el.val()},setValue:function(e){this.$el.val(e)},focus:function(){this.hasFocus||this.$el.focus()},blur:function(){this.hasFocus&&this.$el.blur()},select:function(){this.$el.select()}}),n.editors.TextArea=n.editors.Text.extend({tagName:"textarea",initialize:function(e){n.editors.Base.prototype.initialize.call(this,e)}}),n.editors.Password=n.editors.Text.extend({initialize:function(e){n.editors.Text.prototype.initialize.call(this,e),this.$el.attr("type","password")}}),n.editors.Number=n.editors.Text.extend({defaultValue:0,events:t.extend({},n.editors.Text.prototype.events,{keypress:"onKeyPress",change:"onKeyPress"}),initialize:function(e){n.editors.Text.prototype.initialize.call(this,e);var t=this.schema;this.$el.attr("type","number"),t&&t.editorAttrs&&t.editorAttrs.step||this.$el.attr("step","any")},onKeyPress:function(e){var t=this,i=function(){setTimeout(function(){t.determineChange()},0)};if(0===e.charCode)return void i();var n=this.$el.val();void 0!=e.charCode&&(n+=String.fromCharCode(e.charCode));var s=/^[0-9]*\.?[0-9]*?$/.test(n);s?i():e.preventDefault()},getValue:function(){var e=this.$el.val();return""===e?null:parseFloat(e,10)},setValue:function(e){e=function(){return t.isNumber(e)?e:t.isString(e)&&""!==e?parseFloat(e,10):null}(),t.isNaN(e)&&(e=null),n.editors.Text.prototype.setValue.call(this,e)}}),n.editors.Hidden=n.editors.Text.extend({
defaultValue:"",initialize:function(e){n.editors.Text.prototype.initialize.call(this,e),this.$el.attr("type","hidden")},focus:function(){},blur:function(){}}),n.editors.Checkbox=n.editors.Base.extend({defaultValue:!1,tagName:"input",events:{click:function(e){this.trigger("change",this)},focus:function(e){this.trigger("focus",this)},blur:function(e){this.trigger("blur",this)}},initialize:function(e){n.editors.Base.prototype.initialize.call(this,e),this.$el.attr("type","checkbox")},render:function(){return this.setValue(this.value),this},getValue:function(){return this.$el.prop("checked")},setValue:function(e){e?this.$el.prop("checked",!0):this.$el.prop("checked",!1)},focus:function(){this.hasFocus||this.$el.focus()},blur:function(){this.hasFocus&&this.$el.blur()}}),n.editors.Select=n.editors.Base.extend({tagName:"select",previousValue:"",events:{keyup:"determineChange",keypress:function(e){var t=this;setTimeout(function(){t.determineChange()},0)},change:function(e){this.trigger("change",this)},focus:function(e){this.trigger("focus",this)},blur:function(e){this.trigger("blur",this)}},initialize:function(e){if(n.editors.Base.prototype.initialize.call(this,e),!this.schema||!this.schema.options)throw new Error("Missing required 'schema.options'")},render:function(){return this.setOptions(this.schema.options),this},setOptions:function(e){var n=this;if(e instanceof i.Collection){var s=e;s.length>0?this.renderOptions(e):s.fetch({success:function(t){n.renderOptions(e)}})}else t.isFunction(e)?e(function(e){n.renderOptions(e)},n):this.renderOptions(e)},renderOptions:function(e){var t,i=this.$el;t=this._getOptionsHtml(e),i.html(t),this.setValue(this.value)},_getOptionsHtml:function(e){var n;if(t.isString(e))n=e;else if(t.isArray(e))n=this._arrayToHtml(e);else if(e instanceof i.Collection)n=this._collectionToHtml(e);else if(t.isFunction(e)){var s;e(function(e){s=e},this),n=this._getOptionsHtml(s)}else n=this._objectToHtml(e);return n},determineChange:function(e){var t=this.getValue(),i=t!==this.previousValue;i&&(this.previousValue=t,this.trigger("change",this))},getValue:function(){return this.$el.val()},setValue:function(e){this.$el.val(e)},focus:function(){this.hasFocus||this.$el.focus()},blur:function(){this.hasFocus&&this.$el.blur()},_collectionToHtml:function(e){var t=[];e.each(function(e){t.push({val:e.id,label:e.toString()})});var i=this._arrayToHtml(t);return i},_objectToHtml:function(e){var t=[];for(var i in e)e.hasOwnProperty(i)&&t.push({val:i,label:e[i]});var n=this._arrayToHtml(t);return n},_arrayToHtml:function(e){var i=[];return t.each(e,function(e){if(t.isObject(e))if(e.group)i.push('<optgroup label="'+e.group+'">'),i.push(this._getOptionsHtml(e.options)),i.push("</optgroup>");else{var n=e.val||0===e.val?e.val:"";i.push('<option value="'+n+'">'+e.label+"</option>")}else i.push("<option>"+e+"</option>")},this),i.join("")}}),n.editors.Radio=n.editors.Select.extend({tagName:"ul",events:{"change input[type=radio]":function(){this.trigger("change",this)},"focus input[type=radio]":function(){this.hasFocus||this.trigger("focus",this)},"blur input[type=radio]":function(){if(this.hasFocus){var e=this;setTimeout(function(){e.$("input[type=radio]:focus")[0]||e.trigger("blur",e)},0)}}},getTemplate:function(){return this.schema.template||this.constructor.template},getValue:function(){return this.$("input[type=radio]:checked").val()},setValue:function(e){this.$("input[type=radio]").val([e])},focus:function(){if(!this.hasFocus){var e=this.$("input[type=radio]:checked");return e[0]?void e.focus():void this.$("input[type=radio]").first().focus()}},blur:function(){this.hasFocus&&this.$("input[type=radio]:focus").blur()},_arrayToHtml:function(e){var i=this,n=this.getTemplate(),s=i.getName(),r=i.id,a=t.map(e,function(e,i){var n={name:s,id:r+"-"+i};return t.isObject(e)?(n.value=e.val||0===e.val?e.val:"",n.label=e.label):(n.value=e,n.label=e),n});return n({items:a})}},{template:t.template('    <% _.each(items, function(item) { %>      <li>        <input type="radio" name="<%= item.name %>" value="<%= item.value %>" id="<%= item.id %>" />        <label for="<%= item.id %>"><%= item.label %></label>      </li>    <% }); %>  ',null,n.templateSettings)}),n.editors.Checkboxes=n.editors.Select.extend({tagName:"ul",groupNumber:0,events:{"click input[type=checkbox]":function(){this.trigger("change",this)},"focus input[type=checkbox]":function(){this.hasFocus||this.trigger("focus",this)},"blur input[type=checkbox]":function(){if(this.hasFocus){var e=this;setTimeout(function(){e.$("input[type=checkbox]:focus")[0]||e.trigger("blur",e)},0)}}},getValue:function(){var t=[];return this.$("input[type=checkbox]:checked").each(function(){t.push(e(this).val())}),t},setValue:function(e){t.isArray(e)||(e=[e]),this.$("input[type=checkbox]").val(e)},focus:function(){this.hasFocus||this.$("input[type=checkbox]").first().focus()},blur:function(){this.hasFocus&&this.$("input[type=checkbox]:focus").blur()},_arrayToHtml:function(e){var i=[],n=this;return t.each(e,function(e,s){var r="<li>",a=!0;if(t.isObject(e))if(e.group){var o=n.id;n.id+="-"+n.groupNumber++,r='<fieldset class="group"> <legend>'+e.group+"</legend>",r+=n._arrayToHtml(e.options),r+="</fieldset>",n.id=o,a=!1}else{var l=e.val||0===e.val?e.val:"";r+='<input type="checkbox" name="'+n.getName()+'" value="'+l+'" id="'+n.id+"-"+s+'" />',r+='<label for="'+n.id+"-"+s+'">'+e.label+"</label>"}else r+='<input type="checkbox" name="'+n.getName()+'" value="'+e+'" id="'+n.id+"-"+s+'" />',r+='<label for="'+n.id+"-"+s+'">'+e+"</label>";a&&(r+="</li>"),i.push(r)}),i.join("")}}),n.editors.Object=n.editors.Base.extend({hasNestedForm:!0,initialize:function(e){if(this.value={},n.editors.Base.prototype.initialize.call(this,e),!this.form)throw new Error('Missing required option "form"');if(!this.schema.subSchema)throw new Error("Missing required 'schema.subSchema' option for Object editor")},render:function(){var e=this.form.constructor;return this.nestedForm=new e({schema:this.schema.subSchema,data:this.value,idPrefix:this.id+"_",Field:e.NestedField}),this._observeFormEvents(),this.$el.html(this.nestedForm.render().el),this.hasFocus&&this.trigger("blur",this),this},getValue:function(){return this.nestedForm?this.nestedForm.getValue():this.value},setValue:function(e){this.value=e,this.render()},focus:function(){this.hasFocus||this.nestedForm.focus()},blur:function(){this.hasFocus&&this.nestedForm.blur()},remove:function(){this.nestedForm.remove(),i.View.prototype.remove.call(this)},validate:function(){return this.nestedForm.validate()},_observeFormEvents:function(){this.nestedForm&&this.nestedForm.on("all",function(){var e=t.toArray(arguments);e[1]=this,this.trigger.apply(this,e)},this)}}),n.editors.NestedModel=n.editors.Object.extend({initialize:function(e){if(n.editors.Base.prototype.initialize.call(this,e),!this.form)throw new Error('Missing required option "form"');if(!e.schema.model)throw new Error('Missing required "schema.model" option for NestedModel editor')},render:function(){var e=this.form.constructor,t=this.value||{},i=(this.key,this.schema.model),n=t.constructor===i?t:new i(t);return this.nestedForm=new e({model:n,idPrefix:this.id+"_",fieldTemplate:"nestedField"}),this._observeFormEvents(),this.$el.html(this.nestedForm.render().el),this.hasFocus&&this.trigger("blur",this),this},commit:function(){var e=this.nestedForm.commit();return e?(this.$el.addClass("error"),e):n.editors.Object.prototype.commit.call(this)}}),n.editors.Date=n.editors.Base.extend({events:{"change select":function(){this.updateHidden(),this.trigger("change",this)},"focus select":function(){this.hasFocus||this.trigger("focus",this)},"blur select":function(){if(this.hasFocus){var e=this;setTimeout(function(){e.$("select:focus")[0]||e.trigger("blur",e)},0)}}},initialize:function(e){e=e||{},n.editors.Base.prototype.initialize.call(this,e);var i=n.editors.Date,s=new Date;if(this.options=t.extend({monthNames:i.monthNames,showMonthNames:i.showMonthNames},e),this.schema=t.extend({yearStart:s.getFullYear()-100,yearEnd:s.getFullYear()},e.schema||{}),this.value&&!t.isDate(this.value)&&(this.value=new Date(this.value)),!this.value){var r=new Date;r.setSeconds(0),r.setMilliseconds(0),this.value=r}this.template=e.template||this.constructor.template},render:function(){var e=this.options,n=this.schema,s=i.$,r=t.map(t.range(1,32),function(e){return'<option value="'+e+'">'+e+"</option>"}),a=t.map(t.range(0,12),function(t){var i=e.showMonthNames?e.monthNames[t]:t+1;return'<option value="'+t+'">'+i+"</option>"}),o=n.yearStart<n.yearEnd?t.range(n.yearStart,n.yearEnd+1):t.range(n.yearStart,n.yearEnd-1,-1),l=t.map(o,function(e){return'<option value="'+e+'">'+e+"</option>"}),c=s(s.trim(this.template({dates:r.join(""),months:a.join(""),years:l.join("")})));return this.$date=c.find('[data-type="date"]'),this.$month=c.find('[data-type="month"]'),this.$year=c.find('[data-type="year"]'),this.$hidden=s('<input type="hidden" name="'+this.key+'" />'),c.append(this.$hidden),this.setValue(this.value),this.setElement(c),this.$el.attr("id",this.id),this.$el.attr("name",this.getName()),this.hasFocus&&this.trigger("blur",this),this},getValue:function(){var e=this.$year.val(),t=this.$month.val(),i=this.$date.val();return e&&t&&i?new Date(e,t,i):null},setValue:function(e){this.$date.val(e.getDate()),this.$month.val(e.getMonth()),this.$year.val(e.getFullYear()),this.updateHidden()},focus:function(){this.hasFocus||this.$("select").first().focus()},blur:function(){this.hasFocus&&this.$("select:focus").blur()},updateHidden:function(){var e=this.getValue();t.isDate(e)&&(e=e.toISOString()),this.$hidden.val(e)}},{template:t.template('    <div>      <select data-type="date"><%= dates %></select>      <select data-type="month"><%= months %></select>      <select data-type="year"><%= years %></select>    </div>  ',null,n.templateSettings),showMonthNames:!0,monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"]}),n.editors.DateTime=n.editors.Base.extend({events:{"change select":function(){this.updateHidden(),this.trigger("change",this)},"focus select":function(){this.hasFocus||this.trigger("focus",this)},"blur select":function(){if(this.hasFocus){var e=this;setTimeout(function(){e.$("select:focus")[0]||e.trigger("blur",e)},0)}}},initialize:function(e){e=e||{},n.editors.Base.prototype.initialize.call(this,e),this.options=t.extend({DateEditor:n.editors.DateTime.DateEditor},e),this.schema=t.extend({minsInterval:15},e.schema||{}),this.dateEditor=new this.options.DateEditor(e),this.value=this.dateEditor.value,this.template=e.template||this.constructor.template},render:function(){function e(e){return 10>e?"0"+e:e}var n=this.schema,s=i.$,r=t.map(t.range(0,24),function(t){return'<option value="'+t+'">'+e(t)+"</option>"}),a=t.map(t.range(0,60,n.minsInterval),function(t){return'<option value="'+t+'">'+e(t)+"</option>"}),o=s(s.trim(this.template({hours:r.join(),mins:a.join()})));return o.find("[data-date]").append(this.dateEditor.render().el),this.$hour=o.find('select[data-type="hour"]'),this.$min=o.find('select[data-type="min"]'),this.$hidden=o.find('input[type="hidden"]'),this.setValue(this.value),this.setElement(o),this.$el.attr("id",this.id),this.$el.attr("name",this.getName()),this.hasFocus&&this.trigger("blur",this),this},getValue:function(){var e=this.dateEditor.getValue(),t=this.$hour.val(),i=this.$min.val();return e&&t&&i?(e.setHours(t),e.setMinutes(i),e):null},setValue:function(e){t.isDate(e)||(e=new Date(e)),this.dateEditor.setValue(e),this.$hour.val(e.getHours()),this.$min.val(e.getMinutes()),this.updateHidden()},focus:function(){this.hasFocus||this.$("select").first().focus()},blur:function(){this.hasFocus&&this.$("select:focus").blur()},updateHidden:function(){var e=this.getValue();t.isDate(e)&&(e=e.toISOString()),this.$hidden.val(e)},remove:function(){this.dateEditor.remove(),n.editors.Base.prototype.remove.call(this)}},{template:t.template('    <div class="bbf-datetime">      <div class="bbf-date-container" data-date></div>      <select data-type="hour"><%= hours %></select>      :      <select data-type="min"><%= mins %></select>    </div>  ',null,n.templateSettings),DateEditor:n.editors.Date}),n.VERSION="0.14.1",i.Form=n,n}),define("lib/backbone/forms-bootstrap",["jquery","underscore","backbone","backbone-forms"],function(e,t,i){var n=i.Form;n.template=t.template('    <form class="form-horizontal" role="form">      <div data-fieldsets></div>      <% if (submitButton) { %>        <button type="submit" class="btn"><%= submitButton %></button>      <% } %>    </form>  '),n.Fieldset.template=t.template("    <fieldset data-fields>      <% if (legend) { %>        <legend><%= legend %></legend>      <% } %>    </fieldset>  "),n.Field.template=t.template('    <div class="form-group field-<%= key %>">      <label class="col-sm-2 control-label" for="<%= editorId %>"><%= title %></label>      <div class="col-sm-10">        <span data-editor></span>        <p class="help-block" data-error></p>        <p class="help-block"><%= help %></p>      </div>    </div>  '),n.NestedField.template=t.template('    <div class="field-<%= key %>">      <div title="<%= title %>" class="input-xlarge">        <span data-editor></span>        <div class="help-inline" data-error></div>      </div>      <div class="help-block"><%= help %></div>    </div>  '),n.editors.Base.prototype.className="form-control",n.Field.errorClassName="has-error",n.editors.List&&(n.editors.List.template=t.template('      <div class="bbf-list">        <ul class="list-unstyled clearfix" data-items></ul>        <button type="button" class="btn bbf-add" data-action="add">Add</button>      </div>    '),n.editors.List.Item.template=t.template('      <li class="clearfix">        <div class="pull-left" data-editor></div>        <button type="button" class="btn bbf-del" data-action="remove">&times;</button>      </li>    '),n.editors.List.Object.template=n.editors.List.NestedModel.template=t.template('      <div class="bbf-list-modal"><%= summary %></div>    '))}),define("app/app",["require","underscore","backbone","handlebars","moment","app/ui/layout","app/ui/controls","backbone/relational","backbone/paginator","backbone/forms"],function(e,t,i,n,s,r,a){function o(e){return t.isString(e)&&/http:\/\/[0-9a-z-:\.]+\/[a-z0-9-\/]+\/[0-9]+\//.test(e)}function l(e){return parseInt(/\d+/.exec(/\/\d+\//.exec(e)[0])[0])}var c=i.sync;i.sync=function(e,i,n){var s=t.isFunction(i.url)?i.url():i.url;return s+="/"==s.charAt(s.length-1)?"":"/",n=t.extend(n,{url:s}),c(e,i,n)},i.Collection.prototype.parse=function(e,i){return t.has(e,"results")?e.results:e};var u=i.RelationalModel.prototype.__updateRelations=i.RelationalModel.prototype.updateRelations;i.RelationalModel.prototype.updateRelations=function(e,i){this._isInitialized&&!this.isLocked()&&t.each(this._relations,function(t){var i;t.keySource in e&&(i=this.attributes[t.keySource],o(i)&&(this.attributes[t.keySource]=l(i),e[t.keySource]=l(i))),t.key in e&&(i=this.attributes[t.key],o(i)&&(this.attributes[t.key]=l(i),e[t.key]=l(i)))},this),u.call(this,e,i)};var h=i.HasOne.prototype.__setKeyContents=i.HasOne.prototype.setKeyContents;i.HasOne.prototype.setKeyContents=function(e){o(e)&&(e=l(e)),h.call(this,e)};var d=i.HasMany.prototype.__setKeyContents=i.HasMany.prototype.setKeyContents;return i.HasMany.prototype.setKeyContents=function(e){if(t.isArray(e)){var i=!0;t.each(e,function(e){o(e)||(i=!1)})}i&&(e=t.map(e,function(e){return l(e)})),d.call(this,e)},i.PageableCollection.prototype.parseRecords=function(e){return t.has(e,"results")?e.results:e},i.PageableCollection.prototype.parseLinks=function(e){var i={};return t.has(e,"next")&&(i.next=e.next),t.has(e,"prev")&&(i.prev=e.prev),i},i.Form.editors.Base.prototype._initialize=i.Form.editors.Base.prototype.initialize,i.Form.editors.Base.prototype.initialize=function(e){i.Form.editors.Base.prototype._initialize.call(this,e),e.model instanceof i.RelationalModel&&e.model.get(e.key)instanceof i.Collection&&(this.value=e.model.get(e.key).toJSON())},i.Form.template=t.template('    <form class="form-horizontal" role="form">      <div data-fieldsets></div>      <% if (submitButton) { %>        <button type="submit" class="btn btn-primary"><%= submitButton %></button>      <% } %>    </form>  '),i.Form.Field.template=t.template('    <div class="form-group field-<%= key %>">      <% if (title) { %>      <label class="col-sm-2 control-label hidden-xs" for="<%= editorId %>"><%= title %></label>      <% } %>      <div class="col-sm-<% if (title) { %>10<% } else { %>12<% } %>">        <span data-editor></span>        <p class="help-block" data-error></p>        <p class="help-block"><%= help %></p>      </div>    </div>  '),i.Form.editors.Tinymce=i.Form.editors.TextArea.extend({defaultSettings:{resize:!1,schema:"html5-strict",fix_list_elements:!0,keep_styles:!1,invalid_elements:"span",statusbar:!1,menubar:!1,height:160,plugins:"lists,paste,link,searchreplace,hr",toolbar:"undo redo | formatselect | bold italic | bullist numlist outdent indent | link hr blockquote",skin_url:"/static/css/lib/tinymce",body_class:"element-content",content_css:["https://fonts.googleapis.com/css?family=Lato:400,700,700italic,400italic","/static/css/lib/bootstrap.css","/static/css/app/content.css"]},tinymceEditorId:null,initialize:function(e){i.Form.editors.Base.prototype.initialize.call(this,e)},render:function(){this.setValue(this.value);var i=this,n={};return this.tinymceEditorId=i.$el.attr("id"),t.defaults(n,this.schema.settings,this.defaultSettings,{selector:"#"+i.tinymceEditorId}),n.setup=function(e){var t=function(){i.setValue(e.getContent())};e.on("keyup",t),e.on("change",t)},e(["jquery","tinymce"],function(e,t){t.EditorManager.execCommand("mceRemoveEditor",!0,i.tinymceEditorId),t.init(n)}),this},remove:function(){var t=this;e(["tinymce"],function(e){e.EditorManager.execCommand("mceRemoveEditor",!0,t.tinymceEditorId)}),this.tinymceEditor&&(this.tinymceEditor.destroy(),this.tinymceEditor=null),i.View.prototype.remove.call(this)}}),n.registerHelper("thread_pin_class",function(){return this.state&&this.state.get("watch")===App.Model.State.WATCH_PINNED?" active":""}),n.registerHelper("thread_ban_class",function(){return this.state&&this.state.get("watch")===App.Model.State.WATCH_BANNED?" active":""}),n.registerHelper("full_name",function(e){return e.get("first_name")+" "+e.get("last_name")}),n.registerHelper("paper_title_authors",function(e){var t=e.get("authors").map(function(e){return e.get("first_name")+" "+e.get("last_name")}),i=e.get("title")+" ("+t.splice(0,4).join(", ")+")";return new n.SafeString(i)}),n.registerHelper("date",function(e){return s(e).format("MMM D, YYYY")}),window.App=App={Backbone:i,Handlebars:n,Layout:r,Controls:a,Model:{},Collection:{},View:{createDefaults:{$target:null,append:!1},create:function(e,i){i=t.defaults(i,App.View.createDefaults),i.$target&&i.$target.length&&(!0===i.append?i.$target.append(e.render().$el):i.$target.replaceWith(e.render().$el))}},config:{debug:!0,api_root:"/api/v1"},defaults:function(e,i){return t.extend(e,i)},log:function(){this.config.debug&&(arguments.length>1?console.log(arguments[0],Array.prototype.splice.call(arguments,1)):console.log(arguments[0]))}},App}),define("app",["app/app"],function(e){return e}),define("app/view/modal",["jquery","underscore","app","bootstrap"],function(e,t,i){var n={label:"Button",attr:{type:"button","class":"btn btn-default"}},s={label:"Close",attr:{type:"button","class":"btn btn-default","data-dismiss":"modal"}};return i.View.Modal=i.Backbone.View.extend({template:i.Handlebars.compile('            <div class="modal-dialog">                <div class="modal-content">                    <div class="modal-header">                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">                            <span aria-hidden="true">&times;</span>                            </button>                        <h4 class="modal-title">{{title}}</h4>                    </div>                    <div class="modal-body"></div>                    {{#if footer}}<div class="modal-footer"></div>{{/if}}                </div>            </div>        '),buttonTemplate:i.Handlebars.compile('<button{{#each attr}} {{@key}}="{{this}}"{{/each}}>{{label}}</button>'),attributes:{"class":"modal fade",tabindex:"-1",role:"dialog"},defaults:{title:null,content:null,backdrop:!0,footer:{buttons:[s]}},events:{"hidden.bs.modal":"_onHidden","hide.bs.modal":"_onHide"},initialize:function(e){e||(e={}),t.defaults(this,this.defaults),t.extend(this,t.pick(e,t.keys(this.defaults))),t.bindAll(this,"close","_onHidden","_onHide")},render:function(){var e=t.isObject(this.footer)&&t.isObject(this.footer.buttons);if(this.$el.html(this.template({title:this.title,footer:e})),t.isObject(this.content)&&t.isFunction(this.content.render)?this.$(".modal-body").append(this.content.render().$el):this.$(".modal-body").append(this.content),e){var i=this,s=this.$(".modal-footer");t.each(this.footer.buttons,function(e){t.defaults(e,n),s.append(i.buttonTemplate(e))})}this.$el.modal({keyboard:!1,backdrop:this.backdrop})},_onHidden:function(){t.isObject(this.content)&&t.isFunction(this.content.remove)&&this.content.remove(),this.remove(),this.trigger("hidden")},_onHide:function(){this.trigger("hide")},close:function(){return this.$el.modal("hide"),this}}),i.View.Modal.defaultButton=s,i.View.Modal}),define("text",["module"],function(e){"use strict";var t,i,n,s,r,a=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],o=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,l=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,c="undefined"!=typeof location&&location.href,u=c&&location.protocol&&location.protocol.replace(/\:/,""),h=c&&location.hostname,d=c&&(location.port||void 0),p={},f=e.config&&e.config()||{};return t={version:"2.0.14",strip:function(e){if(e){e=e.replace(o,"");var t=e.match(l);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:f.createXhr||function(){var e,t,i;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){i=a[t];try{e=new ActiveXObject(i)}catch(n){}if(e){a=[i];break}}return e},parseName:function(e){var t,i,n,s=!1,r=e.lastIndexOf("."),a=0===e.indexOf("./")||0===e.indexOf("../");return-1!==r&&(!a||r>1)?(t=e.substring(0,r),i=e.substring(r+1)):t=e,n=i||t,r=n.indexOf("!"),-1!==r&&(s="strip"===n.substring(r+1),n=n.substring(0,r),i?i=n:t=n),{moduleName:t,ext:i,strip:s}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,i,n,s){var r,a,o,l=t.xdRegExp.exec(e);return l?(r=l[2],a=l[3],a=a.split(":"),o=a[1],a=a[0],!(r&&r!==i||a&&a.toLowerCase()!==n.toLowerCase()||(o||a)&&o!==s)):!0},finishLoad:function(e,i,n,s){n=i?t.strip(n):n,f.isBuild&&(p[e]=n),s(n)},load:function(e,i,n,s){if(s&&s.isBuild&&!s.inlineText)return void n();f.isBuild=s&&s.isBuild;var r=t.parseName(e),a=r.moduleName+(r.ext?"."+r.ext:""),o=i.toUrl(a),l=f.useXhr||t.useXhr;return 0===o.indexOf("empty:")?void n():void(!c||l(o,u,h,d)?t.get(o,function(i){t.finishLoad(e,r.strip,i,n)},function(e){n.error&&n.error(e)}):i([a],function(e){t.finishLoad(r.moduleName+"."+r.ext,r.strip,e,n)}))},write:function(e,i,n,s){if(p.hasOwnProperty(i)){var r=t.jsEscape(p[i]);n.asModule(e+"!"+i,"define(function () { return '"+r+"';});\n")}},writeFile:function(e,i,n,s,r){var a=t.parseName(i),o=a.ext?"."+a.ext:"",l=a.moduleName+o,c=n.toUrl(a.moduleName+o)+".js";t.load(l,n,function(i){var n=function(e){return s(c,e)};n.asModule=function(e,t){return s.asModule(e,c,t)},t.write(e,l,n,r)},r)}},"node"===f.env||!f.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]&&!process.versions["atom-shell"]?(i=require.nodeRequire("fs"),t.get=function(e,t,n){try{var s=i.readFileSync(e,"utf8");"\ufeff"===s[0]&&(s=s.substring(1)),t(s)}catch(r){n&&n(r)}}):"xhr"===f.env||!f.env&&t.createXhr()?t.get=function(e,i,n,s){var r,a=t.createXhr();if(a.open("GET",e,!0),s)for(r in s)s.hasOwnProperty(r)&&a.setRequestHeader(r.toLowerCase(),s[r]);f.onXhr&&f.onXhr(a,e),a.onreadystatechange=function(t){var s,r;4===a.readyState&&(s=a.status||0,s>399&&600>s?(r=new Error(e+" HTTP status: "+s),r.xhr=a,n&&n(r)):i(a.responseText),f.onXhrComplete&&f.onXhrComplete(a,e))},a.send(null)}:"rhino"===f.env||!f.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?t.get=function(e,t){var i,n,s="utf-8",r=new java.io.File(e),a=java.lang.System.getProperty("line.separator"),o=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(r),s)),l="";try{for(i=new java.lang.StringBuffer,n=o.readLine(),n&&n.length()&&65279===n.charAt(0)&&(n=n.substring(1)),null!==n&&i.append(n);null!==(n=o.readLine());)i.append(a),i.append(n);l=String(i.toString())}finally{o.close()}t(l)}:("xpconnect"===f.env||!f.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(n=Components.classes,s=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),r="@mozilla.org/windows-registry-key;1"in n,t.get=function(e,t){var i,a,o,l={};r&&(e=e.replace(/\//g,"\\")),o=new FileUtils.File(e);try{i=n["@mozilla.org/network/file-input-stream;1"].createInstance(s.nsIFileInputStream),i.init(o,1,0,!1),a=n["@mozilla.org/intl/converter-input-stream;1"].createInstance(s.nsIConverterInputStream),a.init(i,"utf-8",i.available(),s.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),a.readString(i.available(),l),a.close(),i.close(),t(l.value)}catch(c){throw new Error((o&&o.path||"")+": "+c)}}),t}),define("text!app/templates/thread/list.html",[],function(){return'<div class="thumb-list"></div>\n\n<a href="javascript: void(0)" id="thread-next-page">Show more</a>\n'}),define("text!app/templates/detail.html",[],function(){return'<div class="bar">\n    <div class="wrapper">\n        <div class="inner">\n            <div id="detail-prev" class="detail-nav">\n                <button class="btn-circle" type="button">\n                    <span class="eai eai-left"></span>\n                </button>\n                <span></span>\n            </div>\n            <div id="detail-next" class="detail-nav">\n                <button class="btn-circle" type="button">\n                    <span class="eai eai-right"></span>\n                </button>\n                <span></span>\n            </div>\n            <button id="detail-close" class="btn-circle" type="button">\n                <span class="eai eai-close"></span>\n            </button>\n        </div>\n    </div>\n</div>\n\n<div id="detail-document" class="document">\n    <div class="wrapper">\n        {{! <div class="inner"></div> }}\n    </div>\n</div>\n'}),define("app/model/detail",["app"],function(e){return e.Model.Detail=e.Backbone.Model.extend({defaults:{list:null,view:null},initialize:function(e){if(!this.get("list"))throw'"list" is mandatory.';if(!this.get("view"))throw'"view" is mandatory.'}})}),define("app/view/detail",["jquery","app","text!app/templates/detail.html","app/model/detail"],function(e,t,i){var n={};return t.View.Detail=t.Backbone.View.extend({tagName:"div",id:"detail",template:t.Handlebars.compile(i),events:{"click #detail-close":"close"},initialize:function(e){if(t.defaults(e,n),!this.model instanceof t.Model.Detail)throw"Unexpected model type"},render:function(){return e("detail-placeholder").replaceWith(this.$el.html(this.template({}))),this.model.get("view").render().$el.appendTo(this.$(".document .wrapper")),this.open()},open:function(){return e("body").addClass("detail-opened"),this},close:function(){return e("body").removeClass("detail-opened"),this}})}),define("text!app/templates/thread/detail.html",[],function(){return'<div id="detail-actions" class="actions">\n    <div class="card">\n\n        <a href="javascript: void(0)"\n           class="detail-pin{{thread_pin_class}}"\n           title="Pin/Unpin">\n            <span class="eai eai-pin"></span>\n        </a>\n        <a href="javascript: void(0)"\n           class="detail-ban{{thread_ban_class}}"\n           title="Remove from feed">\n            <span class="eai eai-remove"></span>\n        </a>\n        <a href="javascript: void(0)"\n           class="detail-library-trash loading-button"\n           title="Move to trash">\n            <span class="eai eai-library-trash"></span>\n        </a>\n\n        <a href="javascript: void(0)"\n           class="detail-mail" title="Email">\n            <span class="eai eai-mail"></span>\n        </a>\n        <a href="javascript: void(0)" class="detail-twitter" title="Share on twitter">\n            <span class="eai eai-twitter"></span>\n        </a>\n        <a href="javascript: void(0)" class="detail-google-plus" title="Share on Google+">\n            <span class="eai eai-google-plus"></span>\n        </a>\n\n    </div>\n</div>\n\n<div class="content">\n    <div class="card">\n\n        <div data-user-placeholder></div>\n\n        <p class="title">\n            <a href="javascript: void(0)">\n                {{!<span>new</span>}}\n                {{title}}\n            </a>\n        </p>\n        <div class="infos">\n            <p>\n                <strong>{{full_name user}}</strong> -\n                <em>{{date created}}</em>\n            </p>\n            <p class="icons">\n                <span class="comment">\n                    <span class="count">16</span>\n                    <span class="eai eai-comment"></span>\n                </span>\n                <span class="member">\n                    <span class="count">16</span>\n                    <span class="eai eai-user"></span>\n                </span>\n            </p>\n        </div>\n        <div class="materials">\n            {{#if paper}}\n            <p>\n                <span class="eai eai-pdf"></span>\n                On <a href="javascript: void(0)">{{paper_title_authors paper}}</a>\n            </p>\n            {{/if}}\n        </div>\n    </div>\n\n    <div class="thread thread-box">\n        <div class="thread-content element-content">\n            {{#if content}}\n                {{{content}}}\n            {{else}}\n            <p style="padding:50px 0;text-align:center">\n                <button type="button" class="btn btn-primary btn-lg thread-edit">\n                    Start writing !\n                </button>\n            </p>\n            {{/if}}\n        </div>\n\n        <p class="thread-info element-info">\n            <strong>{{full_name user}}</strong> - <em>{{date created}}</em>\n            - <a href="javascript: void(0)" class="thread-edit">edit</a>\n            - <a href="javascript: void(0)" class="thread-delete">delete</a>\n        </p>\n\n        <div data-thread-edit-form></div>\n    </div>\n\n    <div data-members-placeholder></div>\n\n    <div data-posts-placeholder></div>\n\n    <div class="neighbors-thumbs">\n        <h2>Similar threads</h2>\n        <ul class="neighbors-timespan-selector">\n            <li>\n                <a href="javascript: void(0)" data-value="365">1 year</a>\n            </li>\n            <li class="active">\n                <a href="javascript: void(0)" data-value="30">1 month</a>\n            </li>\n            <li>\n                <a href="javascript: void(0)" data-value="7">Week</a>\n            </li>\n        </ul>\n        <div class="thumb-list async-content">\n\n            <!-- TODO -->\n\n        </div>\n    </div>\n\n</div>\n'}),define("text!app/templates/user/thumb.html",[],function(){return'<img src="{{photo_url}}" alt="{{first_name}} {{last_name}}" width="200" height="200">\n<div class="user-card">\n    <p class="user-name">{{first_name}} {{last_name}}</p>\n    <p class="user-affiliation">SF Institute of technologies</p>\n    <p class="user-actions">\n        <a href="javascript: void(0)">\n            <!--{% if user_followed %}\n            - Followed\n            {% else %}-->\n            + Follow\n            <!--{% endif %}-->\n        </a>\n        <a href="javascript: void(0)">View profile</a>\n    </p>\n</div>\n';
}),define("app/view/user/thumb",["app","text!app/templates/user/thumb.html"],function(e,t){return e.View.User=e.View.User||{},e.View.User.Thumb=e.Backbone.View.extend({tagName:"div",className:"user",template:e.Handlebars.compile(t),initialize:function(){this.listenTo(this.model,"change",this.render)},render:function(){return this.$el.html(this.template(this.model.attributes)),this}}),e.View.User.Thumb.create=function(t,i){if(t=t||{},!t.model)throw"options.model is expected to be an instance of App.Model.User";t.id||(t.id="user-thumb-"+t.model.get("id"));var n=new e.View.User.Thumb(t);return i&&e.View.create(n,i),n},e.View.User.Thumb}),define("text!app/templates/user/list.html",[],function(){return'<div class="thread-members-list"></div>\n<div class="thread-members-toggle">\n    <a href="javascript: void(0)">\n        <span class="eai eai-down"></span>\n    </a>\n</div>\n'}),define("app/view/user/list",["app","text!app/templates/user/list.html","app/view/user/thumb"],function(e,t){return e.View.User=e.View.User||{},e.View.User.List=e.Backbone.View.extend({tagName:"div",className:"thread-members thread-box",template:e.Handlebars.compile(t),events:{},initialize:function(){this.listenTo(this.model,"reset update",this.render)},render:function(){e.log("UserListView::render"),this.$el.html(this.template({}));var t=this.$(".thread-members-list");return this.model.each(function(i){e.View.User.Thumb.create({model:i},{$target:t,append:!0})}),this}}),e.View.User.List.create=function(t,i){t=t||{},t.model||(t.model=new e.Collection.Users);var n=new e.View.User.List(t);return i&&e.View.create(n,i),n},e.View.User.List}),define("text!app/templates/thread/post/list.html",[],function(){return'<div class="thread-posts-list"></div>\n\n<div class="thread-post">\n\n    <div class="user-placeholder"></div>\n\n    <div data-post-add-form></div>\n\n</div>\n\n'}),define("text!app/templates/thread/post/thumb.html",[],function(){return'<div data-user-thumb></div>\n\n<div class="post-content element-content">\n    {{{content}}}\n</div>\n<p class="post-info element-info">\n    <strong>{{full_name user}}</strong> - <em>Sep 25, 2015</em>\n    - <a href="javascript: void(0)" class="post-edit">edit</a>\n    - <a href="javascript: void(0)" class="post-delete">delete</a>\n</p>\n\n<div data-post-edit-form></div>\n\n<div data-comment-list></div>\n'}),define("text!app/templates/thread/comment/list.html",[],function(){return'<div class="thread-comments-list"></div>\n\n<div class="thread-comment">\n\n    <a href="javascript: void(0)" class="tread-comment-add">Add a comment</a>\n\n    <div data-comment-add-form></div>\n\n</div>\n\n'}),define("text!app/templates/thread/comment/thumb.html",[],function(){return'<div data-user-thumb></div>\n\n<div class="comment-content element-content">\n    {{content}}\n</div>\n<p class="comment-info element-info">\n    <strong>{{full_name user}}</strong> - <em>Sep 25, 2015</em>\n    - <a href="javascript: void(0)" class="comment-edit">edit</a>\n    - <a href="javascript: void(0)" class="comment-delete">delete</a>\n</p>\n\n<div data-comment-edit-form></div>\n'}),define("app/model/library/journal",["app"],function(e){return e.Model.Journal=e.Backbone.RelationalModel.extend({urlRoot:e.config.api_root+"/library/journals",defaults:{title:null,short_title:null,url:null},schema:{}})}),define("app/model/library/author",["app"],function(e){return e.Model.Author=e.Backbone.RelationalModel.extend({urlRoot:e.config.api_root+"/library/authors",defaults:{first_name:null,last_name:null},schema:{}})}),define("app/model/library/paper",["app","app/model/library/journal","app/model/library/author"],function(e){return e.Model.Paper=e.Backbone.RelationalModel.extend({urlRoot:e.config.api_root+"/library/papers",defaults:{di_doi:null,di_pmi:null,di_arx:null,di_pii:null,di_oth:null,title:null,url:null},relations:[{type:e.Backbone.HasOne,key:"journal",relatedModel:e.Model.Journal,includeInJSON:"link"},{type:e.Backbone.HasMany,key:"authors",relatedModel:e.Model.Author,includeInJSON:"link"}],schema:{title:{type:"Text",validators:["required"]},url:{type:"Text",validators:["required"]}}}),e.Model.Paper.prototype.toString=function(){return this.get("title")},e.Model.Paper}),define("app/model/user/user-lib-paper",["app","app/model/library/paper"],function(e){return e.Model.UserLibPaper=e.Backbone.RelationalModel.extend({urlRoot:e.config.api_root+"/user/user-lib-papers",defaults:{date_created:null,authored:!1},relations:[{type:e.Backbone.HasOne,key:"paper",relatedModel:e.Model.Paper,includeInJSON:"link",autoFetch:!0}],schema:{}})}),define("app/model/user/user-lib",["app","app/model/user/user-lib-paper"],function(e){return e.Model.UserLib=e.Backbone.RelationalModel.extend({urlRoot:e.config.api_root+"/user/user-libs",defaults:{},relations:[{type:e.Backbone.HasMany,key:"user_lib_papers",relatedModel:e.Model.UserLibPaper,includeInJSON:"link",autoFetch:!0,reverseRelation:{key:"userlib",includeInJSON:"link"}}],schema:{}})}),define("app/model/user/user",["app","app/model/user/user-lib"],function(e){return e.Model.User=e.Backbone.RelationalModel.extend({urlRoot:e.config.api_root+"/user/users",defaults:{email:null,first_name:null,last_name:null,photo_url:null},relations:[{type:e.Backbone.HasOne,key:"user_lib",relatedModel:e.Model.UserLib,includeInJSON:"link",autoFetch:!1,reverseRelation:{key:"user",type:e.Backbone.HasOne,includeInJson:"link"}}],schema:{email:{type:"Text",validators:["required"]},first_name:{type:"Text",validators:["required"]},last_name:{type:"Text",validators:["required"]}}}),e.Model.User.getCurrent=function(){var t=e.Model.User.find(21);return t||(t=new e.Model.User({id:21}),t.fetch()),t},e.Model.User}),define("app/model/thread/comment",["app","app/model/user/user"],function(e){return e.Model.Comment=e.Backbone.RelationalModel.extend({urlRoot:e.config.api_root+"/thread/comments",defaults:{position:null,content:null,created:null,modified:null},relations:[{type:e.Backbone.HasOne,key:"user",relatedModel:e.Model.User,includeInJSON:"link"}]}),e.Model.Comment.createNew=function(){return new e.Model.Comment({author:e.Model.User.getCurrent()})},e.Model.Comment}),define("app/view/thread/comment/form",["app","app/model/thread/comment"],function(e){return e.View.Thread.CommentForm=e.Backbone.Form.extend({schema:{content:{type:"TextArea",validators:["required"],title:"Your comment"}},template:_.template('            <form class="thread-comment-form form-horizontal" role="form">                <button type="submit" class="btn btn-primary thread-comment-form-submit">                    <span class="eai eai-tick"></span>                </button>                <button type="button" class="btn btn-primary thread-comment-form-cancel">                    <span class="eai eai-remove"></span>                </button>                <div data-fieldsets></div>            </form>        '),events:{"click .thread-comment-form-submit":"onSubmit","click .thread-comment-form-cancel":"onCancel"},initialize:function(){e.Backbone.Form.prototype.initialize.apply(this,arguments),this.listenTo(this,"submit",this.onSubmit)},onSubmit:function(t){t.preventDefault(),e.log("CommentFormView::onSubmit");var i=this.commit({validate:!0});return i?(e.log("Errors",i),void this.trigger("validation_failure",this)):void this.trigger("validation_success",this)},onCancel:function(e){e.preventDefault(),this.trigger("cancel",this)}}),e.View.Thread.CommentForm.create=function(t,i){t=t||{},t.model||(t.model=new e.Model.Comment);var n=new e.View.Thread.CommentForm(t);return i&&e.View.create(n,i),n},e.View.Thread.CommentForm}),define("app/view/thread/comment/thumb",["app","text!app/templates/thread/comment/thumb.html","app/model/thread/comment","app/view/user/thumb","app/view/thread/comment/form"],function(e,t){return e.View.Thread.CommentThumb=e.Backbone.View.extend({tagName:"div",className:"thread-comment",template:e.Handlebars.compile(t),events:{"click .comment-edit":"onEditClick","click .comment-delete":"onDeleteClick"},initialize:function(){this.listenTo(this.model,"sync",this.render)},onEditClick:function(t){t.preventDefault();var i=this.$(".comment-content, .comment-info").hide(),n=e.View.Thread.CommentForm.create({model:this.model},{$target:this.$("[data-comment-edit-form]")});this.listenToOnce(n,"validation_success",function(){n.model.save()}),this.listenToOnce(n,"cancel",function(){n.$el.replaceWith("<div data-comment-edit-form></div>"),n.remove(),i.show()})},onDeleteClick:function(e){if(e.preventDefault(),confirm("Are you sure you want to delete your comment ?")){var t=this;this.model.destroy({success:function(){t.remove()}})}},render:function(){return e.log("CommentThumbView::render"),this.$el.html(this.template(this.model.attributes)),e.View.User.Thumb.create({model:this.model.get("user")},{$target:this.$("[data-user-thumb]")}),this}}),e.View.Thread.CommentThumb.create=function(t,i){if(t=t||{},!t.model)throw"options.model is expected to be an instance of App.Model.Comment";t.id||(t.id="thread-comment-"+t.model.get("id"));var n=new e.View.Thread.CommentThumb(t);return i&&e.View.create(n,i),n},e.View.Thread.CommentThumb}),define("app/view/thread/comment/list",["app","text!app/templates/thread/comment/list.html","app/view/thread/comment/thumb","app/view/thread/comment/form"],function(e,t){return e.View.Thread.CommentList=e.Backbone.View.extend({tagName:"div",className:"thread-comments",template:e.Handlebars.compile(t),post:null,events:{"click .tread-comment-add":"onAddCommentClick"},initialize:function(e){if(!e.post)throw"Expected instance of App.Model.Post";this.post=e.post,this.listenTo(this.model,"sync",this.render)},onAddCommentClick:function(t){t.preventDefault();var i=this,n=this.$(".tread-comment-add").hide(),s=e.View.Thread.CommentForm.create({},{$target:this.$("[data-comment-add-form]")}),r=function(){s.$el.replaceWith("<div data-comment-add-form></div>"),s.remove(),n.show()};this.listenToOnce(s,"cancel",r),this.listenToOnce(s,"validation_success",function(){s.model.save({user:e.Model.User.getCurrent(),post:i.post},{success:r})})},render:function(){e.log("CommentListView::render"),this.$el.html(this.template());var t=this.$(".thread-comments-list");return this.model.each(function(i){e.View.Thread.CommentThumb.create({model:i},{$target:t,append:!0})}),this}}),e.View.Thread.CommentList.create=function(t,i){if(t=t||{},!t.post)throw"options.post is expected to be an instace of App.Model.Post";t.model=t.post.get("comments");var n=new e.View.Thread.CommentList(t);return i&&e.View.create(n,i),n},e.View.Thread.CommentList}),define("app/collection/thread/comment",["app","app/model/thread/comment"],function(e){return e.Collection.Comments=e.Backbone.Collection.extend({url:e.config.api_root+"/thread/comments",model:e.Model.Comment,initialize:function(e){}})}),define("app/model/thread/post",["app","app/model/user/user","app/collection/thread/comment"],function(e){return e.Model.Post=e.Backbone.RelationalModel.extend({urlRoot:e.config.api_root+"/thread/posts",defaults:{position:null,content:null,created:null,modified:null},relations:[{type:e.Backbone.HasOne,key:"user",relatedModel:e.Model.User,includeInJSON:"link"},{type:e.Backbone.HasMany,key:"comments",relatedModel:e.Model.Comment,collectionType:e.Collection.Comments,includeInJSON:!1,reverseRelation:{key:"post",type:e.Backbone.HasOne,includeInJSON:"link"}}]}),e.Model.Post.createNew=function(t){if(!t)throw"thread argument is mandatory";return new e.Model.Post({thread:t,user:e.Model.User.getCurrent()})},e.Model.Post}),define("app/view/thread/post/form",["underscore","app","app/model/thread/post"],function(e,t){return t.View.Thread.PostForm=t.Backbone.Form.extend({schema:{content:{type:"Tinymce",validators:["required"],title:!1}},template:e.template('            <form class="thread-post-form form-horizontal" role="form">                <div data-fieldsets></div>                <button type="submit" class="btn btn-primary thread-post-form-submit">                    Post                </button>            </form>        '),events:{"click .thread-post-form-submit":"onSubmit","click .thread-post-form-cancel":"onCancel"},initialize:function(){t.Backbone.Form.prototype.initialize.apply(this,arguments),0<this.model.get("id")&&(this.template=e.template('                    <form class="thread-post-form form-horizontal" role="form">                        <div data-fieldsets></div>                        <button type="submit" class="btn btn-primary thread-post-form-submit">                            OK                        </button>                        <button type="button" class="btn btn-default thread-post-form-cancel">                            Cancel                        </button>                    </form>                ')),this.listenTo(this,"submit",this.onSubmit)},onSubmit:function(e){e.preventDefault();var i=this.commit({validate:!0});return i?(t.log("Errors",i),void this.trigger("validation_failure",this)):void this.trigger("validation_success",this)},onCancel:function(e){e.preventDefault(),this.trigger("cancel",this)}}),t.View.Thread.PostForm.create=function(e,i){e=e||{},e.model||(e.model=new t.Model.Post);var n=new t.View.Thread.PostForm(e);return i&&t.View.create(n,i),n},t.View.Thread.PostForm}),define("app/view/thread/post/thumb",["app","text!app/templates/thread/post/thumb.html","app/view/user/thumb","app/view/thread/comment/list","app/view/thread/post/form"],function(e,t){return e.View.Thread.PostThumb=e.Backbone.View.extend({tagName:"div",className:"thread-post",template:e.Handlebars.compile(t),events:{"click .post-edit":"onEditClick","click .post-delete":"onDeleteClick"},initialize:function(){this.listenTo(this.model,"sync",this.render)},onEditClick:function(t){t.preventDefault();var i=this.$(".post-content, .post-info").hide(),n=e.View.Thread.PostForm.create({model:this.model},{$target:this.$("[data-post-edit-form]")});this.listenToOnce(n,"validation_success",function(){n.model.save({success:function(){console.log("removing form")}})}),this.listenToOnce(n,"cancel",function(){n.$el.replaceWith("<div data-post-edit-form></div>"),n.remove(),i.show()})},onDeleteClick:function(e){if(e.preventDefault(),confirm("Are you sure you want to delete your post ?")){var t=this;this.model.destroy({success:function(){t.remove()}})}},render:function(){return e.log("PostThumbView::render"),this.$el.html(this.template(this.model.attributes)),e.View.User.Thumb.create({model:this.model.get("user")},{$target:this.$("[data-user-thumb]")}),e.View.Thread.CommentList.create({post:this.model},{$target:this.$("[data-comment-list]")}),this}}),e.View.Thread.PostThumb.create=function(t,i){if(t=t||{},!t.model)throw"options.model is expected to be instance of App.Model.Post";t.id||(t.id="thread-post-"+t.model.get("id"));var n=new e.View.Thread.PostThumb(t);return i&&e.View.create(n,i),n},e.View.Thread.PostThumb}),define("app/view/thread/post/list",["app","text!app/templates/thread/post/list.html","app/view/thread/post/thumb","app/view/thread/post/form"],function(e,t){return e.View.Thread.PostList=e.Backbone.View.extend({tagName:"div",className:"thread-posts",template:e.Handlebars.compile(t),thread:null,form:null,initialize:function(e){if(!e.thread)throw"Expected instance of App.Model.Thread";this.thread=e.thread,this.listenTo(this.model,"sync",this.render)},renderForm:function(){this.form&&this.form.remove(),this.form=e.View.Thread.PostForm.create({},{$target:this.$("[data-post-add-form]")}),this.listenToOnce(this.form,"validation_success",this.submitForm)},submitForm:function(){var t=this;this.form.model.save({user:e.Model.User.getCurrent(),thread:this.thread},{success:function(){t.renderForm()}})},render:function(){e.log("PostListView::render"),this.$el.html(this.template());var t=this.$(".thread-posts-list");return this.model.each(function(i){e.View.Thread.PostThumb.create({model:i},{$target:t,append:!0})}),e.View.User.Thumb.create({model:e.Model.User.getCurrent()},{$target:this.$(".user-placeholder")}),this.renderForm(),this}}),e.View.Thread.PostList.create=function(t,i){if(t=t||{},!t.thread)throw"options.thread is expected to be instance of App.Model.Thread";t.model=t.thread.get("posts");var n=new e.View.Thread.PostList(t);return i&&e.View.create(n,i),n},e.View.Thread.PostList}),define("app/view/thread/form-edit",["underscore","app","app/model/thread/post"],function(e,t){return t.View.Thread.EditForm=t.Backbone.Form.extend({schema:{content:{type:"Tinymce",validators:["required"],title:!1,settings:{height:400}}},template:e.template('            <form class="thread-create-form form-horizontal" role="form">                <div data-fieldsets></div>                <div class="form-footer">                    <button type="submit" class="btn btn-primary form-submit">                        Update                    </button>                    <button type="button" class="btn btn-default form-cancel">                        Cancel                    </button>                </div>            </form>        '),events:{"click .form-submit":"onSubmit","click .form-cancel":"onCancel"},initialize:function(){t.Backbone.Form.prototype.initialize.apply(this,arguments),this.listenTo(this,"submit",this.onSubmit)},onSubmit:function(e){e.preventDefault();var i=this.commit({validate:!0});return i?(t.log("Errors",i),void this.trigger("validation_failure",this)):void this.trigger("validation_success",this)},onCancel:function(e){e.preventDefault(),this.trigger("cancel",this)}}),t.View.Thread.EditForm.create=function(e,i){if(e=e||{},!e.model)throw"Expected options.model instance of App.Model.Thread";var n=new t.View.Thread.EditForm(e);return i&&t.View.create(n,i),n},t.View.Thread.EditForm}),define("app/view/thread/detail",["app","text!app/templates/thread/detail.html","app/view/user/thumb","app/view/user/list","app/view/thread/post/list","app/view/thread/form-edit"],function(e,t){return e.View.Thread=e.View.Thread||{},e.View.Thread.Detail=e.Backbone.View.extend({tagName:"div",className:"inner",template:e.Handlebars.compile(t),events:{"click .thread-edit":"onEditClick"},initialize:function(){this.listenTo(this.model,"sync",this.render)},onEditClick:function(t){t.preventDefault();var i=this.$(".thread-content, .thread-info").hide(),n=e.View.Thread.EditForm.create({model:this.model},{$target:this.$("[data-thread-edit-form]")});this.listenToOnce(n,"validation_success",function(){n.model.save()}),this.listenToOnce(n,"cancel",function(){n.$el.replaceWith("<div data-thread-edit-form></div>"),n.remove(),i.show()})},render:function(){return e.log("ThreadDetailView::render"),this.$el.html(this.template(this.model.attributes)),e.View.User.Thumb.create({model:this.model.get("user")},{$target:this.$("[data-user-placeholder]")}),e.View.User.List.create({model:this.model.get("members")},{$target:this.$("[data-members-placeholder]")}),e.View.Thread.PostList.create({thread:this.model},{$target:this.$("[data-posts-placeholder]")}),this}})}),define("text!app/templates/thread/thumb.html",[],function(){return'<div class="actions">\n    <a href="javascript: void(0)" class="thumb-pin{{thread_pin_class}}" title="Pin/Unpin">\n        <span class="eai eai-pin"></span>\n    </a>\n    <a href="javascript: void(0)" class="thumb-ban{{thread_ban_class}}" title="Remove from my threads">\n        <span class="eai eai-remove"></span>\n    </a>\n</div>\n<div class="card">\n    <div data-user-placeholder></div>\n    <p class="title">\n        <a href="javascript: void(0)">\n            <span>new</span>\n            {{title}}\n        </a>\n    </p>\n    <div class="infos">\n        <p class="truncate">\n            {{paper_title_authors paper}}\n            <em>{{date created}}</em>\n        </p>\n        <p class="icons">\n            <span class="comment">\n                <span class="count">16</span>\n                <span class="eai eai-comment"></span>\n            </span>\n            <span class="member">\n                <span class="count">16</span>\n                <span class="eai eai-user"></span>\n            </span>\n        </p>\n    </div>\n</div>\n'}),define("app/view/thread/thumb",["app","text!app/templates/thread/thumb.html","app/view/user/thumb"],function(e,t){return e.View.Thread=e.View.Thread||{},e.View.Thread.Thumb=e.Backbone.View.extend({tagName:"div",className:"thumb",template:e.Handlebars.compile(t),list:null,events:{"click .title a":"onTitleClick","click .thumb-pin":"onPinClick","click .thumb-ban":"onBanClick"},initialize:function(e){if(!e.list)throw'"options.list" is mandatory.';this.list=e.list,this.listenTo(this.model,"change:state",this.onThreadStateChange),this.listenTo(this.model,"sync change",this.render)},onTitleClick:function(e){e.preventDefault(),this.list.trigger("model:detail",this.model,this)},onThreadStateChange:function(t,i){t.get("watch")===e.Model.State.WATCH_BANNED?this.list.trigger("model:remove",i):this.render()},onPinClick:function(e){e.preventDefault(),this.model.getState().togglePinned().save()},onBanClick:function(t){t.preventDefault();var i=this.model;i.getState().toggleBanned().save().then(function(){i.get("state").get("watch")==e.Model.State.WATCH_BANNED})},render:function(){return e.log("ThreadThumbView::render"),this.$el.html(this.template(this.model.attributes)),e.View.User.Thumb.create({model:this.model.get("user")},{$target:this.$("[data-user-placeholder]")}),this}})}),define("app/model/thread/state",["app","app/model/user/user","app/model/user/user-lib","app/model/library/paper"],function(e){return e.Model.State=e.Backbone.RelationalModel.extend({urlRoot:e.config.api_root+"/thread/states",defaults:{watch:null,participate:null},relations:[{type:e.Backbone.HasOne,key:"user",relatedModel:e.Model.User,includeInJSON:"link"}],initialize:function(){this.listenTo(this,"change",this.onChange)},onChange:function(){var e=this.get("thread");e&&e.trigger("change:state",this,e)},togglePinned:function(){var t=this.get("watch");if(null===t)t=e.Model.State.WATCH_PINNED;else{if(t!==e.Model.State.WATCH_PINNED)throw"Unexpected watch state.";t=null}return this.set({watch:t}),this},toggleBanned:function(){var t=this.get("watch");if(null===t)t=e.Model.State.WATCH_BANNED;else{if(t!==e.Model.State.WATCH_BANNED)throw"Unexpected watch state.";t=null}return this.set({watch:t}),this}}),e.Model.State.WATCH_PINNED=1,e.Model.State.WATCH_BANNED=2,e.Model.State.PARTICIPATE_LEFT=1,e.Model.State.PARTICIPATE_JOINED=2,e.Model.State}),define("app/collection/thread/post",["app","app/model/thread/post"],function(e){return e.Collection.Posts=e.Backbone.Collection.extend({url:e.config.api_root+"/thread/posts",model:e.Model.Post,initialize:function(e){}})}),define("app/collection/user/user",["app","app/model/user/user"],function(e){return e.Collection.Users=e.Backbone.PageableCollection.extend({url:e.config.api_root+"/user/user",model:e.Model.User,initialize:function(){}})}),define("app/model/thread/thread",["app","app/model/user/user","app/model/thread/state","app/collection/thread/post","app/collection/user/user"],function(e){return e.Model.Thread=e.Backbone.RelationalModel.extend({urlRoot:e.config.api_root+"/thread/threads",defaults:{link:null,type:2,privacy:1,title:null,content:null,state:null,created:null,modified:null},relations:[{type:e.Backbone.HasOne,key:"user",relatedModel:e.Model.User,includeInJSON:"link"},{type:e.Backbone.HasOne,key:"paper",relatedModel:e.Model.Paper,includeInJSON:"link"},{type:e.Backbone.HasOne,key:"state",relatedModel:e.Model.State,includeInJSON:!1,reverseRelation:{key:"thread",type:e.Backbone.HasOne,includeInJSON:"link"}},{type:e.Backbone.HasMany,key:"posts",relatedModel:e.Model.Post,collectionType:e.Collection.Posts,includeInJSON:!1,reverseRelation:{key:"thread",type:e.Backbone.HasOne,includeInJSON:"link"}},{type:e.Backbone.HasMany,key:"members",relatedModel:e.Model.User,collectionType:e.Collection.Users,includeInJSON:!1}],getState:function(){var t=this.get("state");return t||(t=new e.Model.State({user:e.Model.User.getCurrent(),thread:this}),this.set({state:t})),t}}),e.Model.Thread.createNew=function(){return new e.Model.Thread({user:e.Model.User.getCurrent()})},e.Model.Thread}),define("app/collection/thread/thread",["app","app/model/thread/thread"],function(e){var t={query:{view:"nested"}};return e.Collection.Threads=e.Backbone.PageableCollection.extend({url:e.config.api_root+"/thread/threads",mode:"infinite",model:e.Model.Thread,initialize:function(i){e.defaults(i,t),this.queryParams=i.query}})}),define("app/view/thread/list",["app","text!app/templates/thread/list.html","app/view/detail","app/view/thread/detail","app/view/thread/thumb","app/collection/thread/thread"],function(e,t){var i={query:{view:"nested"}};return e.View.Thread=e.View.Thread||{},e.View.Thread.List=e.Backbone.View.extend({template:e.Handlebars.compile(t),detailView:null,$thumbList:null,events:{"click #thread-next-page":"onNextPageClick"},initialize:function(t){e.defaults(t,i),this.collection=new e.Collection.Threads({query:t.query}),this.listenTo(this.collection.fullCollection,"reset",this.onCollectionReset),this.listenTo(this.collection.fullCollection,"add",this.onCollectionAdd),this.listenTo(this.collection.fullCollection,"remove",this.onCollectionRemove),this.listenTo(this,"model:remove",this.onModelRemove),this.listenTo(this,"model:detail",this.openDetail)},openDetail:function(t){e.log("ThreadListView::onModelDetail");var i=new e.Model.Detail({list:this,view:new e.View.Thread.Detail({model:t})});this.detailView?this.detailView.model=i:this.detailView=new e.View.Detail({model:i}),this.detailView.render()},onModelRemove:function(t){e.log("ThreadListView::onModelRemove"),this.collection.remove(t),this.collection.fullCollection.remove(t)},onCollectionAdd:function(t){e.log("ThreadListView::onCollectionAdd");var i=new e.View.Thread.Thumb({id:"thread-thumb-"+t.get("id"),model:t,list:this});i.render().$el.appendTo(this.$thumbList)},onCollectionRemove:function(t){e.log("ThreadListView::onCollectionRemove"),this.$("#thread-thumb-"+t.get("id")).remove()},onCollectionReset:function(){0==this.collection.fullCollection.length&&this.render()},onNextPageClick:function(){this.collection.getNextPage(null)},render:function(){return e.log("ThreadListView::render"),this.$el.html(this.template({})),this.$thumbList=this.$(".thumb-list"),this}})}),define("app/collection/library/paper",["app","app/model/library/paper"],function(e){return e.Collection.Papers=e.Backbone.Collection.extend({url:e.config.api_root+"/library/papers",model:e.Model.Paper})}),define("app/view/thread/form-create",["underscore","app","app/collection/library/paper","app/model/thread/post"],function(e,t){return t.View.Thread.CreateForm=t.Backbone.Form.extend({schema:{title:{type:"Text",validators:["required"]},paper:{type:"Select",options:function(e){var i=t.Model.User.getCurrent(),n=new t.Collection.Papers;n.url=t.config.api_root+"/user/user-libs/"+i.get("id")+"/papers",n.fetch().then(function(){e(n)},function(e,t,i){throw t+" "+i})},validators:["required"]}},template:e.template('            <form class="thread-create-form form-horizontal" role="form">                <div data-fieldsets></div>                <div class="form-group form-footer">                    <div class="col-sm-offset-2 col-sm-10">                        <button type="submit" class="btn btn-primary form-submit">                            Create                        </button>                        <button type="button" class="btn btn-default form-cancel">                            Cancel                        </button>                    </div>                </div>            </form>        '),events:{"click .form-submit":"_onSubmit","click .form-cancel":"_onCancel"},initialize:function(){t.Backbone.Form.prototype.initialize.apply(this,arguments),this.listenTo(this,"submit",this._onSubmit)},_onSubmit:function(e){e.preventDefault();var i=this.commit({validate:!0});return i?(t.log("Errors",i),void this.trigger("validation_failure",this)):void this.trigger("validation_success",this)},_onCancel:function(e){e.preventDefault(),this.trigger("cancel",this)}}),t.View.Thread.CreateForm.create=function(e,i){e=e||{},e.model||(e.model=t.Model.Thread.createNew());var n=new t.View.Thread.CreateForm(e);return i&&t.View.create(n,i),n},t.View.Thread.CreateForm}),define("app/thread/list",["jquery","app","app/view/modal","app/view/thread/list","app/view/thread/form-create","bootstrap"],function(e,t){var i=new t.View.Thread.List({el:"#thread-list-container"});i.render(),i.collection.fetch();var n,s;e("#thread-create-modal").on("click",function(){n=t.View.Thread.CreateForm.create(),s=new t.View.Modal({title:"Start a new thread",content:n,footer:!1}),n.once("validation_success",function(){n.model.save(null,{success:function(){i.collection.add(n.model),s.close(),i.openDetail(n.model)},error:function(){}})}),n.once("cancel",function(){s.close()}),s.once("hidden",function(){n=null,s=null}),s.render()})});