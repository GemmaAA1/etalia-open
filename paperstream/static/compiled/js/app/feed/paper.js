define("app/api",["jquery"],function(t){var e,n={debug:!1};n.log=function(){this.debug&&console.log("[API] "+arguments[0],Array.prototype.splice.call(arguments,1))};var i=function(t,e){this.id=t,this.states=e.hasOwnProperty("state")?e.state:[],this.counts=e.hasOwnProperty("counter")?e.counter:[],this.hasState=function(t){return this.states.hasOwnProperty(t)},this.getState=function(t){if(this.hasState(t))return this.states[t];throw'Undefined state "'+t+'"'},this.hasCount=function(t){return this.counts.hasOwnProperty(t)},this.getCount=function(t){if(this.hasCount(t))return this.counts[t];throw'Undefined count "'+t+'"'}};return i.prototype.getId=function(){return this.id},i.prototype.isPinned=function(){return this.getState("is_pinned")},i.prototype.isBanned=function(){return this.getState("is_banned")},i.prototype.isTrashed=function(){return this.getState("is_trashed")},i.prototype.isAdded=function(){return this.getState("is_added")},i.prototype.getPinCount=function(){return this.getCount("pin")},i.prototype.getBanCount=function(){return this.getCount("ban")},i.prototype.getTrashCount=function(){return this.getCount("trash")},i.prototype.getLibraryCount=function(){return this.getCount("library")},n.pin=function(o,a){return a=a||window.location.pathname,t.ajax({type:"POST",url:"/user/paper/pin",data:{id:o,source:a}}).done(function(t){n.log("pin success",t),e.trigger("etalia.publication.pin",new i(o,t))}).fail(function(t,e,i){n.log("pin failure",t,e,i)}),this},n.ban=function(o,a){return a=a||window.location.pathname,t.ajax({type:"POST",url:"/user/paper/ban",data:{id:o,source:a}}).done(function(t){n.log("ban success",t),e.trigger("etalia.publication.ban",new i(o,t))}).fail(function(t,e,i){n.log("ban failure",t,e,i)}),this},n.add=function(o,a){return t.ajax({type:"POST",url:"/user/paper/add",data:{id:o}}).done(function(t){return t.hasOwnProperty("success")&&!t.success?(a&&a(),void n.log("add failure",t)):(n.log("add success",t),void e.trigger("etalia.publication.add",new i(o,t)))}).fail(function(t,e,i){a&&a(),n.log("add failure",t,e,i)}),this},n.trash=function(o,a){return t.ajax({type:"POST",url:"/user/paper/trash",data:{id:o}}).done(function(t){return t.hasOwnProperty("success")&&!t.success?(a&&a(),void n.log("trash failure",t)):(n.log("trash success",t),void e.trigger("etalia.publication.trash",new i(o,t)))}).fail(function(t,e,i){a&&a(),n.log("trash failure",t,e,i)}),this},n.restore=function(o,a){return t.ajax({type:"POST",url:"/user/paper/restore",data:{id:o}}).done(function(t){return t.hasOwnProperty("success")&&!t.success?(a&&a(),void n.log("restore failure",t)):(n.log("restore success",t),void e.trigger("etalia.publication.restore",new i(o,t)))}).fail(function(t,e,i){a&&a(),n.log("restore failure",t,e,i)}),this},n.clearTrash=function(){return t.ajax({type:"POST",url:"/user/library/trash/empty"}).done(function(t){n.log("clear trash success",t),e.trigger("etalia.publication.trash-clear",new i(void 0,t))}).fail(function(t,e,i){n.log("clear trash failure",t,e,i)}),this},t(function(){e=t("body")}),n}),define("app/util/utils",["jquery"],function(t){function e(t){var e=null;if(document.cookie&&""!=document.cookie)for(var n=document.cookie.split(";"),i=0;i<n.length;i++){var o=jQuery.trim(n[i]);if(o.substring(0,t.length+1)==t+"="){e=decodeURIComponent(o.substring(t.length+1));break}}return e}function n(t){return/^(GET|HEAD|OPTIONS|TRACE)$/.test(t)}var i=e("csrftoken");return t.ajaxSetup({beforeSend:function(t,e){n(e.type)||this.crossDomain||t.setRequestHeader("X-CSRFToken",i)}}),{toggleClass:function(t,e,n){return"undefined"!=typeof n?(n?t.addClass(e):t.removeClass(e),n):t.hasClass(e)?(t.removeClass(e),!1):(t.addClass(e),!0)},getParameterByName:function(t,e){e||(e=window.location.href),t=t.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)"),i=n.exec(e);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null},bindLoadingButtons:function(e){e.on("click",".loading-button",function(e){var n=t(e.target).closest(".loading-button");return n.data("busy")?(e.stopPropagation(),void e.stopImmediatePropagation()):(n.data("busy",!0),void n.find(".eai").removeAttr("class").addClass("eai eai-loading"))})},restoreLoadingButton:function(t,e){t.data("busy",!1),t.find(".eai").removeAttr("class").addClass("eai "+e)},popup:function(t,e,n,i){e=e||"etalia-popup",n=n||520,i=i||460;var o=Math.round(window.innerWidth/2-n/2),a=Math.round(window.innerHeight/2-i/2),r="menubar=no,toolbar=no,resizable=yes,scrollbars=yes,width="+n+",height="+i+",top="+a+",left="+o;return console.log(r),window.open(t,e,r)}}}),define("app/ui/control/search",["jquery","app/util/utils"],function(t,e){var n=function(e){this.config=t.extend({debug:!1,element:"#search",toggle:"#toggle-search",close:"#close-search",input:"#search-input"},e),this.$element=t(this.config.element),this.$toggle=this.$element.find(this.config.toggle),this.$close=this.$element.find(this.config.close),this.$input=this.$element.find(this.config.input),this.keyUpTimeout=null};return n.prototype.init=function(){var n=this,i=t("body");return this.$toggle.on("click",function(t){return e.toggleClass($search,"opened"),t.preventDefault(),!1}),this.$close.on("click",function(t){return e.toggleClass($search,"opened"),t.preventDefault(),!1}),this.$input.on("focus",function(e){e.stopPropagation(),t(e.delegateTarget).parents("form").addClass("active")}).on("blur",function(e){e.stopPropagation(),t(e.delegateTarget).parents("form").removeClass("active")}).on("keyup",function(t){n.keyUpTimeout&&clearTimeout(n.keyUpTimeout);var e=t.keyCode||t.which;13==e?i.trigger("etalia.control.search.change",{expression:n.getValue()}):n.keyUpTimeout=setTimeout(function(){i.trigger("etalia.control.search.change",{expression:n.getValue()})},1e3)}),this},n.prototype.setValue=function(t){return this.$input.val(t),this},n.prototype.getValue=function(){return this.$input.val()},n}),define("app/ui/control/timespan",["jquery","app/util/utils"],function(t,e){var n={7:{icon:"W",label:"Week"},30:{icon:"1m",label:"1 month"},60:{icon:"2m",label:"2 months"}},i=function(e){this.config=t.extend({debug:!1,element:"#timespan",toggle:"#toggle-timespan",selection:"#timespan-selection"},e),this.$element=t(this.config.element),this.$toggle=t(this.config.toggle),this.$selection=t(this.config.selection)};return i.prototype.init=function(){var n=this,i=t("body");return this.$toggle.on("click",function(t){return e.toggleClass(n.$element,"opened"),t.preventDefault(),!1}),t(window).on("click",function(e){0==t(e.target).closest(n.config.element).length&&n.$element.removeClass("opened")}),this.$element.on("click",".choices a",function(e){var o=t(e.target).closest("a").data("timespan");return n.setValue(o),n.$toggle.trigger("click"),i.trigger("etalia.control.timespan.change",{value:o,label:n.getValueLabel(o)}),e.preventDefault(),!1}),this},i.prototype.getValueIcon=function(t){if(n.hasOwnProperty(t))return n[t].icon;throw"Unexpected timespan value"},i.prototype.getValueLabel=function(t){if(n.hasOwnProperty(t))return n[t].label;throw"Unexpected timespan value"},i.prototype.setValue=function(t){return this.$selection.html(this.getValueIcon(t)).data("value",t),this},i.prototype.getValue=function(){return this.$selection.data("value")},i}),define("app/ui/control/cluster",["jquery","app/util/utils"],function(t,e){var n={0:{label:"All"},1:{label:"Purple"},2:{label:"Red"},3:{label:"Orange"},4:{label:"White"}},i=function(e){this.config=t.extend({debug:!1,element:"#cluster",toggle:"#toggle-cluster",selection:"#cluster-selection"},e),this.$element=t(this.config.element),this.$toggle=t(this.config.toggle),this.$selection=t(this.config.selection),this.selected=null};return i.prototype.init=function(){var n=this,i=t("body");return this.$toggle.on("click",function(t){return e.toggleClass(n.$element,"opened"),t.preventDefault(),!1}),t(window).on("click",function(e){0==t(e.target).closest(n.config.element).length&&n.$element.removeClass("opened")}),this.$element.on("click",".choices a",function(e){var o=t(e.target).closest("a").data("cluster");return n.setValue(o),n.$toggle.trigger("click"),i.trigger("etalia.control.timespan.change",{value:o,label:n.getValueColor(o)}),e.preventDefault(),!1}),this},i.prototype.getValueColor=function(t){if(n.hasOwnProperty(t))return n[t].label;throw"Unexpected cluster value"},i.prototype.setValue=function(t){if(t=parseInt(t),this.$selection.removeClass("cluster-"+this.selected),0==t)this.$selection.hide(),this.$toggle.find(".cluster-icon").show();else{if(!(t>0&&4>=t))throw"Unexpected cluster value";this.$selection.css({display:"inline-block"}).addClass("cluster-"+(this.selected-1)),this.$toggle.find(".cluster-icon").hide()}return this.$selection.data("value",t),this.selected=t,this},i.prototype.getValue=function(){return this.$selection.data("value")},i}),define("app/ui/control/pinned",["jquery","app/util/utils"],function(t,e){var n=function(e){this.config=t.extend({debug:!1,element:"#toggle-pinned"},e),this.$element=t(this.config.element)};return n.prototype.init=function(){var n=this,i=t("body");return this.$element.on("click",function(t){var o=e.toggleClass(n.$element,"active");return i.trigger("etalia.control.pinned.change",{active:o}),t.preventDefault(),!1}),this},n.prototype.setValue=function(t){return e.toggleClass(this.$element,"active",t),this},n.prototype.getValue=function(){return this.$element.hasClass("active")},n});var Hogan={};!function(t){function e(t,e,n){var i;return e&&"object"==typeof e&&(void 0!==e[t]?i=e[t]:n&&e.get&&"function"==typeof e.get&&(i=e.get(t))),i}function n(t,e,n,i,o,a){function r(){}function s(){}r.prototype=t,s.prototype=t.subs;var l,u=new r;u.subs=new s,u.subsText={},u.buf="",i=i||{},u.stackSubs=i,u.subsText=a;for(l in e)i[l]||(i[l]=e[l]);for(l in i)u.subs[l]=i[l];o=o||{},u.stackPartials=o;for(l in n)o[l]||(o[l]=n[l]);for(l in o)u.partials[l]=o[l];return u}function i(t){return String(null===t||void 0===t?"":t)}function o(t){return t=i(t),c.test(t)?t.replace(a,"&amp;").replace(r,"&lt;").replace(s,"&gt;").replace(l,"&#39;").replace(u,"&quot;"):t}t.Template=function(t,e,n,i){t=t||{},this.r=t.code||this.r,this.c=n,this.options=i||{},this.text=e||"",this.partials=t.partials||{},this.subs=t.subs||{},this.buf=""},t.Template.prototype={r:function(t,e,n){return""},v:o,t:i,render:function(t,e,n){return this.ri([t],e||{},n)},ri:function(t,e,n){return this.r(t,e,n)},ep:function(t,e){var i=this.partials[t],o=e[i.name];if(i.instance&&i.base==o)return i.instance;if("string"==typeof o){if(!this.c)throw new Error("No compiler available.");o=this.c.compile(o,this.options)}if(!o)return null;if(this.partials[t].base=o,i.subs){e.stackText||(e.stackText={});for(key in i.subs)e.stackText[key]||(e.stackText[key]=void 0!==this.activeSub&&e.stackText[this.activeSub]?e.stackText[this.activeSub]:this.text);o=n(o,i.subs,i.partials,this.stackSubs,this.stackPartials,e.stackText)}return this.partials[t].instance=o,o},rp:function(t,e,n,i){var o=this.ep(t,n);return o?o.ri(e,n,i):""},rs:function(t,e,n){var i=t[t.length-1];if(!h(i))return void n(t,e,this);for(var o=0;o<i.length;o++)t.push(i[o]),n(t,e,this),t.pop()},s:function(t,e,n,i,o,a,r){var s;return h(t)&&0===t.length?!1:("function"==typeof t&&(t=this.ms(t,e,n,i,o,a,r)),s=!!t,!i&&s&&e&&e.push("object"==typeof t?t:e[e.length-1]),s)},d:function(t,n,i,o){var a,r=t.split("."),s=this.f(r[0],n,i,o),l=this.options.modelGet,u=null;if("."===t&&h(n[n.length-2]))s=n[n.length-1];else for(var c=1;c<r.length;c++)a=e(r[c],s,l),void 0!==a?(u=s,s=a):s="";return o&&!s?!1:(o||"function"!=typeof s||(n.push(u),s=this.mv(s,n,i),n.pop()),s)},f:function(t,n,i,o){for(var a=!1,r=null,s=!1,l=this.options.modelGet,u=n.length-1;u>=0;u--)if(r=n[u],a=e(t,r,l),void 0!==a){s=!0;break}return s?(o||"function"!=typeof a||(a=this.mv(a,n,i)),a):o?!1:""},ls:function(t,e,n,o,a){var r=this.options.delimiters;return this.options.delimiters=a,this.b(this.ct(i(t.call(e,o)),e,n)),this.options.delimiters=r,!1},ct:function(t,e,n){if(this.options.disableLambda)throw new Error("Lambda features disabled.");return this.c.compile(t,this.options).render(e,n)},b:function(t){this.buf+=t},fl:function(){var t=this.buf;return this.buf="",t},ms:function(t,e,n,i,o,a,r){var s,l=e[e.length-1],u=t.call(l);return"function"==typeof u?i?!0:(s=this.activeSub&&this.subsText&&this.subsText[this.activeSub]?this.subsText[this.activeSub]:this.text,this.ls(u,l,n,s.substring(o,a),r)):u},mv:function(t,e,n){var o=e[e.length-1],a=t.call(o);return"function"==typeof a?this.ct(i(a.call(o)),o,n):a},sub:function(t,e,n,i){var o=this.subs[t];o&&(this.activeSub=t,o(e,n,this,i),this.activeSub=!1)}};var a=/&/g,r=/</g,s=/>/g,l=/\'/g,u=/\"/g,c=/[&<>\"\']/,h=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}}("undefined"!=typeof exports?exports:Hogan),function(t){function e(t){"}"===t.n.substr(t.n.length-1)&&(t.n=t.n.substring(0,t.n.length-1))}function n(t){return t.trim?t.trim():t.replace(/^\s*|\s*$/g,"")}function i(t,e,n){if(e.charAt(n)!=t.charAt(0))return!1;for(var i=1,o=t.length;o>i;i++)if(e.charAt(n+i)!=t.charAt(i))return!1;return!0}function o(e,n,i,s){var l=[],u=null,c=null,h=null;for(c=i[i.length-1];e.length>0;){if(h=e.shift(),c&&"<"==c.tag&&!(h.tag in k))throw new Error("Illegal content in < super tag.");if(t.tags[h.tag]<=t.tags.$||a(h,s))i.push(h),h.nodes=o(e,h.tag,i,s);else{if("/"==h.tag){if(0===i.length)throw new Error("Closing tag without opener: /"+h.n);if(u=i.pop(),h.n!=u.n&&!r(h.n,u.n,s))throw new Error("Nesting error: "+u.n+" vs. "+h.n);return u.end=h.i,l}"\n"==h.tag&&(h.last=0==e.length||"\n"==e[0].tag)}l.push(h)}if(i.length>0)throw new Error("missing closing tag: "+i.pop().n);return l}function a(t,e){for(var n=0,i=e.length;i>n;n++)if(e[n].o==t.n)return t.tag="#",!0}function r(t,e,n){for(var i=0,o=n.length;o>i;i++)if(n[i].c==t&&n[i].o==e)return!0}function s(t){var e=[];for(var n in t)e.push('"'+u(n)+'": function(c,p,t,i) {'+t[n]+"}");return"{ "+e.join(",")+" }"}function l(t){var e=[];for(var n in t.partials)e.push('"'+u(n)+'":{name:"'+u(t.partials[n].name)+'", '+l(t.partials[n])+"}");return"partials: {"+e.join(",")+"}, subs: "+s(t.subs)}function u(t){return t.replace(m,"\\\\").replace(g,'\\"').replace(b,"\\n").replace(v,"\\r").replace(y,"\\u2028").replace(w,"\\u2029")}function c(t){return~t.indexOf(".")?"d":"f"}function h(t,e){var n="<"+(e.prefix||""),i=n+t.n+$++;return e.partials[i]={name:t.n,partials:{}},e.code+='t.b(t.rp("'+u(i)+'",c,p,"'+(t.indent||"")+'"));',i}function p(t,e){e.code+="t.b(t.t(t."+c(t.n)+'("'+u(t.n)+'",c,p,0)));'}function d(t){return"t.b("+t+");"}var f=/\S/,g=/\"/g,b=/\n/g,v=/\r/g,m=/\\/g,y=/\u2028/,w=/\u2029/;t.tags={"#":1,"^":2,"<":3,$:4,"/":5,"!":6,">":7,"=":8,_v:9,"{":10,"&":11,_t:12},t.scan=function(o,a){function r(){m.length>0&&(y.push({tag:"_t",text:new String(m)}),m="")}function s(){for(var e=!0,n=$;n<y.length;n++)if(e=t.tags[y[n].tag]<t.tags._v||"_t"==y[n].tag&&null===y[n].text.match(f),!e)return!1;return e}function l(t,e){if(r(),t&&s())for(var n,i=$;i<y.length;i++)y[i].text&&((n=y[i+1])&&">"==n.tag&&(n.indent=y[i].text.toString()),y.splice(i,1));else e||y.push({tag:"\n"});w=!1,$=y.length}function u(t,e){var i="="+C,o=t.indexOf(i,e),a=n(t.substring(t.indexOf("=",e)+1,o)).split(" ");return x=a[0],C=a[a.length-1],o+i.length-1}var c=o.length,h=0,p=1,d=2,g=h,b=null,v=null,m="",y=[],w=!1,k=0,$=0,x="{{",C="}}";for(a&&(a=a.split(" "),x=a[0],C=a[1]),k=0;c>k;k++)g==h?i(x,o,k)?(--k,r(),g=p):"\n"==o.charAt(k)?l(w):m+=o.charAt(k):g==p?(k+=x.length-1,v=t.tags[o.charAt(k+1)],b=v?o.charAt(k+1):"_v","="==b?(k=u(o,k),g=h):(v&&k++,g=d),w=k):i(C,o,k)?(y.push({tag:b,n:n(m),otag:x,ctag:C,i:"/"==b?w-x.length:k+C.length}),m="",k+=C.length-1,g=h,"{"==b&&("}}"==C?k++:e(y[y.length-1]))):m+=o.charAt(k);return l(w,!0),y};var k={_t:!0,"\n":!0,$:!0,"/":!0};t.stringify=function(e,n,i){return"{code: function (c,p,i) { "+t.wrapMain(e.code)+" },"+l(e)+"}"};var $=0;t.generate=function(e,n,i){$=0;var o={code:"",subs:{},partials:{}};return t.walk(e,o),i.asString?this.stringify(o,n,i):this.makeTemplate(o,n,i)},t.wrapMain=function(t){return'var t=this;t.b(i=i||"");'+t+"return t.fl();"},t.template=t.Template,t.makeTemplate=function(t,e,n){var i=this.makePartials(t);return i.code=new Function("c","p","i",this.wrapMain(t.code)),new this.template(i,e,this,n)},t.makePartials=function(t){var e,n={subs:{},partials:t.partials,name:t.name};for(e in n.partials)n.partials[e]=this.makePartials(n.partials[e]);for(e in t.subs)n.subs[e]=new Function("c","p","t","i",t.subs[e]);return n},t.codegen={"#":function(e,n){n.code+="if(t.s(t."+c(e.n)+'("'+u(e.n)+'",c,p,1),c,p,0,'+e.i+","+e.end+',"'+e.otag+" "+e.ctag+'")){t.rs(c,p,function(c,p,t){',t.walk(e.nodes,n),n.code+="});c.pop();}"},"^":function(e,n){n.code+="if(!t.s(t."+c(e.n)+'("'+u(e.n)+'",c,p,1),c,p,1,0,0,"")){',t.walk(e.nodes,n),n.code+="};"},">":h,"<":function(e,n){var i={partials:{},code:"",subs:{},inPartial:!0};t.walk(e.nodes,i);var o=n.partials[h(e,n)];o.subs=i.subs,o.partials=i.partials},$:function(e,n){var i={subs:{},code:"",partials:n.partials,prefix:e.n};t.walk(e.nodes,i),n.subs[e.n]=i.code,n.inPartial||(n.code+='t.sub("'+u(e.n)+'",c,p,i);')},"\n":function(t,e){e.code+=d('"\\n"'+(t.last?"":" + i"))},_v:function(t,e){e.code+="t.b(t.v(t."+c(t.n)+'("'+u(t.n)+'",c,p,0)));'},_t:function(t,e){e.code+=d('"'+u(t.text)+'"')},"{":p,"&":p},t.walk=function(e,n){for(var i,o=0,a=e.length;a>o;o++)i=t.codegen[e[o].tag],i&&i(e[o],n);return n},t.parse=function(t,e,n){return n=n||{},o(t,"",[],n.sectionTags||[])},t.cache={},t.cacheKey=function(t,e){return[t,!!e.asString,!!e.disableLambda,e.delimiters,!!e.modelGet].join("||")},t.compile=function(e,n){n=n||{};var i=t.cacheKey(e,n),o=this.cache[i];if(o){var a=o.partials;for(var r in a)delete a[r].instance;return o}return o=this.generate(this.parse(this.scan(e,n.delimiters),e,n),e,n),this.cache[i]=o}}("undefined"!=typeof exports?exports:Hogan),"function"==typeof define&&define.amd&&define("hogan",Hogan),define("app/util/templates",["require","hogan"],function(t){var e=t("hogan"),n={};return n.filters=new e.Template({code:function(t,e,n){var i=this;return i.b(n=n||""),i.s(i.f("groups",t,e,1),t,e,0,11,771,"{{ }}")&&(i.rs(t,e,function(t,e,i){i.b('<div class="filter-group" data-id="'),i.b(i.v(i.f("id",t,e,0))),i.b('">'),i.b("\n"+n),i.b('    <a href="javascript: void(0)" class="filter-toggle">'),i.b("\n"+n),i.b("        "),i.b(i.v(i.f("id",t,e,0))),i.b(' <span class="eai eai-down"></span>'),i.b("\n"+n),i.b("    </a>"),i.b("\n"+n),i.b('    <div class="filter-filters collapse">'),i.b("\n"+n),i.b("        <ul>"),i.b("\n"+n),i.s(i.f("entries",t,e,1),t,e,0,251,621,"{{ }}")&&(i.rs(t,e,function(t,e,i){i.b("            <li>"),i.b("\n"+n),i.b('                <a href="javascript: void(0)" data-id="'),i.b(i.v(i.f("pk",t,e,0))),i.b('" title="'),i.b(i.v(i.f("name",t,e,0))),i.b('"'),i.b("\n"+n),i.b("                    "),i.s(i.f("is_checked",t,e,1),t,e,0,384,400,"{{ }}")&&(i.rs(t,e,function(t,e,n){n.b(' class="active" ')}),t.pop()),i.b(">"),i.b("\n"+n),i.b("                    "),i.s(i.f("count",t,e,1),t,e,0,447,492,"{{ }}")&&(i.rs(t,e,function(t,e,n){n.b('<span class="filter-count">('),n.b(n.v(n.f("count",t,e,0))),n.b(")</span>")}),t.pop()),i.b("\n"+n),i.b('                    <span class="filter-checkbox"></span> '),i.b(i.v(i.f("name",t,e,0))),i.b("\n"+n),i.b("                </a>"),i.b("\n"+n),i.b("            </li>"),i.b("\n"+n)}),t.pop()),i.b("        </ul>"),i.b("\n"+n),i.b('        <a href="javascript: void(0)" class="filter-more">'),i.b("\n"+n),i.b("            More filters&hellip;"),i.b("\n"+n),i.b("        </a>"),i.b("\n"+n),i.b("    </div>"),i.b("\n"+n),i.b("</div>"),i.b("\n"+n)}),t.pop()),i.fl()},partials:{},subs:{}}),n}),define("app/ui/control/filters",["jquery","app/util/templates","app/util/utils"],function(t,e,n){var i={id:[],opened:[],count:[]};i.has=function(t){return 0<=this.id.indexOf(t)},i.add=function(t,e,n){this.has(t)&&this.set(t,e,n),this.id.push(t),this.opened.push(e),this.count.push(n)},i.set=function(t,e,n){this.has(t)||this.add(t,e,n);var i=this.id.indexOf(t);this.opened[i]=e,this.count[i]=n},i.get=function(t){if(!this.has(t))throw'Undefined group "'+t+'"';var e=this.id.indexOf(t);return{opened:this.opened[e],count:this.count[e]}},i.setOpened=function(t,e){if(!this.has(t))throw'Undefined group "'+t+'"';var n=this.id.indexOf(t);this.opened[n]=e},i.getOpened=function(t){if(!this.has(t))throw'Undefined group "'+t+'"';return this.opened[this.id.indexOf(t)]},i.setCount=function(t,e){if(!this.has(t))throw'Undefined group "'+t+'"';var n=this.id.indexOf(t);this.count[n]=e},i.getCount=function(t){if(!this.has(t))throw'Undefined group "'+t+'"';return this.count[this.id.indexOf(t)]};var o=function(e){this.config=t.extend({debug:!1,element:"#filter-flap"},e),this.$element=t(this.config.element),this.$toggle=t(this.config.selection),this.$selection=t(this.config.selection),this.selected=null};return o.prototype.init=function(){var e=this,o=t("body");return this.$element.find(".filter-group").each(function(n,o){var a=t(o),r=a.find(".filter-filters ul a:visible").length;i.add(a.data("id"),a.hasClass("active"),r),e.applyUserSelection(a)}),this.$element.on("click",".filter-toggle",function(e){var o=t(e.target).closest(".filter-group"),a=o.data("id");n.toggleClass(o,"active")?(o.find(".filter-filters").collapse("show"),i.setOpened(a,!0)):(o.find(".filter-filters").collapse("hide"),i.setOpened(a,!1))}).on("click",".filter-group ul a",function(e){var i=t(e.target).closest("a"),a=i.closest(".filter-group"),r=n.toggleClass(i,"active");o.trigger("etalia.control.filters.change",{value:i.data("id"),label:i.attr("title"),group:a.data("id"),active:r})}).on("click",".filter-more",function(n){var o=t(n.target).closest(".filter-group"),a=o.data("id"),r=i.getCount(a);i.setCount(a,r+10),e.applyUserSelection(o)}),this},o.prototype.applyUserSelection=function(t){var e=t.find("ul li"),n=i.get(t.data("id"));return n.opened?t.addClass("active").find(".filter-filters").addClass("in"):t.removeClass("active").find(".filter-filters").removeClass("in"),n.count>=e.length?(e.show(),t.find(".filter-more").hide()):(e.filter(":lt("+n.count+")").show(),e.filter(":gt("+(n.count-1)+")").hide(),t.find(".filter-more").show()),this},o.prototype.render=function(n){var i=this;return this.$element.html(e.filters.render({groups:n})).find(".filter-group").each(function(e,n){i.applyUserSelection(t(n))}),this},o.prototype.setValue=function(){throw"Not implemented"},o.prototype.getValue=function(){var e=[];return this.$element.find(".filter-group").each(function(n,i){var o=t(i),a=[];o.find("li a.active").each(function(){a.push(t(this).data("id"))}),a.length&&e.push({id:o.data("id"),pk:a})}),e},o}),define("app/ui/controls",["jquery","app/ui/control/search","app/ui/control/timespan","app/ui/control/cluster","app/ui/control/pinned","app/ui/control/filters"],function(t,e,n,i,o,a){var r={search:(new e).init(),timespan:(new n).init(),cluster:(new i).init(),pinned:(new o).init(),filters:(new a).init()};return r.getStates=function(){return{time_span:this.timespan.getValue(),cluster:this.cluster.getValue(),pin:this.pinned.getValue(),search_query:this.search.getValue(),filters:this.filters.getValue()}},r.setStates=function(t){return t.hasOwnProperty("cluster")&&this.cluster.setValue(t.cluster||0),t.hasOwnProperty("time_span")&&this.timespan.setValue(t.time_span),t.hasOwnProperty("pin")&&this.pinned.setValue(t.pin),t.hasOwnProperty("search_query")&&this.search.setValue(t.search_query),t.hasOwnProperty("filters")&&this.filters.render(t.filters),this},r}),define("app/ui/list",["jquery","app/api","app/util/utils"],function(t,e,n){var i=function(e){this.config=t.extend({debug:!1,element:"#list",container:".thumb-list"},e),this.$element=t(this.config.element),this.loadXhr=null};return i.prototype.log=function(){return this.config.debug&&console.log("[List] "+arguments[0],Array.prototype.splice.call(arguments,1)),this},i.prototype.init=function(){return this.log("init",this.$element),n.bindLoadingButtons(this.$element),this.$element.on("click",".thumb-pin",function(n){var i=t(n.target).closest(".thumb");return e.pin(i.data("id")),n.preventDefault(),!1}).on("click",".thumb-ban",function(n){var i=t(n.target).closest(".thumb");return e.ban(i.data("id")),n.preventDefault(),!1}).on("click",".thumb-library-add",function(i){var o=t(i.target).closest(".thumb-library-add"),a=t(i.target).closest(".thumb");return e.add(a.data("id"),function(){n.restoreLoadingButton(o,"eai-library-add")}),i.preventDefault(),!1}).on("click",".thumb-library-trash",function(i){var o=t(i.target).closest(".thumb-library-trash"),a=t(i.target).closest(".thumb");return e.trash(a.data("id"),function(){n.restoreLoadingButton(o,"eai-library-trash")}),i.preventDefault(),!1}).on("click",".thumb-library-restore",function(i){var o=t(i.target).closest(".thumb-library-restore"),a=t(i.target).closest(".thumb");return e.restore(a.data("id"),function(){n.restoreLoadingButton(o,"eai-library-add")}),i.preventDefault(),!1}),this},i.prototype.load=function(e){e=e||{},this.loadXhr&&this.loadXhr.abort();var n=this,i=t("body");return n.$element.find(n.config.container).empty().append(t("#busy-modal .sk-cube-grid").clone()),this.loadXhr=t.ajax({method:"GET",url:n.$element.data("load-url"),data:{data:JSON.stringify(e)},dataType:"xml"}).done(function(e){var o={},a=t(e).find("data");a.length&&(o.controlsStates=JSON.parse(a.text()),a.hasOwnProperty("number_of_papers")&&n.$element.find(".list-title span").html(a.number_of_papers));var r=t(e).find("thumb-list");r.length&&n.$element.find(n.config.container).html(t(r.text())),i.trigger("etalia.list.load",o)}).fail(function(t,e,i){n.log("Load failure",t,e,i)}),this.log("load",n.$element.data("load-url")),this},i}),define("app/util/sticky",["jquery"],function(t){var e=function(e){function n(t){r.debug&&console.log("[Sticky] "+t)}function i(){if(d=l.scrollTop(),f=0,n("scrollHandler : "+f+" / "+d),null!==c&&g){f=parseInt(s.css("top"));var t=c-d;f+=t,0>t?(f+h<d+p-r.bottom&&(f=d+p-h-r.bottom),n("scrolling down : "+f)):(f>d+r.top&&(f=d+r.top),n("scrolling up : "+f))}else f<d+r.top&&(f=d+r.top),n("fixed : "+f);c=d,s.css({top:f})}function o(){h=s.outerHeight(),p=l.innerHeight(),n("resizeTimeoutHandler : "+h+" / "+p),g=h>p}function a(){u&&clearTimeout(u),u=setTimeout(o,150)}var r=t.extend({debug:!0,element:null,parent:null,top:0,bottom:0},e),s=t(r.element),l=t(r.parent?r.parent:window),u=null,c=null,h=0,p=0,d=0,f=0,g=!1;this.addHandlers=function(){l.on("scroll",i),t(window).on("resize",a),o(),i()},this.removeHandlers=function(){l.off("scroll",i),t(window).off("resize",a),s.css({position:"absolute",top:"0px"}),c=null},this.enabled=!1};return e.prototype.enable=function(){this.enabled||(this.addHandlers(),this.enabled=!0)},e.prototype.disable=function(){this.enabled&&(this.removeHandlers(),this.enabled=!1)},e}),define("app/ui/paper",["jquery","app/api","app/util/utils","app/ui/controls","app/ui/list","app/util/sticky"],function(t,e,n,i,o,a){function r(t,e){e?(t.removeClass("detail-library-add detail-library-restore").addClass("detail-library-trash"),n.restoreLoadingButton(t,"eai-library-trash")):(t.removeClass("detail-library-trash").addClass("detail-library-restore"),n.restoreLoadingButton(t,"eai-library-add"))}var s=function(e){this.config=t.extend({debug:!1,element:"#detail",document:".document",actions:".inner > .actions",neighbors:".neighbors-thumbs"},e),this.$element=t(this.config.element),this.$document=this.$element.find(this.config.document),this.id=null,this.$actions=null,this.actions=null,this.neighbors=null};return s.prototype.log=function(){this.config.debug&&console.log("[Paper] "+arguments[0],Array.prototype.splice.call(arguments,1))},s.prototype.getId=function(){return this.id},s.prototype.init=function(){this.log("init");var i=this;return t("body").on("etalia.publication.pin",function(t,e){i.id==e.getId()&&i.$actions.find(".detail-pin").toggleClass("active",e.isPinned())}).on("etalia.publication.add",function(t,e){if(i.id==e.getId()&&e.isAdded()){var n=i.$actions.find(".detail-library-add");r(n,!0)}}).on("etalia.publication.trash",function(t,e){if(i.id==e.getId()&&e.isTrashed()){var n=i.$actions.find(".detail-library-trash");r(n,!1)}}).on("etalia.publication.restore",function(t,e){if(i.id==e.getId()&&e.isAdded()){var n=i.$actions.find(".detail-library-restore");r(n,!0)}}),this.$document.on("click",".neighbors-timespan-selector a",function(e){var n=t(e.target).closest("a");return n.closest(".neighbors-timespan-selector").find("li").removeClass("active"),n.closest("li").addClass("active"),i.neighbors&&i.neighbors.load({time_span:n.data("value")}),e.preventDefault(),!1}).on("click",".detail-questions",function(t){var e=i.$document.find(".questions-thumbs").position().top-15;return i.$document.scrollTop(e),t.preventDefault(),!1}).on("click",".detail-neighbors",function(t){var e=i.$document.find(".neighbors-thumbs").position().top-15;return i.$document.scrollTop(e),t.preventDefault(),!1}).on("click",".detail-pin",function(t){if(!i.id)throw"Undefined paper id";return e.pin(i.id),t.preventDefault(),!1}).on("click",".detail-ban",function(t){if(!i.id)throw"Undefined paper id";return e.ban(i.id),t.preventDefault(),!1}).on("click",".detail-library-add:visible",function(o){if(!i.id)throw"Undefined paper id";var a=t(o.target).closest(".detail-library-add");return e.add(i.id,function(){n.restoreLoadingButton(a,"eai-library-add")}),o.preventDefault(),!1}).on("click",".detail-library-trash:visible",function(o){if(!i.id)throw"Undefined paper id";var a=t(o.target).closest(".detail-library-trash");return e.trash(i.id,function(){n.restoreLoadingButton(a,"eai-library-trash")}),o.preventDefault(),!1}).on("click",".detail-library-restore:visible",function(o){if(!i.id)throw"Undefined paper id";var a=t(o.target).closest(".detail-library-restore");return e.restore(i.id,function(){n.restoreLoadingButton(a,"eai-library-add")}),o.preventDefault(),!1}).on("click",".detail-twitter:visible",function(e){var i=t("#detail-actions"),o="https://twitter.com/intent/tweet/?text="+i.data("paper-title")+"&url="+i.data("paper-url")+"&via=etalia";return n.popup(o,"share-popup"),e.preventDefault(),!1}).on("click",".detail-google-plus:visible",function(e){var i=t("#detail-actions"),o="https://plus.google.com/share?url="+i.data("paper-url");return n.popup(o,"share-popup"),e.preventDefault(),!1}),this},s.prototype.update=function(){this.log("update"),this.$actions=this.$element.find(this.config.actions),n.bindLoadingButtons(this.$actions),this.id=parseInt(this.$actions.data("paper-id")),this.actions=new a({debug:this.config.debug,element:this.$actions,parent:this.$document,top:20,bottom:20}),this.actions.enable();var e=t(".neighbors-timespan-selector li.active a").data("value")||30;return this.neighbors=new o({debug:this.config.debug,element:this.config.element+" "+this.config.neighbors}).init().load({time_span:e}),this},s.prototype.clear=function(){this.actions&&(this.actions.disable(),this.actions=null),this.$actions&&(this.$actions=null),this.neighbors=null,this.id&&(this.id=null)},s}),function(t){"function"==typeof define&&define.amd?define("jquery.mousewheel",["jquery"],t):"object"==typeof exports?module.exports=t:t(jQuery)}(function(t){function e(e){var r=e||window.event,s=l.call(arguments,1),u=0,h=0,p=0,d=0,f=0,g=0;if(e=t.event.fix(r),e.type="mousewheel","detail"in r&&(p=-1*r.detail),"wheelDelta"in r&&(p=r.wheelDelta),"wheelDeltaY"in r&&(p=r.wheelDeltaY),"wheelDeltaX"in r&&(h=-1*r.wheelDeltaX),"axis"in r&&r.axis===r.HORIZONTAL_AXIS&&(h=-1*p,p=0),u=0===p?h:p,"deltaY"in r&&(p=-1*r.deltaY,u=p),"deltaX"in r&&(h=r.deltaX,0===p&&(u=-1*h)),0!==p||0!==h){if(1===r.deltaMode){var b=t.data(this,"mousewheel-line-height");u*=b,p*=b,h*=b}else if(2===r.deltaMode){var v=t.data(this,"mousewheel-page-height");u*=v,p*=v,h*=v}if(d=Math.max(Math.abs(p),Math.abs(h)),(!a||a>d)&&(a=d,i(r,d)&&(a/=40)),i(r,d)&&(u/=40,h/=40,p/=40),u=Math[u>=1?"floor":"ceil"](u/a),h=Math[h>=1?"floor":"ceil"](h/a),p=Math[p>=1?"floor":"ceil"](p/a),c.settings.normalizeOffset&&this.getBoundingClientRect){
var m=this.getBoundingClientRect();f=e.clientX-m.left,g=e.clientY-m.top}return e.deltaX=h,e.deltaY=p,e.deltaFactor=a,e.offsetX=f,e.offsetY=g,e.deltaMode=0,s.unshift(e,u,h,p),o&&clearTimeout(o),o=setTimeout(n,200),(t.event.dispatch||t.event.handle).apply(this,s)}}function n(){a=null}function i(t,e){return c.settings.adjustOldDeltas&&"mousewheel"===t.type&&e%120===0}var o,a,r=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],s="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],l=Array.prototype.slice;if(t.event.fixHooks)for(var u=r.length;u;)t.event.fixHooks[r[--u]]=t.event.mouseHooks;var c=t.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var n=s.length;n;)this.addEventListener(s[--n],e,!1);else this.onmousewheel=e;t.data(this,"mousewheel-line-height",c.getLineHeight(this)),t.data(this,"mousewheel-page-height",c.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var n=s.length;n;)this.removeEventListener(s[--n],e,!1);else this.onmousewheel=null;t.removeData(this,"mousewheel-line-height"),t.removeData(this,"mousewheel-page-height")},getLineHeight:function(e){var n=t(e),i=n["offsetParent"in t.fn?"offsetParent":"parent"]();return i.length||(i=t("body")),parseInt(i.css("fontSize"),10)||parseInt(n.css("fontSize"),10)||16},getPageHeight:function(e){return t(e).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};t.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}})}),define("app/ui/layout/flap",["jquery","jquery.mousewheel"],function(t){var e=function(e){e=e||{},this.config=t.extend({debug:!0,flap:null,side:null,button:null,backdrop:null,mobileMaxWidth:992},e),this.$flap=t(this.config.flap),this.$button=t(this.config.button),this.$backdrop=t(this.config.backdrop),this.mobile=null,this.clickHandlersEnabled=!1,this.scrollHandlersEnabled=!1,this.opened=!1,this.scrollTop=0;var n=this;this.log=function(t){n.config.debug&&console.log("[Flap "+this.config.side+"] "+t)},this.buttonClickHandler=function(){n.log("Button click handler"),n.open()},this.backdropClickHandler=function(){n.log("Overlay click handler"),n.close()},this.flapMouseWheelHandler=function(t){return n.log("Window scroll handler"),n.affix(50*t.deltaY),t.preventDefault(),!1},this.backdropMouseWheelHandler=function(t){return t.preventDefault(),!1}};return e.prototype.init=function(){this.log("Flap init");var t=window.innerWidth<this.config.mobileMaxWidth;t!=this.mobile&&(this.close(),this.disableScrollHandlers(),t?this.enableClickHandlers():(this.disableClickHandlers(),this.enableScrollHandlers())),this.mobile=t},e.prototype.enableClickHandlers=function(){this.clickHandlersEnabled||(this.log("enableClickHandlers"),this.$button.on("click",this.buttonClickHandler),this.$backdrop.on("click",this.backdropClickHandler),this.clickHandlersEnabled=!0)},e.prototype.disableClickHandlers=function(){this.clickHandlersEnabled&&(this.log("disableClickHandlers"),this.$button.off("click",this.buttonClickHandler),this.$backdrop.off("click",this.backdropClickHandler),this.clickHandlersEnabled=!1)},e.prototype.enableScrollHandlers=function(){this.scrollHandlersEnabled||(this.log("enableScrollHandlers"),this.$flap.on("mousewheel",this.flapMouseWheelHandler),this.$backdrop.on("mousewheel",this.flapMouseWheelHandler),this.scrollHandlersEnabled=!0)},e.prototype.disableScrollHandlers=function(){this.scrollHandlersEnabled&&(this.log("disableScrollHandlers"),this.$flap.off("mousewheel",this.flapMouseWheelHandler),this.$backdrop.off("mousewheel",this.flapMouseWheelHandler),this.scrollHandlersEnabled=!1)},e.prototype.open=function(){return this.opened?this:(this.opened=!0,t("body").addClass("flap-opened").addClass(this.config.side),this.$flap.css({top:0}),void this.enableScrollHandlers())},e.prototype.close=function(){return this.opened?(t("body").removeClass("flap-opened").removeClass(this.config.side),this.$flap.css({top:0}),this.disableScrollHandlers(),void(this.opened=!1)):this},e.prototype.affix=function(t){var e=parseInt(this.$flap.css("top"))+t,n=window.innerHeight-this.$flap.outerHeight();e>0?e=0:n>e&&(e=n),this.$flap.css({top:e}),this.scrollTop=window.scrollY},e}),define("app/ui/layout/interact",["jquery"],function(t){var e=function(e){this.config=t.extend({debug:!1},e)};return e.prototype.log=function(){return this.config.debug&&console.log("[Interact] "+arguments[0],Array.prototype.splice.call(arguments,1)),this},e.prototype.init=function(){this.log("init()");var t=this,e=0,n=setInterval(function(){return t.log("check ga",e,typeof ga),"function"==typeof ga?(t.initHandlers(),void clearInterval(n)):(e++,void(e>20&&clearInterval(n)))},500);return this},e.prototype.initHandlers=function(){this.log("initHandlers()");var e=this,n=t("body"),i="control";return n.on("etalia.control.search.change",function(t,n){var o={hitType:"event",eventCategory:i,eventAction:"search",eventLabel:n.expression};e.log("ga.send()",o),ga("send",o)}).on("etalia.control.timespan.change",function(t,n){var o={hitType:"event",eventCategory:i,eventAction:"timespan",eventLabel:n.label,eventValue:n.value};e.log("ga.send()",o),ga("send",o)}).on("etalia.control.cluster.change",function(t,n){var o={hitType:"event",eventCategory:i,eventAction:"cluster",eventLabel:n.label,eventValue:n.value};e.log("ga.send()",o),ga("send",o)}).on("etalia.control.pinned.change",function(t,n){var o={hitType:"event",eventCategory:i,eventAction:n.active?"pin":"unpin"};e.log("ga.send()",o),ga("send",o)}).on("etalia.control.filters.change",function(t,n){var o={hitType:"event",eventCategory:i,eventAction:(n.active?"select_":"deselect_")+n.group,eventLabel:n.label,eventValue:n.value};e.log("ga.send()",o),ga("send",o)}),this},(new e).init()}),define("app/ui/layout/invite",["jquery"],function(t){function e(e){e.preventDefault();var i=n.find(".modal-form"),o=n.find(".modal-result");return t.ajax({type:i.attr("method"),url:i.attr("action"),data:i.serialize(),success:function(t){i.hide().find("input, textarea").val(""),o.show()},error:function(e){console.log(e.responseText);var i=n.find(".form-errors").empty(),o=JSON.parse(e.responseText);t.each(o,function(t,e){i.prepend('<div class="alert alert-danger" role="alert"><span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>'+e+"</div>")})}}),!1}var n;t(function(){n=t("#invite-modal"),t("#open-invite").on("click",function(){t("#profile-dropdown").hide(),n.modal("show")}),n.find("form[data-async]").on("submit",e)})}),define("app/ui/layout/close-alerts",["jquery"],function(t){t(function(){t("a.close[close-href]").click(function(e){e.preventDefault(),t.post(t(this).attr("close-href"),"",function(){})})})}),define("app/ui/layout",["jquery","app/util/utils","app/ui/layout/flap","app/ui/layout/interact","app/ui/layout/invite","app/ui/layout/close-alerts"],function(t,e,n){var i=function(e){this.config=t.extend({debug:!1,leftFlap:"#nav-flap",leftFlapButton:"#toggle-nav",rightFlap:"#filter-flap",rightFlapButton:"#toggle-filter",backdrop:"#backdrop"},e),this.leftFlap=null,this.rightFlap=null,this.busy=!1;var n=this;this.log=function(t){n.config.debug&&console.log("[Layout] "+t)},this.resizeTimeout=null,this.resizeHandler=function(){n.log("Resize handler"),n.leftFlap&&n.leftFlap.init(),n.rightFlap&&n.rightFlap.init()}};i.prototype.init=function(){var i=t(this.config.leftFlap),o=t(this.config.leftFlapButton),a=t(this.config.rightFlap),r=t(this.config.rightFlapButton),s=!1;if(this.log("Init"),i.length?(this.log("Left flap found"),this.leftFlap=new n({debug:this.config.debug,flap:i,side:"left",button:o,backdrop:this.config.backdrop,mobileMaxWidth:992}),s=!0):o.hide(),a.length?(this.log("Right flap found"),this.rightFlap=new n({debug:this.config.debug,flap:a,side:"right",button:this.config.rightFlapButton,backdrop:this.config.backdrop,mobileMaxWidth:1200}),s=!0):r.hide(),s){var l=this;t(window).on("resize",function(){l.resizeTimeout&&clearTimeout(l.resizeTimeout),l.resizeTimeout=setTimeout(l.resizeHandler,100)}),l.resizeHandler()}var u=t("#toggle-profile"),c=t("#profile-dropdown");c.length&&(u.on("click",function(n){e.toggleClass(t(n.delegateTarget),"active")?c.show():c.hide()}),c.on("click",function(t){t.stopPropagation()}),t(window).on("click",function(e){0==t(e.target).closest("#toggle-profile").length&&(t("#toggle-profile").removeClass("active"),t("#profile-dropdown").hide())}))},i.prototype.setBusy=function(e){t("#busy-content").html(e),this.busy||(this.busy=!0,t("body").addClass("busy"))},i.prototype.setAvailable=function(){this.busy&&(this.busy=!1,t("#busy-content").html(""),t("body").removeClass("busy"))};var o=new i;return o.init(),o}),define("app/feed/paper",["jquery","app/ui/paper","app/ui/layout","bootstrap"],function(t,e){t(function(){var n=new e;n.init().update(),t("body").on("etalia.publication.ban",function(t,e){e.isBanned()})})});