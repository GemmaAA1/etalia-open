# EX: PROVISIONING/DEPLOYING STAGING SERVER FROM SCRATCH
# !! CREATE A NEW DJANGO_SECRET_KEY

# Create instance:
heroku create --remote staging --buildpack https://github.com/thenovices/heroku-buildpack-scipy

# Add environment variables:
heroku config:set DJANGO_SECRET_KEY='!!!CREATE A NEW ONE!!'
heroku config:set DJANGO_SETTINGS_MODULE='config.settings.heroku'
heroku config:set CONSUMER_ELSEVIER_API_KEY='293e288c325d7765b7c22f5195175351'
heroku config:set CONSUMER_PUBMED_EMAIL='contact@paperstream.io'
heroku config:set DISQUS_PUBLIC_KEY='w2W0iBEJwGE49PjupwQxDnfzC9ayliEvctiGwbmVb63uHIXNTZLgreJDNRvvBOap'
heroku config:set DISQUS_SECRET_KEY='eMWsm6qeNkDHzdvLViScWPldyDVnmvAz4U79YjsCelOu58XnRPelrUimqTrhGrRw'
heroku config:set DISQUS_WEBSITE_SHORTNAME='paperstream'
heroku config:set DJANGO_AWS_ACCESS_KEY_ID='AKIAJP4QVWCJZTBCDW7A'
heroku config:set DJANGO_AWS_SECRET_ACCESS_KEY='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'
heroku config:set DJANGO_AWS_STORAGE_BUCKET_NAME='paperstreamstatic'
heroku config:set SOCIAL_AUTH_CUSTOM_MENDELEY_OAUTH2_KEY='1678'
heroku config:set SOCIAL_AUTH_CUSTOM_MENDELEY_OAUTH2_SECRET='Q248hJEf4VTYlJLZ'
heroku config:set SOCIAL_AUTH_CUSTOM_ZOTERO_KEY='587e1f15fe24573eb75f'
heroku config:set SOCIAL_AUTH_CUSTOM_ZOTERO_SECRET='5984bb35b1e60a7c2baf'

# Push and deploy:
git push staging master

# Connect to instance
heroku run bash

# Once on the instance:
# create schema
(python manage.py makemigrations)
python manage.py migrate

# populate library
python manage.py populate publisher all
python manage.py populate journal thomson
python manage.py populate journal pubmed
python manage.py populate journal arxiv

# populate consumers
python manage.py populate consumer pubmed --name pubmed_all
python manage.py populate consumer arxiv --name arxiv_all
python manage.py populate consumer elsevier --name elsevier_all



# KEY FOR PRODUCTIONS (when different):
heroku config:set SOCIAL_AUTH_CUSTOM_MENDELEY_OAUTH2_KEY='2132'
heroku config:set SOCIAL_AUTH_CUSTOM_MENDELEY_OAUTH2_SECRET='sSfvl197gZXrEnd9'