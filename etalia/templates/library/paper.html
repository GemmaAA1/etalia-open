{% spaceless %}


{#{% load disqus_tags %}#}
{#{% load disqus %}#}
{% load staticfiles %}
{% load ui_goodies %}

{# TODO need the absolute url #}
{% url 'library:paper-slug' paper.title|slugify paper.pk as paper_detail_url %}

<div id="detail-actions" class="actions" data-paper-id="{{ paper.pk }}" data-paper-url="{{ request.build_absolute_uri }}" data-paper-title="{{ paper.title }}" data-short-author="{{ paper.print_compact_first_author }}">
    {% if user.is_authenticated %}
    <a href="javascript: void(0)" class="detail-pin{% if is_pinned %} active {% endif %}" title="Pin/Unpin">
        <span class="eai eai-pin"></span>
    </a>
    <a href="javascript: void(0)" class="detail-ban" title="Remove from feed">
        <span class="eai eai-remove"></span>
    </a>
    <a href="javascript: void(0)" class="detail-library-{% if is_in_lib %}trash{% elif is_in_trash %}restore{% else %}add{% endif %} loading-button" title="{% if is_in_lib %}Move to trash{% else %}Add to library{% endif %}">
        <span class="eai eai-library-{% if is_in_lib %}trash{% else %}add{% endif %}"></span>
    </a>

    <a href="javascript: void(0)" class="detail-questions" title="Related threads">
        <span class="eai eai-comments"></span>
    </a>
    <a href="javascript: void(0)" class="detail-neighbors" title="Similar publications">
        <span class="eai eai-suggestions"></span>
    </a>
    <a href="{{ paper.url }}" target="_blank" class="detail-pdf" title="Go to PDF">
        <span class="eai eai-pdf"></span>
    </a>

    <a href="mailto:?subject=&body={{ paper.title }}%0D%0A{{ paper.print_compact_authors }}%0D%0A{{ paper.journal.title }}.%20{{ paper.print_date }}%0D%0A{{ paper.url }}"
       class="detail-mail" title="Email">
        <span class="eai eai-mail"></span>
    </a>
    <a href="javascript: void(0)" class="detail-twitter" title="Share on twitter">
        <span class="eai eai-twitter"></span>
    </a>
    <a href="javascript: void(0)" class="detail-google-plus" title="Share on Google+">
        <span class="eai eai-google-plus"></span>
    </a>
    {% else %}
    <a href="{{ paper.url }}" target="_blank" class="detail-pdf" title="Go to PDF">
        <span class="eai eai-pdf"></span>
    </a>
    {% endif %}
</div>

<div class="content">
    <div class="card">
        <p class="ids">
            {{ paper.print_clean_ids }}
        </p>
        <h1 class="title">
            <a href="{{ paper.url }}" target="_blank">
                {{ paper.title }}
            </a>
        </h1>
        <p class="authors">
            {{ paper.print_full_authors }}
        </p>
        <div class="infos">
            <p class="truncate">
                {{ paper.print_journal_title }}
                <em>{{ paper.print_month_year }}</em>
            </p>
            <p class="icons">
                <!--<span class="cluster-icon">
                    <span></span>
                    <span></span>
                    <span></span>
                    <span class="cluster-3"></span>
                </span>-->
                <!-- TODO -->

                {% include "library/paper-altmetric-badge.html" with paper=paper %}

                <!-- TODO relative questions count -->
                <!--<span class="comment">
                    <span class="count">16</span>
                    <span class="eai eai-comment"></span>
                </span>-->
            </p>
        </div>
    </div>


    {% if paper.abstract %}
    <h2>Abstract</h2>
    <div>
        {{ paper.abstract }}
    </div>
    {% endif %}


    {% if user.is_authenticated %}
    <div class="questions-thumbs">
        <h2>Related threads</h2>
            <h4>Comming soon...</h4>
{#        <div class="thumb-list async-content">#}
{#            {% show_loading 'sk-cube-grid' %}#}
{#        </div>#}
    </div>
    {%  endif %}


    <div class="neighbors-thumbs" data-load-url="{% url 'library:paper-neighbors' paper.pk %}">
        <h2>Similar publications</h2>
        <ul class="neighbors-timespan-selector">
            <li>
                <a href="javascript: void(0)" data-value="365">1 year</a>
            </li>
            <li class="active">
                <a href="javascript: void(0)" data-value="30">1 month</a>
            </li>
            <li>
                <a href="javascript: void(0)" data-value="7">Week</a>
            </li>
        </ul>
        <div class="thumb-list async-content">
            {% show_loading 'sk-cube-grid' %}
        </div>
    </div>

</div>
{% endspaceless %}
