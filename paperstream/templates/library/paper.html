{% extends 'base.html' %}

{% load disqus_tags %}
{% load disqus %}
{% load staticfiles %}

{% block css %}
    {{ block.super }}
    <link href="{% static 'css/library.css' %}" rel="stylesheet">
{% endblock css %}

{% block title %}
    Library
{% endblock title %}

{% block content %}
    <div class="container-fluid">
        <div class="library">
            <div class="row">
                <div class="col-lg-11 col-lg-offset-1">
                    <div class="paper">
                        <div class="col-md-8">
                            <div class="title">{{ paper.title }}</div>
                            <div class="row">
                                <div class="col-md-10">
                                    <div class="authors">{{ paper.print_full_authors }}</div>
                                    <div class="journal-date">{{ paper.print_journal_title }}
                                        <span class="date">{{ paper.print_month_year }}</span>
                                    </div>
                                    {% if paper.print_clean_ids %}
                                    <div class="ids">{{ paper.print_clean_ids }}</div>
                                    {% endif %}
                                </div>
                                <div class="col-md-2 hidden-xs hidden-md">
                                    <div class="altmetric">
                                        {% if paper.id_doi %}<div class='altmetric-embed' data-badge-type='donut' data-doi="{{ paper.id_doi }}"></div>
                                        {% elif paper.id_arx %}<div class='altmetric-embed' data-badge-type='donut' data-arxiv="{{ paper.id_arx }}"></div>
                                        {% elif paper.id_pmi %}<div class='altmetric-embed' data-badge-type='donut' data-pmid="{{ paper.id_pmi }}"></div>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>

                            {% if paper.abstract %}
                                <div class="abstract-title">Abstract:</div>
                                <div class="abstract-body">
                                    {{ paper.abstract }}
                                </div>
                            {% endif %}


                            <div class="comment">
                                <div id="disqus_thread"></div>
                                    <!-- use sso for disqus -->
        {#                                {% disqus_sso %}#}
                                    {% if user.is_authenticated %}
                                        {% get_disqus_sso request %}
                                        <!-- comments -->
                                        {% disqus_show_comments %}
                                    {%  endif %}
                            </div>
                        </div>
                        <div class="col-lg-3">
                            <div class="stamps">
                                <a class="go-to" href="{{ paper.url }}" target="_blank"></a>
                                {% if user.is_authenticated %}
                                <span class="like {% if is_liked %} active {% endif %}"></span>
                                <span class="dislike {% if is_disliked %} active {% endif %}"></span>
                                {% endif %}
                            </div>
                            <div class="neighbors">
                                {% if neighbors %}
                                    <div class="title">Similar Papers</div>
                                        <span>
                                            <a href="{% url 'library:paper-time' paper.id 'year' %}" {% if time_lapse == 'year' %} style="text-decoration: underline;" {%  endif %}>year</a>
                                            <a href="{% url 'library:paper-time' paper.id 'month' %}" {% if time_lapse == 'month' %} style="text-decoration: underline;" {%  endif %}>month</a>
                                            <a href="{% url 'library:paper-time' paper.id 'week' %}" {% if time_lapse == 'week' %} style="text-decoration: underline;" {%  endif %}>week</a>
                                    </div>
                                    <div class="neighbors-list">
                                    {% for neighbor in neighbors %}
                                        <a href="{% url 'library:paper' neighbor.pk %}">
                                            <div class="neighbor">
                                                {{ neighbor.title|truncatechars:40 }}<br>
                                                <span class="authors">{{ neighbor.print_full_authors|truncatechars:40 }}</span><br>
                                                {{ neighbor.print_journal_title|truncatechars:30}}
                                                {{ neighbor.print_month_year }}
                                            </div>
                                        </a>
                                    {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type='text/javascript' src='https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js'></script>
{% endblock content %}