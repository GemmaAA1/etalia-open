CREATE OR REPLACE FUNCTION cos_sim (a float8[], b float8[], size integer)
  RETURNS float8
AS $$
  import numpy as np
  from scipy.spatial.distance import cdist
  return cdist(np.array(a)[None, :size], np.array(b)[None, :size], 'cosine')[0][0]
$$ LANGUAGE plpython3u;



select
    nlp_papervectors.*,
    cos_sim(vector, '{1.0, 1.0, 1.0}', 3) as dist
  from
    nlp_papervectors
  order by
    dist
  limit 10;